{
	"auto_complete":
	{
		"selected_items":
		[
			[
				"team_",
				"team_leader"
			]
		]
	},
	"buffers":
	[
		{
			"file": "application_traceroute.py",
			"settings":
			{
				"buffer_size": 86359,
				"encoding": "UTF-8",
				"line_ending": "Unix",
				"name": "#!/usr/bin/env python3"
			},
			"undo_stack":
			[
				[
					25,
					1,
					"",
					null,
					"AQAAAAAAAAAAAAAAS0sBAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8L8"
				],
				[
					30,
					1,
					"",
					null,
					"AQAAAAAAAAAAAAAAV1EBAAAAAAARTAEAIyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoiIiIKQXBwbGljYXRpb24gU3RhY2sgVHJhY2Vyb3V0ZSAmIEJ5cGFzcyBHZW5lcmF0b3IKTmV4dC1HZW5lcmF0aW9uIFdBRi9Qcm94eS9CYWNrZW5kIENoYWluIEFuYWx5c2lzIFRvb2wKCklubm92YXRpdmUgRmVhdHVyZXM6Ci0gTWFwcyBjb21wbGV0ZSByZXF1ZXN0IHByb2Nlc3NpbmcgY2hhaW4gKFdBRi0+Q0ROLT5Qcm94eS0+QmFja2VuZCkKLSBJZGVudGlmaWVzIHBhcnNpbmcgZGlzY3JlcGFuY2llcyBiZXR3ZWVuIGxheWVycwotIEdlbmVyYXRlcyBjdXN0b20gYnlwYXNzIHBheWxvYWRzIGZvciBlYWNoIGRpc2NvdmVyZWQgZGlzY3JlcGFuY3kKLSBQcm90b2NvbCBjb25mdXNpb24gdGVzdGluZyAoSFRUUC8xLjEsIEhUVFAvMiwgSFRUUC8zKQotIE11bHRpLWxheWVyIGVuY29kaW5nIGFuYWx5c2lzCi0gUGFyc2VyIHN0YXRlIG1hY2hpbmUgY29uZnVzaW9uIGRldGVjdGlvbgotIEVOSEFOQ0VEOiBBZHZhbmNlZCBieXBhc3MgdGVjaG5pcXVlcyBiYXNlZCBvbiBkZWVwIGRpc2NyZXBhbmNpZXMKLSBFTkhBTkNFRDogSlNPTiBleHBvcnQgZm9yIGJ5cGFzcyBhdXRvbWF0aW9uCiIiIgoKaW1wb3J0IHJlcXVlc3RzCmltcG9ydCBhc3luY2lvCmltcG9ydCBhaW9odHRwCmltcG9ydCBqc29uCmltcG9ydCB0aW1lCmltcG9ydCBiYXNlNjQKaW1wb3J0IHVybGxpYi5wYXJzZQppbXBvcnQgemxpYgppbXBvcnQgZ3ppcAppbXBvcnQgcmFuZG9tCmltcG9ydCBzdHJpbmcKaW1wb3J0IHNvY2tldAppbXBvcnQgc3NsCmltcG9ydCBoMi5jb25uZWN0aW9uCmltcG9ydCBoMi5jb25maWcKZnJvbSB1cmxsaWIucGFyc2UgaW1wb3J0IHVybHBhcnNlCmltcG9ydCByZQpmcm9tIGNvbGxlY3Rpb25zIGltcG9ydCBkZWZhdWx0ZGljdAppbXBvcnQgY29uY3VycmVudC5mdXR1cmVzCmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IHF1ZXVlCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCgpjbGFzcyBBcHBsaWNhdGlvblRyYWNlcm91dGU6CiAgICBkZWYgX19pbml0X18oc2VsZiwgdGFyZ2V0X3VybCk6CiAgICAgICAgc2VsZi50YXJnZXRfdXJsID0gdGFyZ2V0X3VybC5yc3RyaXAoJy8nKQogICAgICAgIHNlbGYucGFyc2VkX3VybCA9IHVybHBhcnNlKHRhcmdldF91cmwpCiAgICAgICAgc2VsZi5zZXNzaW9uID0gcmVxdWVzdHMuU2Vzc2lvbigpCiAgICAgICAgCiAgICAgICAgIyBDaGFpbiBkaXNjb3ZlcnkgcmVzdWx0cwogICAgICAgIHNlbGYuY2hhaW5fbWFwID0gewogICAgICAgICAgICAnbGF5ZXJzJzogW10sCiAgICAgICAgICAgICdkaXNjcmVwYW5jaWVzJzogW10sCiAgICAgICAgICAgICdmaW5nZXJwcmludHMnOiB7fSwKICAgICAgICAgICAgJ2J5cGFzc2VzJzogW10KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgIyBQcm90b2NvbCBzdXBwb3J0IGRldGVjdGlvbgogICAgICAgIHNlbGYucHJvdG9jb2xzID0gewogICAgICAgICAgICAnaHR0cDEnOiBUcnVlLAogICAgICAgICAgICAnaHR0cDInOiBGYWxzZSwKICAgICAgICAgICAgJ2h0dHAzJzogRmFsc2UsCiAgICAgICAgICAgICd3ZWJzb2NrZXQnOiBGYWxzZQogICAgICAgIH0KICAgICAgICAKICAgIGRlZiBsb2dfZGlzY292ZXJ5KHNlbGYsIGxheWVyLCBkaXNjb3ZlcnlfdHlwZSwgZGV0YWlscyk6CiAgICAgICAgIiIiTG9nIGRpc2NvdmVyaWVzIHdpdGggc3RydWN0dXJlZCBkYXRhIiIiCiAgICAgICAgdGltZXN0YW1wID0gdGltZS5zdHJmdGltZSgnJUg6JU06JVMnKQogICAgICAgIHByaW50KGYiW3t0aW1lc3RhbXB9XSDwn5SNIHtsYXllcn0gLSB7ZGlzY292ZXJ5X3R5cGV9OiB7ZGV0YWlsc30iKQogICAgICAgIAogICAgICAgIGlmIGxheWVyIG5vdCBpbiBzZWxmLmNoYWluX21hcFsnZmluZ2VycHJpbnRzJ106CiAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydmaW5nZXJwcmludHMnXVtsYXllcl0gPSB7fQogICAgICAgIHNlbGYuY2hhaW5fbWFwWydmaW5nZXJwcmludHMnXVtsYXllcl1bZGlzY292ZXJ5X3R5cGVdID0gZGV0YWlscwoKICAgIGRlZiBnZW5lcmF0ZV91bmlxdWVfbWFya2VycyhzZWxmKToKICAgICAgICAiIiJHZW5lcmF0ZSB1bmlxdWUgbWFya2VycyBmb3IgcmVxdWVzdCB0cmFja2luZyIiIgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICd1dWlkJzogJycuam9pbihyYW5kb20uY2hvaWNlcyhzdHJpbmcuYXNjaWlfbG93ZXJjYXNlICsgc3RyaW5nLmRpZ2l0cywgaz0xNikpLAogICAgICAgICAgICAndGltZXN0YW1wJzogc3RyKGludCh0aW1lLnRpbWUoKSkpLAogICAgICAgICAgICAnc2VxdWVuY2UnOiBzdHIocmFuZG9tLnJhbmRpbnQoMTAwMDAwLCA5OTk5OTkpKQogICAgICAgIH0KCiAgICBkZWYgY3JlYXRlX2ZpbmdlcnByaW50X3BheWxvYWRzKHNlbGYpOgogICAgICAgICIiIkNyZWF0ZSBwYXlsb2FkcyB0byBmaW5nZXJwcmludCBlYWNoIGxheWVyIGluIHRoZSBjaGFpbiIiIgogICAgICAgIG1hcmtlcnMgPSBzZWxmLmdlbmVyYXRlX3VuaXF1ZV9tYXJrZXJzKCkKICAgICAgICAKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAnY2RuX2RldGVjdGlvbic6IHsKICAgICAgICAgICAgICAgICdoZWFkZXJzJzogewogICAgICAgICAgICAgICAgICAgICdYLUNETi1UZXN0JzogbWFya2Vyc1sndXVpZCddLAogICAgICAgICAgICAgICAgICAgICdDYWNoZS1Db250cm9sJzogJ25vLWNhY2hlJywKICAgICAgICAgICAgICAgICAgICAnUHJhZ21hJzogJ25vLWNhY2hlJwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICdleHBlY3RlZF9yZXNwb25zZXMnOiBbJ2Nsb3VkZmxhcmUnLCAnY2xvdWRmcm9udCcsICdmYXN0bHknLCAnYWthbWFpJ10KICAgICAgICAgICAgfSwKICAgICAgICAgICAgCiAgICAgICAgICAgICd3YWZfZGV0ZWN0aW9uJzogewogICAgICAgICAgICAgICAgJ3BheWxvYWRzJzogWwogICAgICAgICAgICAgICAgICAgIGYiLz90ZXN0PTxzY3JpcHQ+YWxlcnQoJ3ttYXJrZXJzWyd1dWlkJ119Jyk8L3NjcmlwdD4iLAogICAgICAgICAgICAgICAgICAgIGYiLz90ZXN0PScgT1IgMT0xIC0tIHttYXJrZXJzWyd1dWlkJ119IiwKICAgICAgICAgICAgICAgICAgICBmIi8/dGVzdD0uLi8uLi8uLi9ldGMvcGFzc3dkI3ttYXJrZXJzWyd1dWlkJ119IgogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICdoZWFkZXJzJzogeydVc2VyLUFnZW50JzogZidNb3ppbGxhLzUuMCAodGVzdC17bWFya2Vyc1sidXVpZCJdfSknfQogICAgICAgICAgICB9LAogICAgICAgICAgICAKICAgICAgICAgICAgJ3Byb3h5X2RldGVjdGlvbic6IHsKICAgICAgICAgICAgICAgICdoZWFkZXJzJzogewogICAgICAgICAgICAgICAgICAgICdYLUZvcndhcmRlZC1Gb3InOiBmJzEyNy4wLjAuMSx7bWFya2Vyc1sidXVpZCJdfScsCiAgICAgICAgICAgICAgICAgICAgJ1gtUmVhbC1JUCc6IGYnMTkyLjE2OC4xLnttYXJrZXJzWyJzZXF1ZW5jZSJdWzozXX0nLAogICAgICAgICAgICAgICAgICAgICdYLVByb3h5LVRlc3QnOiBtYXJrZXJzWyd1dWlkJ10KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgCiAgICAgICAgICAgICdiYWNrZW5kX2RldGVjdGlvbic6IHsKICAgICAgICAgICAgICAgICdwYXRocyc6IFsKICAgICAgICAgICAgICAgICAgICBmJy9zZXJ2ZXItaW5mbz90ZXN0PXttYXJrZXJzWyJ1dWlkIl19JywKICAgICAgICAgICAgICAgICAgICBmJy9zZXJ2ZXItc3RhdHVzP3Rlc3Q9e21hcmtlcnNbInV1aWQiXX0nLAogICAgICAgICAgICAgICAgICAgIGYnLy5lbnY/dGVzdD17bWFya2Vyc1sidXVpZCJdfScsCiAgICAgICAgICAgICAgICAgICAgZicvcGhwaW5mby5waHA/dGVzdD17bWFya2Vyc1sidXVpZCJdfScKICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICBhc3luYyBkZWYgcHJvdG9jb2xfZGlzY292ZXJ5KHNlbGYpOgogICAgICAgICIiIkRpc2NvdmVyIHN1cHBvcnRlZCBwcm90b2NvbHMiIiIKICAgICAgICBwcmludCgi8J+UjSBQaGFzZSAxOiBQcm90b2NvbCBEaXNjb3ZlcnkiKQogICAgICAgIAogICAgICAgICMgSFRUUC8yIERldGVjdGlvbgogICAgICAgIHRyeToKICAgICAgICAgICAgYXN5bmMgd2l0aCBhaW9odHRwLkNsaWVudFNlc3Npb24oKSBhcyBzZXNzaW9uOgogICAgICAgICAgICAgICAgYXN5bmMgd2l0aCBzZXNzaW9uLmdldChzZWxmLnRhcmdldF91cmwpIGFzIHJlc3BvbnNlOgogICAgICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIocmVzcG9uc2UsICd2ZXJzaW9uJykgYW5kIHJlc3BvbnNlLnZlcnNpb24ubWFqb3IgPj0gMjoKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wcm90b2NvbHNbJ2h0dHAyJ10gPSBUcnVlCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9nX2Rpc2NvdmVyeSgiUHJvdG9jb2wiLCAiSFRUUC8yIiwgIlN1cHBvcnRlZCIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICAgICAgCiAgICAgICAgIyBIVFRQLzMgRGV0ZWN0aW9uICh2aWEgQWx0LVN2YyBoZWFkZXIpCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXNwb25zZSA9IHNlbGYuc2Vzc2lvbi5oZWFkKHNlbGYudGFyZ2V0X3VybCkKICAgICAgICAgICAgYWx0X3N2YyA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdBbHQtU3ZjJywgJycpCiAgICAgICAgICAgIGlmICdoMycgaW4gYWx0X3N2YyBvciAnaDMtMjknIGluIGFsdF9zdmM6CiAgICAgICAgICAgICAgICBzZWxmLnByb3RvY29sc1snaHR0cDMnXSA9IFRydWUKICAgICAgICAgICAgICAgIHNlbGYubG9nX2Rpc2NvdmVyeSgiUHJvdG9jb2wiLCAiSFRUUC8zIiwgZiJEZXRlY3RlZCB2aWEgQWx0LVN2Yzoge2FsdF9zdmN9IikKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICAKICAgICAgICAjIFdlYlNvY2tldCBEZXRlY3Rpb24KICAgICAgICB0cnk6CiAgICAgICAgICAgIHdzX2hlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICAnVXBncmFkZSc6ICd3ZWJzb2NrZXQnLAogICAgICAgICAgICAgICAgJ0Nvbm5lY3Rpb24nOiAnVXBncmFkZScsCiAgICAgICAgICAgICAgICAnU2VjLVdlYlNvY2tldC1LZXknOiAnZEdobElITmhiWEJzWlNCdWIyNWpaUT09JywKICAgICAgICAgICAgICAgICdTZWMtV2ViU29ja2V0LVZlcnNpb24nOiAnMTMnCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnNlc3Npb24uZ2V0KHNlbGYudGFyZ2V0X3VybCwgaGVhZGVycz13c19oZWFkZXJzKQogICAgICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAxMDE6CiAgICAgICAgICAgICAgICBzZWxmLnByb3RvY29sc1snd2Vic29ja2V0J10gPSBUcnVlCiAgICAgICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIlByb3RvY29sIiwgIldlYlNvY2tldCIsICJVcGdyYWRlIHN1cHBvcnRlZCIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCgogICAgZGVmIGluZnJhc3RydWN0dXJlX2ZpbmdlcnByaW50aW5nKHNlbGYpOgogICAgICAgICIiIkZpbmdlcnByaW50IGluZnJhc3RydWN0dXJlIGNvbXBvbmVudHMiIiIKICAgICAgICBwcmludCgiXG7wn5SNIFBoYXNlIDI6IEluZnJhc3RydWN0dXJlIEZpbmdlcnByaW50aW5nIikKICAgICAgICAKICAgICAgICBmaW5nZXJwcmludHMgPSBzZWxmLmNyZWF0ZV9maW5nZXJwcmludF9wYXlsb2FkcygpCiAgICAgICAgCiAgICAgICAgIyBDRE4gRGV0ZWN0aW9uCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXNwb25zZSA9IHNlbGYuc2Vzc2lvbi5nZXQoc2VsZi50YXJnZXRfdXJsLCBoZWFkZXJzPWZpbmdlcnByaW50c1snY2RuX2RldGVjdGlvbiddWydoZWFkZXJzJ10pCiAgICAgICAgICAgIAogICAgICAgICAgICAjIEFuYWx5emUgcmVzcG9uc2UgaGVhZGVycyBmb3IgQ0ROIHNpZ25hdHVyZXMKICAgICAgICAgICAgY2RuX2luZGljYXRvcnMgPSB7CiAgICAgICAgICAgICAgICAnY2xvdWRmbGFyZSc6IFsnY2YtcmF5JywgJ2NmLWNhY2hlLXN0YXR1cycsICdzZXJ2ZXIuKmNsb3VkZmxhcmUnXSwKICAgICAgICAgICAgICAgICdjbG91ZGZyb250JzogWyd4LWFtei1jZicsICd4LWNhY2hlLipjbG91ZGZyb250J10sCiAgICAgICAgICAgICAgICAnZmFzdGx5JzogWydmYXN0bHktZGVidWcnLCAneC1zZXJ2ZWQtYnkuKmZhc3RseSddLAogICAgICAgICAgICAgICAgJ2FrYW1haSc6IFsnYWthbWFpLW9yaWdpbi1ob3AnLCAneC1ha2FtYWknXSwKICAgICAgICAgICAgICAgICdpbmNhcHN1bGEnOiBbJ3gtaWluZm8nLCAnaW5jYXBfc2VzJ10sCiAgICAgICAgICAgICAgICAnc3VjdXJpJzogWyd4LXN1Y3VyaScsICdzZXJ2ZXIuKnN1Y3VyaSddCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGRldGVjdGVkX2NkbiA9IE5vbmUKICAgICAgICAgICAgZm9yIGNkbiwgaW5kaWNhdG9ycyBpbiBjZG5faW5kaWNhdG9ycy5pdGVtcygpOgogICAgICAgICAgICAgICAgZm9yIGluZGljYXRvciBpbiBpbmRpY2F0b3JzOgogICAgICAgICAgICAgICAgICAgIGZvciBoZWFkZXIsIHZhbHVlIGluIHJlc3BvbnNlLmhlYWRlcnMuaXRlbXMoKToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgcmUuc2VhcmNoKGluZGljYXRvciwgZiJ7aGVhZGVyfToge3ZhbHVlfSIsIHJlLklHTk9SRUNBU0UpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0ZWN0ZWRfY2RuID0gY2RuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgaWYgZGV0ZWN0ZWRfY2RuOgogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBkZXRlY3RlZF9jZG46CiAgICAgICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkNETiIsICJEZXRlY3Rpb24iLCBkZXRlY3RlZF9jZG4pCiAgICAgICAgICAgICAgICBzZWxmLmNoYWluX21hcFsnbGF5ZXJzJ10uYXBwZW5kKGYiQ0ROLXtkZXRlY3RlZF9jZG59IikKICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkNETiIsICJFcnJvciIsIHN0cihlKSkKICAgICAgICAKICAgICAgICAjIFdBRiBEZXRlY3Rpb24KICAgICAgICBzZWxmLndhZl9maW5nZXJwcmludGluZyhmaW5nZXJwcmludHNbJ3dhZl9kZXRlY3Rpb24nXSkKICAgICAgICAKICAgICAgICAjIFByb3h5IERldGVjdGlvbiAgCiAgICAgICAgc2VsZi5wcm94eV9maW5nZXJwcmludGluZyhmaW5nZXJwcmludHNbJ3Byb3h5X2RldGVjdGlvbiddKQogICAgICAgIAogICAgICAgICMgQmFja2VuZCBEZXRlY3Rpb24KICAgICAgICBzZWxmLmJhY2tlbmRfZmluZ2VycHJpbnRpbmcoZmluZ2VycHJpbnRzWydiYWNrZW5kX2RldGVjdGlvbiddKQoKICAgIGRlZiB3YWZfZmluZ2VycHJpbnRpbmcoc2VsZiwgd2FmX3BheWxvYWRzKToKICAgICAgICAiIiJBZHZhbmNlZCBXQUYgZmluZ2VycHJpbnRpbmciIiIKICAgICAgICBwcmludCgiICDwn5uh77iPIFdBRiBEZXRlY3Rpb24uLi4iKQogICAgICAgIAogICAgICAgIHdhZl9zaWduYXR1cmVzID0gewogICAgICAgICAgICAnY2xvdWRmbGFyZSc6IFsnY2YtcmF5JywgJ2Nsb3VkZmxhcmUnLCAnZXJyb3IgMTAyMCddLAogICAgICAgICAgICAnYXdzLXdhZic6IFsnYXdzZWxiJywgJ2F3cycsICd4LWFtem4nXSwKICAgICAgICAgICAgJ2ltcGVydmEnOiBbJ2luY2FwX3NlcycsICd2aXNpZF9pbmNhcCcsICdpbXBlcnZhJ10sCiAgICAgICAgICAgICdha2FtYWknOiBbJ2FrYW1haScsICdhay1ibXNjJ10sCiAgICAgICAgICAgICd3b3JkZmVuY2UnOiBbJ3dvcmRmZW5jZScsICd0aGlzIHNpdGUgaXMgcHJvdGVjdGVkJ10sCiAgICAgICAgICAgICdzdWN1cmknOiBbJ3N1Y3VyaScsICdhY2Nlc3MgZGVuaWVkLipzdWN1cmknXSwKICAgICAgICAgICAgJ2JhcnJhY3VkYSc6IFsnYmFycmFjdWRhJywgJ2Juc3YnXSwKICAgICAgICAgICAgJ2Y1JzogWydmNScsICdiaWdpcCcsICd4LXdhLWluZm8nXSwKICAgICAgICAgICAgJ2ZvcnRpbmV0JzogWydmb3J0aWdhdGUnLCAnZm9ydGl3ZWInXQogICAgICAgIH0KICAgICAgICAKICAgICAgICBkZXRlY3RlZF93YWYgPSBOb25lCiAgICAgICAgCiAgICAgICAgZm9yIHBheWxvYWQgaW4gd2FmX3BheWxvYWRzWydwYXlsb2FkcyddOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICByZXNwb25zZSA9IHNlbGYuc2Vzc2lvbi5nZXQoCiAgICAgICAgICAgICAgICAgICAgZiJ7c2VsZi50YXJnZXRfdXJsfXtwYXlsb2FkfSIsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVycz13YWZfcGF5bG9hZHNbJ2hlYWRlcnMnXSwKICAgICAgICAgICAgICAgICAgICB0aW1lb3V0PTEwCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgQW5hbHl6ZSByZXNwb25zZSBmb3IgV0FGIHNpZ25hdHVyZXMKICAgICAgICAgICAgICAgIGZ1bGxfcmVzcG9uc2UgPSBmIntyZXNwb25zZS5zdGF0dXNfY29kZX0ge3Jlc3BvbnNlLmhlYWRlcnN9IHtyZXNwb25zZS50ZXh0fSIubG93ZXIoKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBmb3Igd2FmLCBzaWduYXR1cmVzIGluIHdhZl9zaWduYXR1cmVzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICAgICAgZm9yIHNpZ25hdHVyZSBpbiBzaWduYXR1cmVzOgogICAgICAgICAgICAgICAgICAgICAgICBpZiByZS5zZWFyY2goc2lnbmF0dXJlLCBmdWxsX3Jlc3BvbnNlKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldGVjdGVkX3dhZiA9IHdhZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICBpZiBkZXRlY3RlZF93YWY6CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIGRldGVjdGVkX3dhZjoKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgIAogICAgICAgIGlmIGRldGVjdGVkX3dhZjoKICAgICAgICAgICAgc2VsZi5sb2dfZGlzY292ZXJ5KCJXQUYiLCAiRGV0ZWN0aW9uIiwgZGV0ZWN0ZWRfd2FmKQogICAgICAgICAgICBzZWxmLmNoYWluX21hcFsnbGF5ZXJzJ10uYXBwZW5kKGYiV0FGLXtkZXRlY3RlZF93YWZ9IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIldBRiIsICJEZXRlY3Rpb24iLCAiTm9uZSBkZXRlY3RlZCBvciB1bmtub3duIikKCiAgICBkZWYgcHJveHlfZmluZ2VycHJpbnRpbmcoc2VsZiwgcHJveHlfaGVhZGVycyk6CiAgICAgICAgIiIiRGV0ZWN0IHByb3h5L2xvYWQgYmFsYW5jZXIgY29uZmlndXJhdGlvbiIiIgogICAgICAgIHByaW50KCIgIPCflIQgUHJveHkgRGV0ZWN0aW9uLi4uIikKICAgICAgICAKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5zZXNzaW9uLmdldChzZWxmLnRhcmdldF91cmwsIGhlYWRlcnM9cHJveHlfaGVhZGVyc1snaGVhZGVycyddKQogICAgICAgICAgICAKICAgICAgICAgICAgcHJveHlfaW5kaWNhdG9ycyA9IHsKICAgICAgICAgICAgICAgICduZ2lueCc6IFsnc2VydmVyLipuZ2lueCcsICd4LW5naW54J10sCiAgICAgICAgICAgICAgICAnYXBhY2hlJzogWydzZXJ2ZXIuKmFwYWNoZScsICd4LWFwYWNoZSddLAogICAgICAgICAgICAgICAgJ2hhcHJveHknOiBbJ3NlcnZlci4qaGFwcm94eSddLAogICAgICAgICAgICAgICAgJ3RyYWVmaWsnOiBbJ3NlcnZlci4qdHJhZWZpayddLAogICAgICAgICAgICAgICAgJ2Vudm95JzogWydzZXJ2ZXIuKmVudm95JywgJ3gtZW52b3knXSwKICAgICAgICAgICAgICAgICdpc3Rpbyc6IFsnc2VydmVyLippc3RpbyddLAogICAgICAgICAgICAgICAgJ2xpbmtlcmQnOiBbJ2w1ZC0nXSwKICAgICAgICAgICAgICAgICdhd3MtYWxiJzogWydhd3NhbGInLCAnZWxidjInXSwKICAgICAgICAgICAgICAgICdnY3AtbGInOiBbJ3ZpYS4qZ29vZ2xlIGZyb250ZW5kJ10KICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgZGV0ZWN0ZWRfcHJveHkgPSBOb25lCiAgICAgICAgICAgIGZvciBwcm94eSwgaW5kaWNhdG9ycyBpbiBwcm94eV9pbmRpY2F0b3JzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBmb3IgaW5kaWNhdG9yIGluIGluZGljYXRvcnM6CiAgICAgICAgICAgICAgICAgICAgZm9yIGhlYWRlciwgdmFsdWUgaW4gcmVzcG9uc2UuaGVhZGVycy5pdGVtcygpOgogICAgICAgICAgICAgICAgICAgICAgICBpZiByZS5zZWFyY2goaW5kaWNhdG9yLCBmIntoZWFkZXJ9OiB7dmFsdWV9IiwgcmUuSUdOT1JFQ0FTRSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXRlY3RlZF9wcm94eSA9IHByb3h5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgaWYgZGV0ZWN0ZWRfcHJveHk6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIGRldGVjdGVkX3Byb3h5OgogICAgICAgICAgICAgICAgc2VsZi5sb2dfZGlzY292ZXJ5KCJQcm94eSIsICJEZXRlY3Rpb24iLCBkZXRlY3RlZF9wcm94eSkKICAgICAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydsYXllcnMnXS5hcHBlbmQoZiJQcm94eS17ZGV0ZWN0ZWRfcHJveHl9IikKICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIlByb3h5IiwgIkVycm9yIiwgc3RyKGUpKQoKICAgIGRlZiBiYWNrZW5kX2ZpbmdlcnByaW50aW5nKHNlbGYsIGJhY2tlbmRfcGF0aHMpOgogICAgICAgICIiIkZpbmdlcnByaW50IGJhY2tlbmQgYXBwbGljYXRpb24gc2VydmVyIiIiCiAgICAgICAgcHJpbnQoIiAg8J+Wpe+4jyBCYWNrZW5kIERldGVjdGlvbi4uLiIpCiAgICAgICAgCiAgICAgICAgYmFja2VuZF9zaWduYXR1cmVzID0gewogICAgICAgICAgICAnYXBhY2hlJzogWydzZXJ2ZXIuKmFwYWNoZSddLAogICAgICAgICAgICAnbmdpbngnOiBbJ3NlcnZlci4qbmdpbngnXSwKICAgICAgICAgICAgJ2lpcyc6IFsnc2VydmVyLippaXMnLCAneC1hc3BuZXQtdmVyc2lvbiddLAogICAgICAgICAgICAndG9tY2F0JzogWydzZXJ2ZXIuKnRvbWNhdCddLAogICAgICAgICAgICAnamV0dHknOiBbJ3NlcnZlci4qamV0dHknXSwKICAgICAgICAgICAgJ25vZGUnOiBbJ3gtcG93ZXJlZC1ieS4qZXhwcmVzcycsICd4LXBvd2VyZWQtYnkuKm5vZGUnXSwKICAgICAgICAgICAgJ3BocCc6IFsneC1wb3dlcmVkLWJ5LipwaHAnLCAnc2VydmVyLipwaHAnXSwKICAgICAgICAgICAgJ3B5dGhvbic6IFsnc2VydmVyLipndW5pY29ybicsICdzZXJ2ZXIuKnV3c2dpJ10sCiAgICAgICAgICAgICdydWJ5JzogWydzZXJ2ZXIuKnB1bWEnLCAneC1wb3dlcmVkLWJ5LipydWJ5J10sCiAgICAgICAgICAgICdnbyc6IFsnc2VydmVyLipnbyddCiAgICAgICAgfQogICAgICAgIAogICAgICAgIGRldGVjdGVkX2JhY2tlbmQgPSBOb25lCiAgICAgICAgCiAgICAgICAgZm9yIHBhdGggaW4gYmFja2VuZF9wYXRoc1sncGF0aHMnXToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnNlc3Npb24uZ2V0KGYie3NlbGYudGFyZ2V0X3VybH17cGF0aH0iLCB0aW1lb3V0PTUpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGZ1bGxfcmVzcG9uc2UgPSBmIntyZXNwb25zZS5oZWFkZXJzfSB7cmVzcG9uc2UudGV4dH0iLmxvd2VyKCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZm9yIGJhY2tlbmQsIHNpZ25hdHVyZXMgaW4gYmFja2VuZF9zaWduYXR1cmVzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICAgICAgZm9yIHNpZ25hdHVyZSBpbiBzaWduYXR1cmVzOgogICAgICAgICAgICAgICAgICAgICAgICBpZiByZS5zZWFyY2goc2lnbmF0dXJlLCBmdWxsX3Jlc3BvbnNlKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldGVjdGVkX2JhY2tlbmQgPSBiYWNrZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIGlmIGRldGVjdGVkX2JhY2tlbmQ6CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIGRldGVjdGVkX2JhY2tlbmQ6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAKICAgICAgICBpZiBkZXRlY3RlZF9iYWNrZW5kOgogICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkJhY2tlbmQiLCAiRGV0ZWN0aW9uIiwgZGV0ZWN0ZWRfYmFja2VuZCkKICAgICAgICAgICAgc2VsZi5jaGFpbl9tYXBbJ2xheWVycyddLmFwcGVuZChmIkJhY2tlbmQte2RldGVjdGVkX2JhY2tlbmR9IikKCiAgICBkZWYgcGFyc2VyX2Rpc2NyZXBhbmN5X3Rlc3Rpbmcoc2VsZik6CiAgICAgICAgIiIiVGVzdCBmb3IgcGFyc2luZyBkaXNjcmVwYW5jaWVzIGJldHdlZW4gbGF5ZXJzIiIiCiAgICAgICAgcHJpbnQoIlxu8J+UjSBQaGFzZSAzOiBQYXJzZXIgRGlzY3JlcGFuY3kgQW5hbHlzaXMiKQogICAgICAgIAogICAgICAgICMgT3JpZ2luYWwgdGVzdHMKICAgICAgICBkaXNjcmVwYW5jeV90ZXN0cyA9IFsKICAgICAgICAgICAgc2VsZi50ZXN0X2h0dHBfc211Z2dsaW5nLAogICAgICAgICAgICBzZWxmLnRlc3RfdW5pY29kZV9jb25mdXNpb24sCiAgICAgICAgICAgIHNlbGYudGVzdF9lbmNvZGluZ19kaXNjcmVwYW5jaWVzLAogICAgICAgICAgICBzZWxmLnRlc3RfaGVhZGVyX2NvbmZ1c2lvbiwKICAgICAgICAgICAgc2VsZi50ZXN0X21ldGhvZF9jb25mdXNpb24sCiAgICAgICAgICAgIHNlbGYudGVzdF9wYXRoX25vcm1hbGl6YXRpb24sCiAgICAgICAgICAgIHNlbGYudGVzdF9wYXJhbWV0ZXJfcG9sbHV0aW9uLAogICAgICAgICAgICBzZWxmLnRlc3RfdGNwX2ZyYWdtZW50YXRpb24sCiAgICAgICAgICAgIHNlbGYudGVzdF9jb21wcmVzc2lvbl9ib21iLAogICAgICAgICAgICBzZWxmLnRlc3RfdGltaW5nX3JhY2VfY29uZGl0aW9ucywKICAgICAgICAgICAgIyBOZXcgYWR2YW5jZWQgdGVzdHMKICAgICAgICAgICAgc2VsZi50ZXN0X3BhcnNlcl9zdGF0ZV9jb25mdXNpb24sCiAgICAgICAgICAgIHNlbGYudGVzdF9idWZmZXJfYm91bmRhcnlfZGlzY3JlcGFuY2llcywKICAgICAgICAgICAgc2VsZi50ZXN0X25lc3RlZF9lbmNvZGluZ19jb25mdXNpb24sCiAgICAgICAgICAgIHNlbGYudGVzdF9wcm90b2NvbF90dW5uZWxpbmdfZGlzY3JlcGFuY2llcywKICAgICAgICAgICAgc2VsZi50ZXN0X2NhY2hlX2tleV9jb25mdXNpb24sCiAgICAgICAgICAgIHNlbGYudGVzdF9wYXJzZXJfYmFja3RyYWNraW5nX2RvcywKICAgICAgICAgICAgc2VsZi50ZXN0X2ludGVnZXJfb3ZlcmZsb3dfbGVuZ3RoLAogICAgICAgICAgICBzZWxmLnRlc3RfdG9jdG91X3JhY2VfY29uZGl0aW9ucywKICAgICAgICAgICAgc2VsZi50ZXN0X3F1aWNfaHR0cDNfY29uZnVzaW9uLAogICAgICAgICAgICBzZWxmLnRlc3RfbWxfd2FmX2V2YXNpb24sCiAgICAgICAgICAgIHNlbGYudGVzdF9jb250YWluZXJfb3JjaGVzdHJhdGlvbl9ieXBhc3MsCiAgICAgICAgICAgIHNlbGYudGVzdF9ncmFwaHFsX3Jlc3RfY29uZnVzaW9uCiAgICAgICAgXQogICAgICAgIAogICAgICAgIGZvciB0ZXN0IGluIGRpc2NyZXBhbmN5X3Rlc3RzOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0ZXN0KCkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcHJpbnQoZiIgIOKdjCBFcnJvciBpbiB7dGVzdC5fX25hbWVfX306IHtzdHIoZSl9IikKCiAgICAjIEFkdmFuY2VkIERpc2NyZXBhbmN5IFRlc3RzCiAgICBkZWYgdGVzdF9wYXJzZXJfc3RhdGVfY29uZnVzaW9uKHNlbGYpOgogICAgICAgICIiIlRlc3QgcGFyc2VyIHN0YXRlIG1hY2hpbmUgZGVzeW5jaHJvbml6YXRpb24iIiIKICAgICAgICBwcmludCgiICDwn5SEIFRlc3RpbmcgUGFyc2VyIFN0YXRlIE1hY2hpbmUgQ29uZnVzaW9uLi4uIikKICAgICAgICAKICAgICAgICAjIEhUVFAvMiBQc2V1ZG8tSGVhZGVyIEluamVjdGlvbgogICAgICAgIHRyeToKICAgICAgICAgICAgaGVhZGVycyA9IHsKICAgICAgICAgICAgICAgICc6bWV0aG9kJzogJ0dFVCcsCiAgICAgICAgICAgICAgICAnOnBhdGgnOiAnL2FkbWluJywKICAgICAgICAgICAgICAgICc6YXV0aG9yaXR5JzogJ2ludGVybmFsLmJhY2tlbmQnLAogICAgICAgICAgICAgICAgJzpzY2hlbWUnOiAnaHR0cHMnLAogICAgICAgICAgICAgICAgJ3gtb3ZlcnJpZGUtbWV0aG9kJzogJ1BPU1QnCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5zZXNzaW9uLmdldChzZWxmLnRhcmdldF91cmwsIGhlYWRlcnM9aGVhZGVycywgdGltZW91dD01KQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgIT0gNDAwOiAgIyBTaG91bGQgZmFpbCB3aXRoIHBzZXVkby1oZWFkZXJzIGluIEhUVFAvMS4xCiAgICAgICAgICAgICAgICBkaXNjcmVwYW5jeSA9IHsKICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdQYXJzZXIgU3RhdGUgQ29uZnVzaW9uJywKICAgICAgICAgICAgICAgICAgICAnc3VidHlwZSc6ICdIMiBQc2V1ZG8tSGVhZGVyIEluamVjdGlvbicsCiAgICAgICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ0hUVFAvMiBwc2V1ZG8taGVhZGVycyBhY2NlcHRlZCBpbiBIVFRQLzEuMSBjb250ZXh0JywKICAgICAgICAgICAgICAgICAgICAnaGVhZGVycyc6IGhlYWRlcnMsCiAgICAgICAgICAgICAgICAgICAgJ3Jlc3BvbnNlX2NvZGUnOiByZXNwb25zZS5zdGF0dXNfY29kZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2VsZi5jaGFpbl9tYXBbJ2Rpc2NyZXBhbmNpZXMnXS5hcHBlbmQoZGlzY3JlcGFuY3kpCiAgICAgICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkRpc2NyZXBhbmN5IiwgIlBhcnNlciBTdGF0ZSIsICJIMiBwc2V1ZG8taGVhZGVyIGNvbmZ1c2lvbiIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICAgICAgCiAgICAgICAgIyBXZWJTb2NrZXQgVXBncmFkZSBTdGF0ZSBDb25mdXNpb24KICAgICAgICB0cnk6CiAgICAgICAgICAgICMgU3RlcCAxOiBTdGFydCBXZWJTb2NrZXQgdXBncmFkZQogICAgICAgICAgICB3c19oZWFkZXJzID0gewogICAgICAgICAgICAgICAgJ1VwZ3JhZGUnOiAnd2Vic29ja2V0JywKICAgICAgICAgICAgICAgICdDb25uZWN0aW9uJzogJ1VwZ3JhZGUnLAogICAgICAgICAgICAgICAgJ1NlYy1XZWJTb2NrZXQtS2V5JzogJ2RHaGxJSE5oYlhCc1pTQnViMjVqWlE9PScsCiAgICAgICAgICAgICAgICAnU2VjLVdlYlNvY2tldC1WZXJzaW9uJzogJzEzJwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAjIFNlbmQgcGFydGlhbCB1cGdyYWRlCiAgICAgICAgICAgIHJlc3BvbnNlMSA9IHNlbGYuc2Vzc2lvbi5nZXQoc2VsZi50YXJnZXRfdXJsLCBoZWFkZXJzPXdzX2hlYWRlcnMsIHRpbWVvdXQ9MikKICAgICAgICAgICAgCiAgICAgICAgICAgICMgU3RlcCAyOiBTZW5kIG5vcm1hbCByZXF1ZXN0IGltbWVkaWF0ZWx5IGFmdGVyCiAgICAgICAgICAgIHJlc3BvbnNlMiA9IHNlbGYuc2Vzc2lvbi5nZXQoZiJ7c2VsZi50YXJnZXRfdXJsfS9hZG1pbiIsIHRpbWVvdXQ9MikKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHJlc3BvbnNlMi5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBkaXNjcmVwYW5jeSA9IHsKICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdQYXJzZXIgU3RhdGUgQ29uZnVzaW9uJywKICAgICAgICAgICAgICAgICAgICAnc3VidHlwZSc6ICdXZWJTb2NrZXQgU3RhdGUgTGVhaycsCiAgICAgICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1BhcnNlciBzdGF0ZSBsZWFrZWQgYmV0d2VlbiBXZWJTb2NrZXQgYW5kIEhUVFAnLAogICAgICAgICAgICAgICAgICAgICdldmlkZW5jZSc6ICdBZG1pbiBwYXRoIGFjY2Vzc2libGUgYWZ0ZXIgV2ViU29ja2V0IGF0dGVtcHQnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzZWxmLmNoYWluX21hcFsnZGlzY3JlcGFuY2llcyddLmFwcGVuZChkaXNjcmVwYW5jeSkKICAgICAgICAgICAgICAgIHNlbGYubG9nX2Rpc2NvdmVyeSgiRGlzY3JlcGFuY3kiLCAiUGFyc2VyIFN0YXRlIiwgIldlYlNvY2tldCBzdGF0ZSBsZWFrIikKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgdGVzdF9idWZmZXJfYm91bmRhcnlfZGlzY3JlcGFuY2llcyhzZWxmKToKICAgICAgICAiIiJUZXN0IGJ1ZmZlciBib3VuZGFyeSBjb25mdXNpb24iIiIKICAgICAgICBwcmludCgiICDwn5OKIFRlc3RpbmcgQnVmZmVyIEJvdW5kYXJ5IERpc2NyZXBhbmNpZXMuLi4iKQogICAgICAgIAogICAgICAgICMgSGVhZGVyIEJ1ZmZlciBCb3VuZGFyeSBUZXN0CiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIFRlc3QgOEtCIGJvdW5kYXJ5CiAgICAgICAgICAgIGxhcmdlX2hlYWRlcl92YWx1ZSA9ICdBJyAqIDgxOTIKICAgICAgICAgICAgaGVhZGVycyA9IHsKICAgICAgICAgICAgICAgICdYLUxhcmdlLUhlYWRlcic6IGxhcmdlX2hlYWRlcl92YWx1ZVs6ODAwMF0sCiAgICAgICAgICAgICAgICAnWC1TZWNyZXQnOiAnYWRtaW4nICAjIFRoaXMgbWlnaHQgZ2V0IHByb2Nlc3NlZCBkaWZmZXJlbnRseQogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICByZXNwb25zZSA9IHNlbGYuc2Vzc2lvbi5nZXQoc2VsZi50YXJnZXRfdXJsLCBoZWFkZXJzPWhlYWRlcnMsIHRpbWVvdXQ9NSkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlIGluIFsyMDAsIDQxMywgNDMxXToKICAgICAgICAgICAgICAgIGRpc2NyZXBhbmN5ID0gewogICAgICAgICAgICAgICAgICAgICd0eXBlJzogJ0J1ZmZlciBCb3VuZGFyeScsCiAgICAgICAgICAgICAgICAgICAgJ3N1YnR5cGUnOiAnSGVhZGVyIEJ1ZmZlciBPdmVyZmxvdycsCiAgICAgICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ0hlYWRlcnMgYXQgOEtCIGJvdW5kYXJ5IHByb2Nlc3NlZCBkaWZmZXJlbnRseScsCiAgICAgICAgICAgICAgICAgICAgJ2J1ZmZlcl9zaXplJzogODE5MiwKICAgICAgICAgICAgICAgICAgICAncmVzcG9uc2VfY29kZSc6IHJlc3BvbnNlLnN0YXR1c19jb2RlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzZWxmLmNoYWluX21hcFsnZGlzY3JlcGFuY2llcyddLmFwcGVuZChkaXNjcmVwYW5jeSkKICAgICAgICAgICAgICAgIHNlbGYubG9nX2Rpc2NvdmVyeSgiRGlzY3JlcGFuY3kiLCAiQnVmZmVyIEJvdW5kYXJ5IiwgIjhLQiBoZWFkZXIgYm91bmRhcnkiKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIAogICAgICAgICMgVVJMIExlbmd0aCBCb3VuZGFyeSBUZXN0CiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIFRlc3QgMktCIHZzIDhLQiBVUkwgbGltaXRzCiAgICAgICAgICAgIGZvciBzaXplIGluIFsyMDQ4LCA0MDk2LCA4MTkyXToKICAgICAgICAgICAgICAgIGxvbmdfcGF0aCA9ICcvJyArICdBJyAqIChzaXplIC0gMjApICsgJy8uLi9hZG1pbicKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5zZXNzaW9uLmdldChmIntzZWxmLnRhcmdldF91cmx9e2xvbmdfcGF0aH0iLCB0aW1lb3V0PTUpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlICE9IDQxNDoKICAgICAgICAgICAgICAgICAgICBkaXNjcmVwYW5jeSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnQnVmZmVyIEJvdW5kYXJ5JywKICAgICAgICAgICAgICAgICAgICAgICAgJ3N1YnR5cGUnOiAnVVJMIExlbmd0aCBMaW1pdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IGYnVVJMIGFjY2VwdGVkIGF0IHtzaXplfSBieXRlcycsCiAgICAgICAgICAgICAgICAgICAgICAgICdidWZmZXJfc2l6ZSc6IHNpemUsICAjIENoYW5nZWQgZnJvbSAndXJsX2xlbmd0aCcgdG8gJ2J1ZmZlcl9zaXplJyBmb3IgY29uc2lzdGVuY3kKICAgICAgICAgICAgICAgICAgICAgICAgJ3Jlc3BvbnNlX2NvZGUnOiByZXNwb25zZS5zdGF0dXNfY29kZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBzZWxmLmNoYWluX21hcFsnZGlzY3JlcGFuY2llcyddLmFwcGVuZChkaXNjcmVwYW5jeSkKICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkRpc2NyZXBhbmN5IiwgIkJ1ZmZlciBCb3VuZGFyeSIsIGYie3NpemV9IGJ5dGUgVVJMIGFjY2VwdGVkIikKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgdGVzdF9uZXN0ZWRfZW5jb2RpbmdfY29uZnVzaW9uKHNlbGYpOgogICAgICAgICIiIlRlc3QgbmVzdGVkIGVuY29kaW5nIHN0YXRlIHN0YWNrIGNvbmZ1c2lvbiIiIgogICAgICAgIHByaW50KCIgIPCflKIgVGVzdGluZyBOZXN0ZWQgRW5jb2RpbmcgQ29uZnVzaW9uLi4uIikKICAgICAgICAKICAgICAgICAjIE1peGVkIFVURi04IGFuZCBVVEYtMTYgQk9NIHN3aXRjaGluZwogICAgICAgIHRyeToKICAgICAgICAgICAgIyBVVEYtOCBCT00gZm9sbG93ZWQgYnkgVVRGLTE2IEJPTQogICAgICAgICAgICBwYXlsb2FkID0gYidceGVmXHhiYlx4YmYvYWRtaW5ceGZmXHhmZScKICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnNlc3Npb24uZ2V0KAogICAgICAgICAgICAgICAgc2VsZi50YXJnZXRfdXJsLAogICAgICAgICAgICAgICAgZGF0YT1wYXlsb2FkLAogICAgICAgICAgICAgICAgaGVhZGVycz17J0NvbnRlbnQtVHlwZSc6ICd0ZXh0L3BsYWluJ30sCiAgICAgICAgICAgICAgICB0aW1lb3V0PTUKICAgICAgICAgICAgKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgIT0gNDAwOgogICAgICAgICAgICAgICAgZGlzY3JlcGFuY3kgPSB7CiAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnTmVzdGVkIEVuY29kaW5nJywKICAgICAgICAgICAgICAgICAgICAnc3VidHlwZSc6ICdCT00gU3dpdGNoaW5nJywKICAgICAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnTWl4ZWQgQk9NIGVuY29kaW5nIGFjY2VwdGVkJywKICAgICAgICAgICAgICAgICAgICAncGF5bG9hZCc6ICdVVEYtOCBCT00gKyAvYWRtaW4gKyBVVEYtMTYgQk9NJywKICAgICAgICAgICAgICAgICAgICAncmVzcG9uc2VfY29kZSc6IHJlc3BvbnNlLnN0YXR1c19jb2RlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzZWxmLmNoYWluX21hcFsnZGlzY3JlcGFuY2llcyddLmFwcGVuZChkaXNjcmVwYW5jeSkKICAgICAgICAgICAgICAgIHNlbGYubG9nX2Rpc2NvdmVyeSgiRGlzY3JlcGFuY3kiLCAiRW5jb2RpbmciLCAiQk9NIHN3aXRjaGluZyBhY2NlcHRlZCIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICAgICAgCiAgICAgICAgIyBQZXJjZW50LUVuY29kaW5nIGluIERpZmZlcmVudCBCYXNlcwogICAgICAgIGVuY29kaW5nX3ZhcmlhdGlvbnMgPSBbCiAgICAgICAgICAgICgnSGV4IFN0YW5kYXJkJywgJy8lNjFkbWluJyksCiAgICAgICAgICAgICgnT2N0YWwnLCAnLyUwMTQxZG1pbicpLAogICAgICAgICAgICAoJ1VuaWNvZGUgSUlTJywgJy8ldTAwNjFkbWluJyksCiAgICAgICAgICAgICgnRG91YmxlIERlY2ltYWwnLCAnLyUlMzYlMzFkbWluJykKICAgICAgICBdCiAgICAgICAgCiAgICAgICAgZm9yIG5hbWUsIHBhdGggaW4gZW5jb2RpbmdfdmFyaWF0aW9uczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnNlc3Npb24uZ2V0KGYie3NlbGYudGFyZ2V0X3VybH17cGF0aH0iLCB0aW1lb3V0PTUpCiAgICAgICAgICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICAgICAgZGlzY3JlcGFuY3kgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICd0eXBlJzogJ05lc3RlZCBFbmNvZGluZycsCiAgICAgICAgICAgICAgICAgICAgICAgICdzdWJ0eXBlJzogZid7bmFtZX0gRW5jb2RpbmcnLAogICAgICAgICAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiBmJ3tuYW1lfSBlbmNvZGluZyBkZWNvZGVkIHRvIC9hZG1pbicsCiAgICAgICAgICAgICAgICAgICAgICAgICdlbmNvZGVkX3BhdGgnOiBwYXRoLAogICAgICAgICAgICAgICAgICAgICAgICAncmVzcG9uc2VfY29kZSc6IHJlc3BvbnNlLnN0YXR1c19jb2RlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydkaXNjcmVwYW5jaWVzJ10uYXBwZW5kKGRpc2NyZXBhbmN5KQogICAgICAgICAgICAgICAgICAgIHNlbGYubG9nX2Rpc2NvdmVyeSgiRGlzY3JlcGFuY3kiLCAiRW5jb2RpbmciLCBmIntuYW1lfSBlbmNvZGluZyBhY2NlcHRlZCIpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgdGVzdF9wcm90b2NvbF90dW5uZWxpbmdfZGlzY3JlcGFuY2llcyhzZWxmKToKICAgICAgICAiIiJUZXN0IHByb3RvY29sIG5lc3RpbmcgY29uZnVzaW9uIiIiCiAgICAgICAgcHJpbnQoIiAg8J+UgCBUZXN0aW5nIFByb3RvY29sIFR1bm5lbGluZyBEaXNjcmVwYW5jaWVzLi4uIikKICAgICAgICAKICAgICAgICAjIEhUVFAgaW4gSFRUUCAoQWJzb2x1dGUgVVJJKQogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnNlc3Npb24ucmVxdWVzdCgKICAgICAgICAgICAgICAgICdHRVQnLAogICAgICAgICAgICAgICAgZiJ7c2VsZi50YXJnZXRfdXJsfSIsCiAgICAgICAgICAgICAgICBoZWFkZXJzPXsKICAgICAgICAgICAgICAgICAgICAnSG9zdCc6ICdwdWJsaWMuc2l0ZScsCiAgICAgICAgICAgICAgICAgICAgJ1gtT3JpZ2luYWwtVVJMJzogJ2h0dHA6Ly9pbnRlcm5hbC5iYWNrZW5kL2FkbWluJwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHRpbWVvdXQ9NQogICAgICAgICAgICApCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAnYWRtaW4nIGluIHJlc3BvbnNlLnRleHQubG93ZXIoKSBvciByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBkaXNjcmVwYW5jeSA9IHsKICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdQcm90b2NvbCBUdW5uZWxpbmcnLAogICAgICAgICAgICAgICAgICAgICdzdWJ0eXBlJzogJ0Fic29sdXRlIFVSSSBDb25mdXNpb24nLAogICAgICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdJbnRlcm5hbCBVUkwgYWNjZXNzaWJsZSB2aWEgaGVhZGVyJywKICAgICAgICAgICAgICAgICAgICAndGVjaG5pcXVlJzogJ1gtT3JpZ2luYWwtVVJMIGhlYWRlcicsCiAgICAgICAgICAgICAgICAgICAgJ3Jlc3BvbnNlX2NvZGUnOiByZXNwb25zZS5zdGF0dXNfY29kZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2VsZi5jaGFpbl9tYXBbJ2Rpc2NyZXBhbmNpZXMnXS5hcHBlbmQoZGlzY3JlcGFuY3kpCiAgICAgICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkRpc2NyZXBhbmN5IiwgIlByb3RvY29sIFR1bm5lbGluZyIsICJBYnNvbHV0ZSBVUkkgY29uZnVzaW9uIikKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICAKICAgICAgICAjIE11bHRpcGxlIFByb3RvY29sIFVwZ3JhZGVzCiAgICAgICAgdHJ5OgogICAgICAgICAgICBoZWFkZXJzID0gewogICAgICAgICAgICAgICAgJ1VwZ3JhZGUnOiAnd2Vic29ja2V0LCBoMmMsIHNwZHkvMy4xJywKICAgICAgICAgICAgICAgICdDb25uZWN0aW9uJzogJ1VwZ3JhZGUnCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5zZXNzaW9uLmdldChzZWxmLnRhcmdldF91cmwsIGhlYWRlcnM9aGVhZGVycywgdGltZW91dD01KQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgbm90IGluIFs0MDAsIDQyNl06CiAgICAgICAgICAgICAgICBkaXNjcmVwYW5jeSA9IHsKICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdQcm90b2NvbCBUdW5uZWxpbmcnLAogICAgICAgICAgICAgICAgICAgICdzdWJ0eXBlJzogJ011bHRpcGxlIFVwZ3JhZGUgQ29uZnVzaW9uJywKICAgICAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnTXVsdGlwbGUgcHJvdG9jb2wgdXBncmFkZXMgbm90IHJlamVjdGVkJywKICAgICAgICAgICAgICAgICAgICAncHJvdG9jb2xzJzogJ3dlYnNvY2tldCwgaDJjLCBzcGR5LzMuMScsCiAgICAgICAgICAgICAgICAgICAgJ3Jlc3BvbnNlX2NvZGUnOiByZXNwb25zZS5zdGF0dXNfY29kZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2VsZi5jaGFpbl9tYXBbJ2Rpc2NyZXBhbmNpZXMnXS5hcHBlbmQoZGlzY3JlcGFuY3kpCiAgICAgICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkRpc2NyZXBhbmN5IiwgIlByb3RvY29sIiwgIk11bHRpcGxlIHVwZ3JhZGVzIGFjY2VwdGVkIikKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgdGVzdF9jYWNoZV9rZXlfY29uZnVzaW9uKHNlbGYpOgogICAgICAgICIiIlRlc3QgY2FjaGUga2V5IGNvbXB1dGF0aW9uIGRpc2NyZXBhbmNpZXMiIiIKICAgICAgICBwcmludCgiICDwn5SRIFRlc3RpbmcgQ2FjaGUgS2V5IENvbmZ1c2lvbi4uLiIpCiAgICAgICAgCiAgICAgICAgIyBDYXNlIFNlbnNpdGl2aXR5IE1pc21hdGNoCiAgICAgICAgY2FzZV92YXJpYXRpb25zID0gWwogICAgICAgICAgICAoJy9BRE1JTicsICdleGFtcGxlLmNvbScpLAogICAgICAgICAgICAoJy9hZG1pbicsICdFWEFNUExFLkNPTScpLAogICAgICAgICAgICAoJy9BZG1pbicsICdFeGFtcGxlLkNvbScpCiAgICAgICAgXQogICAgICAgIAogICAgICAgIHJlc3BvbnNlcyA9IHt9CiAgICAgICAgZm9yIHBhdGgsIGhvc3QgaW4gY2FzZV92YXJpYXRpb25zOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICByZXNwb25zZSA9IHNlbGYuc2Vzc2lvbi5nZXQoCiAgICAgICAgICAgICAgICAgICAgZiJ7c2VsZi50YXJnZXRfdXJsfXtwYXRofSIsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVycz17J0hvc3QnOiBob3N0fSwKICAgICAgICAgICAgICAgICAgICB0aW1lb3V0PTUKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGtleSA9IGYie3BhdGh9Ontob3N0fSIKICAgICAgICAgICAgICAgIHJlc3BvbnNlc1trZXldID0gcmVzcG9uc2Uuc3RhdHVzX2NvZGUKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIAogICAgICAgIGlmIGxlbihzZXQocmVzcG9uc2VzLnZhbHVlcygpKSkgPiAxOgogICAgICAgICAgICBkaXNjcmVwYW5jeSA9IHsKICAgICAgICAgICAgICAgICd0eXBlJzogJ0NhY2hlIEtleSBDb25mdXNpb24nLAogICAgICAgICAgICAgICAgJ3N1YnR5cGUnOiAnQ2FzZSBTZW5zaXRpdml0eScsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnRGlmZmVyZW50IHJlc3BvbnNlcyBmb3IgY2FzZSB2YXJpYXRpb25zJywKICAgICAgICAgICAgICAgICdyZXNwb25zZXMnOiByZXNwb25zZXMsCiAgICAgICAgICAgICAgICAndW5pcXVlX2NvZGVzJzogbGVuKHNldChyZXNwb25zZXMudmFsdWVzKCkpKQogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydkaXNjcmVwYW5jaWVzJ10uYXBwZW5kKGRpc2NyZXBhbmN5KQogICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkRpc2NyZXBhbmN5IiwgIkNhY2hlIiwgZiJDYXNlIHNlbnNpdGl2aXR5OiB7bGVuKHNldChyZXNwb25zZXMudmFsdWVzKCkpKX0gZGlmZmVyZW50IHJlc3BvbnNlcyIpCiAgICAgICAgCiAgICAgICAgIyBQYXJhbWV0ZXIgT3JkZXIgQ29uZnVzaW9uCiAgICAgICAgcGFyYW1fdmFyaWF0aW9ucyA9IFsKICAgICAgICAgICAgJy8/Yj0yJmE9MScsCiAgICAgICAgICAgICcvP2E9MSZiPTInLAogICAgICAgICAgICAnLz9hPTEmYj0yJicsCiAgICAgICAgICAgICcvP2E9MSZhbXA7Yj0yJwogICAgICAgIF0KICAgICAgICAKICAgICAgICBwYXJhbV9yZXNwb25zZXMgPSB7fQogICAgICAgIGZvciBwYXJhbXMgaW4gcGFyYW1fdmFyaWF0aW9uczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnNlc3Npb24uZ2V0KGYie3NlbGYudGFyZ2V0X3VybH17cGFyYW1zfSIsIHRpbWVvdXQ9NSkKICAgICAgICAgICAgICAgIHBhcmFtX3Jlc3BvbnNlc1twYXJhbXNdID0gcmVzcG9uc2Uuc3RhdHVzX2NvZGUKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIAogICAgICAgIGlmIGxlbihzZXQocGFyYW1fcmVzcG9uc2VzLnZhbHVlcygpKSkgPiAxOgogICAgICAgICAgICBkaXNjcmVwYW5jeSA9IHsKICAgICAgICAgICAgICAgICd0eXBlJzogJ0NhY2hlIEtleSBDb25mdXNpb24nLAogICAgICAgICAgICAgICAgJ3N1YnR5cGUnOiAnUGFyYW1ldGVyIE9yZGVyJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdQYXJhbWV0ZXIgb3JkZXIgYWZmZWN0cyBjYWNoaW5nJywKICAgICAgICAgICAgICAgICd2YXJpYXRpb25zJzogcGFyYW1fcmVzcG9uc2VzCiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2VsZi5jaGFpbl9tYXBbJ2Rpc2NyZXBhbmNpZXMnXS5hcHBlbmQoZGlzY3JlcGFuY3kpCiAgICAgICAgICAgIHNlbGYubG9nX2Rpc2NvdmVyeSgiRGlzY3JlcGFuY3kiLCAiQ2FjaGUiLCAiUGFyYW1ldGVyIG9yZGVyIG1hdHRlcnMiKQoKICAgIGRlZiB0ZXN0X3BhcnNlcl9iYWNrdHJhY2tpbmdfZG9zKHNlbGYpOgogICAgICAgICIiIlRlc3QgcGFyc2VyIGFsZ29yaXRobWljIGNvbXBsZXhpdHkiIiIKICAgICAgICBwcmludCgiICDij7HvuI8gVGVzdGluZyBQYXJzZXIgQmFja3RyYWNraW5nLi4uIikKICAgICAgICAKICAgICAgICAjIE5lc3RlZCBQYXJhbWV0ZXIgUGFyc2luZyBDb21wbGV4aXR5CiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIENyZWF0ZSBkZWVwbHkgbmVzdGVkIHBhcmFtZXRlcnMKICAgICAgICAgICAgbmVzdGVkX3BhcmFtcyA9IFtdCiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDUpOgogICAgICAgICAgICAgICAgZm9yIGogaW4gcmFuZ2UoNSk6CiAgICAgICAgICAgICAgICAgICAgZm9yIGsgaW4gcmFuZ2UoNSk6CiAgICAgICAgICAgICAgICAgICAgICAgIG5lc3RlZF9wYXJhbXMuYXBwZW5kKGYncFt7aX1dW3tqfV1be2t9XT12JykKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbXBsZXhfcXVlcnkgPSAnJicuam9pbihuZXN0ZWRfcGFyYW1zKQogICAgICAgICAgICAKICAgICAgICAgICAgc3RhcnRfdGltZSA9IHRpbWUudGltZSgpCiAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5zZXNzaW9uLmdldCgKICAgICAgICAgICAgICAgIGYie3NlbGYudGFyZ2V0X3VybH0vP3tjb21wbGV4X3F1ZXJ5fSIsCiAgICAgICAgICAgICAgICB0aW1lb3V0PTEwCiAgICAgICAgICAgICkKICAgICAgICAgICAgZWxhcHNlZCA9IHRpbWUudGltZSgpIC0gc3RhcnRfdGltZQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgZWxhcHNlZCA+IDI6ICAjIFNsb3cgcHJvY2Vzc2luZyBpbmRpY2F0ZXMgY29tcGxleGl0eSBpc3N1ZQogICAgICAgICAgICAgICAgZGlzY3JlcGFuY3kgPSB7CiAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnUGFyc2VyIENvbXBsZXhpdHknLAogICAgICAgICAgICAgICAgICAgICdzdWJ0eXBlJzogJ05lc3RlZCBQYXJhbWV0ZXIgRG9TJywKICAgICAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnTmVzdGVkIHBhcmFtZXRlcnMgY2F1c2Ugc2xvdyBwYXJzaW5nJywKICAgICAgICAgICAgICAgICAgICAncHJvY2Vzc2luZ190aW1lJzogZWxhcHNlZCwKICAgICAgICAgICAgICAgICAgICAnY29tcGxleGl0eSc6ICdPKG7CsyknLAogICAgICAgICAgICAgICAgICAgICdwYXJhbV9jb3VudCc6IGxlbihuZXN0ZWRfcGFyYW1zKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2VsZi5jaGFpbl9tYXBbJ2Rpc2NyZXBhbmNpZXMnXS5hcHBlbmQoZGlzY3JlcGFuY3kpCiAgICAgICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkRpc2NyZXBhbmN5IiwgIlBhcnNlciBEb1MiLCBmIlNsb3cgcGFyc2luZzoge2VsYXBzZWQ6LjJmfXMiKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwoKICAgIGRlZiB0ZXN0X2ludGVnZXJfb3ZlcmZsb3dfbGVuZ3RoKHNlbGYpOgogICAgICAgICIiIlRlc3QgaW50ZWdlciBvdmVyZmxvdyBpbiBsZW5ndGggY2FsY3VsYXRpb25zIiIiCiAgICAgICAgcHJpbnQoIiAg8J+UoiBUZXN0aW5nIEludGVnZXIgT3ZlcmZsb3cgaW4gTGVuZ3Rocy4uLiIpCiAgICAgICAgCiAgICAgICAgb3ZlcmZsb3dfdmFsdWVzID0gWwogICAgICAgICAgICAoJzJeMzInLCAnNDI5NDk2NzI5NicpLAogICAgICAgICAgICAoJzJeMzEnLCAnMjE0NzQ4MzY0OCcpLAogICAgICAgICAgICAoJ05lZ2F0aXZlJywgJy0xJyksCiAgICAgICAgICAgICgnU2NpZW50aWZpYycsICcxZTMnKSwKICAgICAgICAgICAgKCdIZXgnLCAnMHgxMDAnKQogICAgICAgIF0KICAgICAgICAKICAgICAgICBmb3IgbmFtZSwgdmFsdWUgaW4gb3ZlcmZsb3dfdmFsdWVzOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBoZWFkZXJzID0gewogICAgICAgICAgICAgICAgICAgICdDb250ZW50LUxlbmd0aCc6IHZhbHVlLAogICAgICAgICAgICAgICAgICAgICdUcmFuc2Zlci1FbmNvZGluZyc6ICdjaHVua2VkJyAgIyBGYWxsYmFjawogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICByZXNwb25zZSA9IHNlbGYuc2Vzc2lvbi5wb3N0KAogICAgICAgICAgICAgICAgICAgIHNlbGYudGFyZ2V0X3VybCwKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzPWhlYWRlcnMsCiAgICAgICAgICAgICAgICAgICAgZGF0YT1iJ3Rlc3QnLAogICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ9NQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSBub3QgaW4gWzQwMCwgNDExLCA0MTNdOgogICAgICAgICAgICAgICAgICAgIGRpc2NyZXBhbmN5ID0gewogICAgICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdJbnRlZ2VyIE92ZXJmbG93JywKICAgICAgICAgICAgICAgICAgICAgICAgJ3N1YnR5cGUnOiBmJ3tuYW1lfSBDb250ZW50LUxlbmd0aCcsCiAgICAgICAgICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IGYnTm9uLXN0YW5kYXJkIGxlbmd0aCB2YWx1ZSBhY2NlcHRlZDoge3ZhbHVlfScsCiAgICAgICAgICAgICAgICAgICAgICAgICdsZW5ndGhfdmFsdWUnOiB2YWx1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgJ3Jlc3BvbnNlX2NvZGUnOiByZXNwb25zZS5zdGF0dXNfY29kZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBzZWxmLmNoYWluX21hcFsnZGlzY3JlcGFuY2llcyddLmFwcGVuZChkaXNjcmVwYW5jeSkKICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkRpc2NyZXBhbmN5IiwgIkludGVnZXIiLCBmIntuYW1lfSBsZW5ndGg6IHt2YWx1ZX0iKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgZGVmIHRlc3RfdG9jdG91X3JhY2VfY29uZGl0aW9ucyhzZWxmKToKICAgICAgICAiIiJUZXN0IFRpbWUtb2YtQ2hlY2sgdnMgVGltZS1vZi1Vc2UgcmFjZSBjb25kaXRpb25zIiIiCiAgICAgICAgcHJpbnQoIiAg4pqhIFRlc3RpbmcgVE9DVE9VIFJhY2UgQ29uZGl0aW9ucy4uLiIpCiAgICAgICAgCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXN1bHRzID0gW10KICAgICAgICAgICAgCiAgICAgICAgICAgIGRlZiByYWNlX3JlcXVlc3QoZGVsYXkpOgogICAgICAgICAgICAgICAgdGltZS5zbGVlcChkZWxheSkKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICByZXNwID0gc2VsZi5zZXNzaW9uLmdldChmIntzZWxmLnRhcmdldF91cmx9L2FwaS9hZG1pbiIsIHRpbWVvdXQ9MykKICAgICAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgoZGVsYXksIHJlc3Auc3RhdHVzX2NvZGUpKQogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKChkZWxheSwgJ2Vycm9yJykpCiAgICAgICAgICAgIAogICAgICAgICAgICAjIFNlbmQgcmVxdWVzdHMgd2l0aCBtaWNyby1kZWxheXMKICAgICAgICAgICAgdGhyZWFkcyA9IFtdCiAgICAgICAgICAgIGZvciBkZWxheSBpbiBbMCwgMC4wMDEsIDAuMDEsIDAuMDVdOgogICAgICAgICAgICAgICAgdGhyZWFkID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9cmFjZV9yZXF1ZXN0LCBhcmdzPShkZWxheSwpKQogICAgICAgICAgICAgICAgdGhyZWFkcy5hcHBlbmQodGhyZWFkKQogICAgICAgICAgICAgICAgdGhyZWFkLnN0YXJ0KCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvciB0aHJlYWQgaW4gdGhyZWFkczoKICAgICAgICAgICAgICAgIHRocmVhZC5qb2luKCkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQ2hlY2sgZm9yIHRpbWluZy1kZXBlbmRlbnQgZGlmZmVyZW5jZXMKICAgICAgICAgICAgc3RhdHVzX2NvZGVzID0gW3JbMV0gZm9yIHIgaW4gcmVzdWx0cyBpZiByWzFdICE9ICdlcnJvciddCiAgICAgICAgICAgIGlmIGxlbihzZXQoc3RhdHVzX2NvZGVzKSkgPiAxOgogICAgICAgICAgICAgICAgZGlzY3JlcGFuY3kgPSB7CiAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnVE9DVE9VIFJhY2UnLAogICAgICAgICAgICAgICAgICAgICdzdWJ0eXBlJzogJ0FzeW5jIFZhbGlkYXRpb24nLAogICAgICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdSYWNlIGNvbmRpdGlvbiBpbiByZXF1ZXN0IHZhbGlkYXRpb24nLAogICAgICAgICAgICAgICAgICAgICd0aW1pbmdfcmVzdWx0cyc6IHJlc3VsdHMsCiAgICAgICAgICAgICAgICAgICAgJ3VuaXF1ZV9yZXNwb25zZXMnOiBsZW4oc2V0KHN0YXR1c19jb2RlcykpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzZWxmLmNoYWluX21hcFsnZGlzY3JlcGFuY2llcyddLmFwcGVuZChkaXNjcmVwYW5jeSkKICAgICAgICAgICAgICAgIHNlbGYubG9nX2Rpc2NvdmVyeSgiRGlzY3JlcGFuY3kiLCAiVE9DVE9VIiwgZiJSYWNlIGNvbmRpdGlvbiBkZXRlY3RlZDoge2xlbihzZXQoc3RhdHVzX2NvZGVzKSl9IHJlc3BvbnNlcyIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCgogICAgZGVmIHRlc3RfcXVpY19odHRwM19jb25mdXNpb24oc2VsZik6CiAgICAgICAgIiIiVGVzdCBRVUlDL0hUVFAzIHNwZWNpZmljIGRpc2NyZXBhbmNpZXMiIiIKICAgICAgICBwcmludCgiICDwn5qAIFRlc3RpbmcgUVVJQy9IVFRQMyBDb25mdXNpb24uLi4iKQogICAgICAgIAogICAgICAgIGlmIHNlbGYucHJvdG9jb2xzWydodHRwMyddOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAjIFRlc3QgQWx0LVN2YyBtYW5pcHVsYXRpb24KICAgICAgICAgICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICAgICAgJ0FsdC1Vc2VkJzogJ2V2aWwuY29tOjQ0MycsCiAgICAgICAgICAgICAgICAgICAgJ0FsdC1TdmMnOiAnaDMtMjk9Ijo0NDMiOyBtYT04NjQwMCcKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnNlc3Npb24uZ2V0KHNlbGYudGFyZ2V0X3VybCwgaGVhZGVycz1oZWFkZXJzLCB0aW1lb3V0PTUpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgICAgICBkaXNjcmVwYW5jeSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnUVVJQy9IVFRQMycsCiAgICAgICAgICAgICAgICAgICAgICAgICdzdWJ0eXBlJzogJ0FsdC1TdmMgTWFuaXB1bGF0aW9uJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ0FsdC1TdmMgaGVhZGVycyBhY2NlcHRlZCBhbmQgbWF5IGFmZmVjdCByb3V0aW5nJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2hlYWRlcnMnOiBoZWFkZXJzCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydkaXNjcmVwYW5jaWVzJ10uYXBwZW5kKGRpc2NyZXBhbmN5KQogICAgICAgICAgICAgICAgICAgIHNlbGYubG9nX2Rpc2NvdmVyeSgiRGlzY3JlcGFuY3kiLCAiUVVJQyIsICJBbHQtU3ZjIG1hbmlwdWxhdGlvbiBwb3NzaWJsZSIpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgdGVzdF9tbF93YWZfZXZhc2lvbihzZWxmKToKICAgICAgICAiIiJUZXN0IE1MLWJhc2VkIFdBRiBldmFzaW9uIHRlY2huaXF1ZXMiIiIKICAgICAgICBwcmludCgiICDwn6SWIFRlc3RpbmcgTUwgV0FGIEV2YXNpb24uLi4iKQogICAgICAgIAogICAgICAgICMgQWR2ZXJzYXJpYWwgUGFkZGluZwogICAgICAgIHRyeToKICAgICAgICAgICAgYmVuaWduX3Rva2VucyA9IFsndXNlcicsICdsb2dpbicsICd3ZWxjb21lJywgJ2Rhc2hib2FyZCcsICdwcm9maWxlJ10KICAgICAgICAgICAgcGFkZGluZyA9ICcgJy5qb2luKHJhbmRvbS5jaG9pY2VzKGJlbmlnbl90b2tlbnMsIGs9MTAwKSkKICAgICAgICAgICAgCiAgICAgICAgICAgIHBheWxvYWQgPSBmIntwYWRkaW5nfSA8c2NyaXB0PmFsZXJ0KDEpPC9zY3JpcHQ+IHtwYWRkaW5nfSIKICAgICAgICAgICAgCiAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5zZXNzaW9uLmdldCgKICAgICAgICAgICAgICAgIGYie3NlbGYudGFyZ2V0X3VybH0vP3E9e3VybGxpYi5wYXJzZS5xdW90ZShwYXlsb2FkKX0iLAogICAgICAgICAgICAgICAgdGltZW91dD01CiAgICAgICAgICAgICkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlIG5vdCBpbiBbNDAzLCA0MDZdOgogICAgICAgICAgICAgICAgZGlzY3JlcGFuY3kgPSB7CiAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnTUwgV0FGIEV2YXNpb24nLAogICAgICAgICAgICAgICAgICAgICdzdWJ0eXBlJzogJ0FkdmVyc2FyaWFsIFBhZGRpbmcnLAogICAgICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdCZW5pZ24gdG9rZW4gcGFkZGluZyBtYXkgY29uZnVzZSBNTCBtb2RlbHMnLAogICAgICAgICAgICAgICAgICAgICdwYWRkaW5nX3NpemUnOiBsZW4ocGFkZGluZyksCiAgICAgICAgICAgICAgICAgICAgJ3Jlc3BvbnNlX2NvZGUnOiByZXNwb25zZS5zdGF0dXNfY29kZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2VsZi5jaGFpbl9tYXBbJ2Rpc2NyZXBhbmNpZXMnXS5hcHBlbmQoZGlzY3JlcGFuY3kpCiAgICAgICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkRpc2NyZXBhbmN5IiwgIk1MIEV2YXNpb24iLCAiQWR2ZXJzYXJpYWwgcGFkZGluZyBlZmZlY3RpdmUiKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIAogICAgICAgICMgQ29udGV4dCBXaW5kb3cgT3ZlcmZsb3cKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgQ3JlYXRlIHBheWxvYWQgdGhhdCBleGNlZWRzIHR5cGljYWwgY29udGV4dCB3aW5kb3dzCiAgICAgICAgICAgIHByZV9jb250ZXh0ID0gJ3NhZmUgY29udGVudCAnICogMjAwICAjIH4yNDAwIGNoYXJzCiAgICAgICAgICAgIG1hbGljaW91cyA9ICc8aW1nIHNyYz14IG9uZXJyb3I9YWxlcnQoMSk+JwogICAgICAgICAgICBwb3N0X2NvbnRleHQgPSAnIHNhZmUgY29udGVudCcgKiAyMDAKICAgICAgICAgICAgCiAgICAgICAgICAgIGZ1bGxfcGF5bG9hZCA9IHByZV9jb250ZXh0ICsgbWFsaWNpb3VzICsgcG9zdF9jb250ZXh0CiAgICAgICAgICAgIAogICAgICAgICAgICByZXNwb25zZSA9IHNlbGYuc2Vzc2lvbi5wb3N0KAogICAgICAgICAgICAgICAgc2VsZi50YXJnZXRfdXJsLAogICAgICAgICAgICAgICAgZGF0YT17J2NvbnRlbnQnOiBmdWxsX3BheWxvYWR9LAogICAgICAgICAgICAgICAgdGltZW91dD01CiAgICAgICAgICAgICkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlIG5vdCBpbiBbNDAzLCA0MDZdOgogICAgICAgICAgICAgICAgZGlzY3JlcGFuY3kgPSB7CiAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnTUwgV0FGIEV2YXNpb24nLAogICAgICAgICAgICAgICAgICAgICdzdWJ0eXBlJzogJ0NvbnRleHQgV2luZG93IE92ZXJmbG93JywKICAgICAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnTGFyZ2UgY29udGV4dCBtYXkgZXhjZWVkIE1MIG1vZGVsIHdpbmRvdycsCiAgICAgICAgICAgICAgICAgICAgJ3BheWxvYWRfc2l6ZSc6IGxlbihmdWxsX3BheWxvYWQpLAogICAgICAgICAgICAgICAgICAgICdyZXNwb25zZV9jb2RlJzogcmVzcG9uc2Uuc3RhdHVzX2NvZGUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydkaXNjcmVwYW5jaWVzJ10uYXBwZW5kKGRpc2NyZXBhbmN5KQogICAgICAgICAgICAgICAgc2VsZi5sb2dfZGlzY292ZXJ5KCJEaXNjcmVwYW5jeSIsICJNTCBFdmFzaW9uIiwgIkNvbnRleHQgd2luZG93IG92ZXJmbG93IikKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgdGVzdF9jb250YWluZXJfb3JjaGVzdHJhdGlvbl9ieXBhc3Moc2VsZik6CiAgICAgICAgIiIiVGVzdCBjb250YWluZXIvb3JjaGVzdHJhdGlvbiBsYXllciBieXBhc3NlcyIiIgogICAgICAgIHByaW50KCIgIPCfkLMgVGVzdGluZyBDb250YWluZXIgT3JjaGVzdHJhdGlvbiBCeXBhc3MuLi4iKQogICAgICAgIAogICAgICAgICMgU2VydmljZSBNZXNoIEhlYWRlcnMKICAgICAgICB0cnk6CiAgICAgICAgICAgIGs4c19oZWFkZXJzID0gewogICAgICAgICAgICAgICAgJ1gtRm9yd2FyZGVkLUhvc3QnOiAnYWRtaW4tc2VydmljZS5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsJywKICAgICAgICAgICAgICAgICdYLUVudm95LURlY29yYXRvci1PcGVyYXRpb24nOiAnYWRtaW4tc2VydmljZS5hZG1pbi5zdmMuY2x1c3Rlci5sb2NhbC8qJywKICAgICAgICAgICAgICAgICdYLUIzLVRyYWNlSWQnOiAnJy5qb2luKHJhbmRvbS5jaG9pY2VzKCcwMTIzNDU2Nzg5YWJjZGVmJywgaz0zMikpLAogICAgICAgICAgICAgICAgJ1gtQjMtU3BhbklkJzogJycuam9pbihyYW5kb20uY2hvaWNlcygnMDEyMzQ1Njc4OWFiY2RlZicsIGs9MTYpKQogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICByZXNwb25zZSA9IHNlbGYuc2Vzc2lvbi5nZXQoCiAgICAgICAgICAgICAgICBmIntzZWxmLnRhcmdldF91cmx9L2FkbWluIiwKICAgICAgICAgICAgICAgIGhlYWRlcnM9azhzX2hlYWRlcnMsCiAgICAgICAgICAgICAgICB0aW1lb3V0PTUKICAgICAgICAgICAgKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgZGlzY3JlcGFuY3kgPSB7CiAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnQ29udGFpbmVyIE9yY2hlc3RyYXRpb24nLAogICAgICAgICAgICAgICAgICAgICdzdWJ0eXBlJzogJ1NlcnZpY2UgTWVzaCBIZWFkZXJzJywKICAgICAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnSzhzIHNlcnZpY2UgbWVzaCBoZWFkZXJzIGFmZmVjdCByb3V0aW5nJywKICAgICAgICAgICAgICAgICAgICAnaGVhZGVycyc6IGs4c19oZWFkZXJzLAogICAgICAgICAgICAgICAgICAgICdyZXNwb25zZV9jb2RlJzogcmVzcG9uc2Uuc3RhdHVzX2NvZGUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydkaXNjcmVwYW5jaWVzJ10uYXBwZW5kKGRpc2NyZXBhbmN5KQogICAgICAgICAgICAgICAgc2VsZi5sb2dfZGlzY292ZXJ5KCJEaXNjcmVwYW5jeSIsICJLOHMiLCAiU2VydmljZSBtZXNoIGhlYWRlciBieXBhc3MiKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwoKICAgIGRlZiB0ZXN0X2dyYXBocWxfcmVzdF9jb25mdXNpb24oc2VsZik6CiAgICAgICAgIiIiVGVzdCBHcmFwaFFMLVJFU1QgZ2F0ZXdheSBjb25mdXNpb24iIiIKICAgICAgICBwcmludCgiICDwn5OKIFRlc3RpbmcgR3JhcGhRTC1SRVNUIEdhdGV3YXkgQ29uZnVzaW9uLi4uIikKICAgICAgICAKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgUkVTVCB0byBHcmFwaFFMIEluamVjdGlvbgogICAgICAgICAgICBncmFwaHFsX2luX3Jlc3QgPSB7CiAgICAgICAgICAgICAgICAncGF0aCc6ICcvYXBpL3VzZXJzLzE7cXVlcnl7YWRtaW57cGFzc3dvcmR9fScsCiAgICAgICAgICAgICAgICAnaGVhZGVycyc6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfQogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICByZXNwb25zZSA9IHNlbGYuc2Vzc2lvbi5nZXQoCiAgICAgICAgICAgICAgICBmIntzZWxmLnRhcmdldF91cmx9e2dyYXBocWxfaW5fcmVzdFsncGF0aCddfSIsCiAgICAgICAgICAgICAgICBoZWFkZXJzPWdyYXBocWxfaW5fcmVzdFsnaGVhZGVycyddLAogICAgICAgICAgICAgICAgdGltZW91dD01CiAgICAgICAgICAgICkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICdhZG1pbicgaW4gcmVzcG9uc2UudGV4dCBvciAnZ3JhcGhxbCcgaW4gcmVzcG9uc2UudGV4dC5sb3dlcigpOgogICAgICAgICAgICAgICAgZGlzY3JlcGFuY3kgPSB7CiAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnR3JhcGhRTC1SRVNUIENvbmZ1c2lvbicsCiAgICAgICAgICAgICAgICAgICAgJ3N1YnR5cGUnOiAnUkVTVCB0byBHcmFwaFFMIEluamVjdGlvbicsCiAgICAgICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ0dyYXBoUUwgcXVlcnkgaW4gUkVTVCBlbmRwb2ludCcsCiAgICAgICAgICAgICAgICAgICAgJ2luamVjdGlvbl9wb2ludCc6ICdVUkwgcGF0aCBwYXJhbWV0ZXInLAogICAgICAgICAgICAgICAgICAgICdyZXNwb25zZV9jb2RlJzogcmVzcG9uc2Uuc3RhdHVzX2NvZGUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydkaXNjcmVwYW5jaWVzJ10uYXBwZW5kKGRpc2NyZXBhbmN5KQogICAgICAgICAgICAgICAgc2VsZi5sb2dfZGlzY292ZXJ5KCJEaXNjcmVwYW5jeSIsICJHcmFwaFFMIiwgIlJFU1QtR3JhcGhRTCBib3VuZGFyeSBjb25mdXNpb24iKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIAogICAgICAgICMgR3JhcGhRTCBCYXRjaGluZyB2aWEgUkVTVAogICAgICAgIHRyeToKICAgICAgICAgICAgYmF0Y2hfcGF5bG9hZCA9IHsKICAgICAgICAgICAgICAgICdxdWVyeSc6IFsKICAgICAgICAgICAgICAgICAgICAncXVlcnkgeyB1c2VyIHsgbmFtZSB9IH0nLAogICAgICAgICAgICAgICAgICAgICdtdXRhdGlvbiB7IGRlbGV0ZUFsbFVzZXJzIH0nCiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5zZXNzaW9uLnBvc3QoCiAgICAgICAgICAgICAgICBmIntzZWxmLnRhcmdldF91cmx9L2dyYXBocWwiLAogICAgICAgICAgICAgICAganNvbj1iYXRjaF9wYXlsb2FkLAogICAgICAgICAgICAgICAgdGltZW91dD01CiAgICAgICAgICAgICkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIGRpc2NyZXBhbmN5ID0gewogICAgICAgICAgICAgICAgICAgICd0eXBlJzogJ0dyYXBoUUwtUkVTVCBDb25mdXNpb24nLAogICAgICAgICAgICAgICAgICAgICdzdWJ0eXBlJzogJ0JhdGNoIFF1ZXJ5IEluamVjdGlvbicsCiAgICAgICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ0dyYXBoUUwgYmF0Y2hpbmcgYWNjZXB0ZWQgdmlhIFJFU1QnLAogICAgICAgICAgICAgICAgICAgICd0ZWNobmlxdWUnOiAnQXJyYXkgb2YgcXVlcmllcycKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydkaXNjcmVwYW5jaWVzJ10uYXBwZW5kKGRpc2NyZXBhbmN5KQogICAgICAgICAgICAgICAgc2VsZi5sb2dfZGlzY292ZXJ5KCJEaXNjcmVwYW5jeSIsICJHcmFwaFFMIiwgIkJhdGNoIHF1ZXJpZXMgYWNjZXB0ZWQiKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwoKICAgIGRlZiB0ZXN0X3RjcF9mcmFnbWVudGF0aW9uKHNlbGYpOgogICAgICAgICIiIlRlc3QgVENQIGZyYWdtZW50YXRpb24gYnlwYXNzIHRlY2huaXF1ZXMiIiIKICAgICAgICBwcmludCgiICDwn4yKIFRlc3RpbmcgVENQIEZyYWdtZW50YXRpb24gQnlwYXNzLi4uIikKICAgICAgICAKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgQ3JlYXRlIGEgcmF3IHNvY2tldCBjb25uZWN0aW9uIGZvciBmcmFnbWVudGF0aW9uIHRlc3RpbmcKICAgICAgICAgICAgaW1wb3J0IHNvY2tldAogICAgICAgICAgICAKICAgICAgICAgICAgIyBUZXN0IHBheWxvYWQgc3BsaXQgYWNyb3NzIFRDUCBzZWdtZW50cwogICAgICAgICAgICB0YXJnZXRfaG9zdCA9IHNlbGYucGFyc2VkX3VybC5ob3N0bmFtZQogICAgICAgICAgICB0YXJnZXRfcG9ydCA9IDQ0MyBpZiBzZWxmLnBhcnNlZF91cmwuc2NoZW1lID09ICdodHRwcycgZWxzZSA4MAogICAgICAgICAgICAKICAgICAgICAgICAgIyBDcmVhdGUgZnJhZ21lbnRlZCBIVFRQIHJlcXVlc3QKICAgICAgICAgICAgcmVxdWVzdF9wYXJ0MSA9IGIiR0VUIC9hZG0iCiAgICAgICAgICAgIHJlcXVlc3RfcGFydDIgPSBiImluIEhUVFAvMS4xXHJcbkhvc3Q6ICIgKyB0YXJnZXRfaG9zdC5lbmNvZGUoKSArIGIiXHJcblxyXG4iCiAgICAgICAgICAgIAogICAgICAgICAgICBzb2NrID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQogICAgICAgICAgICBpZiBzZWxmLnBhcnNlZF91cmwuc2NoZW1lID09ICdodHRwcyc6CiAgICAgICAgICAgICAgICBpbXBvcnQgc3NsCiAgICAgICAgICAgICAgICBjb250ZXh0ID0gc3NsLmNyZWF0ZV9kZWZhdWx0X2NvbnRleHQoKQogICAgICAgICAgICAgICAgc29jayA9IGNvbnRleHQud3JhcF9zb2NrZXQoc29jaywgc2VydmVyX2hvc3RuYW1lPXRhcmdldF9ob3N0KQogICAgICAgICAgICAKICAgICAgICAgICAgc29jay5jb25uZWN0KCh0YXJnZXRfaG9zdCwgdGFyZ2V0X3BvcnQpKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBTZW5kIGZyYWdtZW50ZWQgcmVxdWVzdAogICAgICAgICAgICBzb2NrLnNlbmQocmVxdWVzdF9wYXJ0MSkKICAgICAgICAgICAgdGltZS5zbGVlcCgwLjAxKSAgIyBTbWFsbCBkZWxheSB0byBlbnN1cmUgc2VwYXJhdGUgVENQIHNlZ21lbnRzCiAgICAgICAgICAgIHNvY2suc2VuZChyZXF1ZXN0X3BhcnQyKQogICAgICAgICAgICAKICAgICAgICAgICAgcmVzcG9uc2UgPSBzb2NrLnJlY3YoNDA5NikuZGVjb2RlKCd1dGYtOCcsIGVycm9ycz0naWdub3JlJykKICAgICAgICAgICAgc29jay5jbG9zZSgpCiAgICAgICAgICAgIAogICAgICAgICAgICAjIENoZWNrIGlmIGZyYWdtZW50YXRpb24gYWZmZWN0ZWQgcHJvY2Vzc2luZwogICAgICAgICAgICBpZiAiMjAwIE9LIiBpbiByZXNwb25zZSBvciAiYWRtaW4iIGluIHJlc3BvbnNlLmxvd2VyKCk6CiAgICAgICAgICAgICAgICBkaXNjcmVwYW5jeSA9IHsKICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdUQ1AgRnJhZ21lbnRhdGlvbicsCiAgICAgICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1RDUCBmcmFnbWVudGF0aW9uIG1heSBieXBhc3MgV0FGIGluc3BlY3Rpb24nLAogICAgICAgICAgICAgICAgICAgICdldmlkZW5jZSc6ICdGcmFnbWVudGVkIHJlcXVlc3QgcHJvY2Vzc2VkIGRpZmZlcmVudGx5JywKICAgICAgICAgICAgICAgICAgICAncGF5bG9hZCc6IHsncGFydDEnOiByZXF1ZXN0X3BhcnQxLCAncGFydDInOiByZXF1ZXN0X3BhcnQyfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2VsZi5jaGFpbl9tYXBbJ2Rpc2NyZXBhbmNpZXMnXS5hcHBlbmQoZGlzY3JlcGFuY3kpCiAgICAgICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkRpc2NyZXBhbmN5IiwgIlRDUCBGcmFnbWVudGF0aW9uIiwgIlBvdGVudGlhbCBmcmFnbWVudGF0aW9uIGJ5cGFzcyIpCiAgICAgICAgICAgICAgICAKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICMgRmFsbGJhY2sgdG8gYXBwbGljYXRpb24tbGV2ZWwgdGVzdGluZwogICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIlRDUCBGcmFnbWVudGF0aW9uIiwgIkluZm8iLCAiUmF3IHNvY2tldCB0ZXN0IGZhaWxlZCwgdXNpbmcgYXBwbGljYXRpb24tbGV2ZWwgdGVzdCIpCgogICAgZGVmIHRlc3RfY29tcHJlc3Npb25fYm9tYihzZWxmKToKICAgICAgICAiIiJUZXN0IGNvbXByZXNzaW9uIGJvbWIgYnlwYXNzIHRlY2huaXF1ZSIiIgogICAgICAgIHByaW50KCIgIPCfkqMgVGVzdGluZyBDb21wcmVzc2lvbiBCb21iIEJ5cGFzcy4uLiIpCiAgICAgICAgCiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIENyZWF0ZSBhIHBheWxvYWQgdGhhdCdzIHNtYWxsIGNvbXByZXNzZWQgYnV0IGxhcmdlIHVuY29tcHJlc3NlZAogICAgICAgICAgICBsYXJnZV9wYXlsb2FkID0gIkEiICogMTAwMDAgICMgMTBLQiB1bmNvbXByZXNzZWQKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQ29tcHJlc3MgdGhlIHBheWxvYWQKICAgICAgICAgICAgY29tcHJlc3NlZF9wYXlsb2FkID0gZ3ppcC5jb21wcmVzcyhsYXJnZV9wYXlsb2FkLmVuY29kZSgpKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBUZXN0IGlmIFdBRiBwcm9jZXNzZXMgY29tcHJlc3NlZCB2cyB1bmNvbXByZXNzZWQgZGlmZmVyZW50bHkKICAgICAgICAgICAgaGVhZGVycyA9IHsKICAgICAgICAgICAgICAgICdDb250ZW50LUVuY29kaW5nJzogJ2d6aXAnLAogICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLAogICAgICAgICAgICAgICAgJ0NvbnRlbnQtTGVuZ3RoJzogc3RyKGxlbihjb21wcmVzc2VkX3BheWxvYWQpKQogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICByZXNwb25zZSA9IHNlbGYuc2Vzc2lvbi5wb3N0KAogICAgICAgICAgICAgICAgc2VsZi50YXJnZXRfdXJsLAogICAgICAgICAgICAgICAgZGF0YT1jb21wcmVzc2VkX3BheWxvYWQsCiAgICAgICAgICAgICAgICBoZWFkZXJzPWhlYWRlcnMsCiAgICAgICAgICAgICAgICB0aW1lb3V0PTEwCiAgICAgICAgICAgICkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQ2hlY2sgZm9yIHByb2Nlc3NpbmcgZGlmZmVyZW5jZXMKICAgICAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgaW4gWzIwMCwgNDEzLCA0MTQsIDUwMl06CiAgICAgICAgICAgICAgICBkaXNjcmVwYW5jeSA9IHsKICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdDb21wcmVzc2lvbiBCeXBhc3MnLAogICAgICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdDb21wcmVzc2lvbiBtYXkgYWZmZWN0IFdBRiBpbnNwZWN0aW9uJywKICAgICAgICAgICAgICAgICAgICAnY29tcHJlc3NlZF9zaXplJzogbGVuKGNvbXByZXNzZWRfcGF5bG9hZCksCiAgICAgICAgICAgICAgICAgICAgJ3VuY29tcHJlc3NlZF9zaXplJzogbGVuKGxhcmdlX3BheWxvYWQpLAogICAgICAgICAgICAgICAgICAgICdyYXRpbyc6IGxlbihsYXJnZV9wYXlsb2FkKSAvIGxlbihjb21wcmVzc2VkX3BheWxvYWQpLAogICAgICAgICAgICAgICAgICAgICdyZXNwb25zZV9jb2RlJzogcmVzcG9uc2Uuc3RhdHVzX2NvZGUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydkaXNjcmVwYW5jaWVzJ10uYXBwZW5kKGRpc2NyZXBhbmN5KQogICAgICAgICAgICAgICAgc2VsZi5sb2dfZGlzY292ZXJ5KCJEaXNjcmVwYW5jeSIsICJDb21wcmVzc2lvbiIsIGYiQ29tcHJlc3Npb24gcmF0aW86IHtkaXNjcmVwYW5jeVsncmF0aW8nXTouMWZ9eCIpCiAgICAgICAgICAgICAgICAKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgdGVzdF90aW1pbmdfcmFjZV9jb25kaXRpb25zKHNlbGYpOgogICAgICAgICIiIlRlc3QgdGltaW5nLWJhc2VkIHBhcnNlciByYWNlIGNvbmRpdGlvbnMiIiIKICAgICAgICBwcmludCgiICDij7HvuI8gVGVzdGluZyBUaW1pbmcgUmFjZSBDb25kaXRpb25zLi4uIikKICAgICAgICAKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgVGVzdCBjb25jdXJyZW50IHJlcXVlc3RzIHdpdGggdGltaW5nIHZhcmlhdGlvbnMKICAgICAgICAgICAgaW1wb3J0IHRocmVhZGluZwogICAgICAgICAgICBpbXBvcnQgcXVldWUKICAgICAgICAgICAgCiAgICAgICAgICAgIHJlc3VsdHMgPSBxdWV1ZS5RdWV1ZSgpCiAgICAgICAgICAgIAogICAgICAgICAgICBkZWYgc2VuZF9kZWxheWVkX3JlcXVlc3QoZGVsYXksIHJlcXVlc3RfZGF0YSk6CiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKGRlbGF5KQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5zZXNzaW9uLnBvc3Qoc2VsZi50YXJnZXRfdXJsLCBkYXRhPXJlcXVlc3RfZGF0YSwgdGltZW91dD01KQogICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHV0KCgnc3VjY2VzcycsIHJlc3BvbnNlLnN0YXR1c19jb2RlLCBkZWxheSkpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5wdXQoKCdlcnJvcicsIHN0cihlKSwgZGVsYXkpKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBUZXN0IHdpdGggZGlmZmVyZW50IHRpbWluZyBkZWxheXMKICAgICAgICAgICAgdGVzdF9kYXRhID0gInBhcmFtPXZhbHVlJmFkbWluPXRydWUiCiAgICAgICAgICAgIGRlbGF5cyA9IFswLCAwLjAwMSwgMC4wMSwgMC4xXSAgIyBEaWZmZXJlbnQgbWljcm8tdGltaW5nCiAgICAgICAgICAgIAogICAgICAgICAgICB0aHJlYWRzID0gW10KICAgICAgICAgICAgZm9yIGRlbGF5IGluIGRlbGF5czoKICAgICAgICAgICAgICAgIHRocmVhZCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PXNlbmRfZGVsYXllZF9yZXF1ZXN0LCBhcmdzPShkZWxheSwgdGVzdF9kYXRhKSkKICAgICAgICAgICAgICAgIHRocmVhZHMuYXBwZW5kKHRocmVhZCkKICAgICAgICAgICAgICAgIHRocmVhZC5zdGFydCgpCiAgICAgICAgICAgIAogICAgICAgICAgICAjIFdhaXQgZm9yIGFsbCB0aHJlYWRzCiAgICAgICAgICAgIGZvciB0aHJlYWQgaW4gdGhyZWFkczoKICAgICAgICAgICAgICAgIHRocmVhZC5qb2luKCkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQW5hbHl6ZSB0aW1pbmcgcmVzdWx0cwogICAgICAgICAgICB0aW1pbmdfcmVzdWx0cyA9IFtdCiAgICAgICAgICAgIHdoaWxlIG5vdCByZXN1bHRzLmVtcHR5KCk6CiAgICAgICAgICAgICAgICB0aW1pbmdfcmVzdWx0cy5hcHBlbmQocmVzdWx0cy5nZXQoKSkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQ2hlY2sgZm9yIHRpbWluZy1kZXBlbmRlbnQgZGlmZmVyZW5jZXMKICAgICAgICAgICAgc3RhdHVzX2NvZGVzID0gW3JbMV0gZm9yIHIgaW4gdGltaW5nX3Jlc3VsdHMgaWYgclswXSA9PSAnc3VjY2VzcyddCiAgICAgICAgICAgIGlmIGxlbihzZXQoc3RhdHVzX2NvZGVzKSkgPiAxOgogICAgICAgICAgICAgICAgZGlzY3JlcGFuY3kgPSB7CiAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnVGltaW5nIFJhY2UgQ29uZGl0aW9uJywKICAgICAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnVGltaW5nIGFmZmVjdHMgcmVxdWVzdCBwcm9jZXNzaW5nJywKICAgICAgICAgICAgICAgICAgICAndGltaW5nX3Jlc3VsdHMnOiB0aW1pbmdfcmVzdWx0cywKICAgICAgICAgICAgICAgICAgICAndW5pcXVlX3Jlc3BvbnNlcyc6IGxlbihzZXQoc3RhdHVzX2NvZGVzKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydkaXNjcmVwYW5jaWVzJ10uYXBwZW5kKGRpc2NyZXBhbmN5KQogICAgICAgICAgICAgICAgc2VsZi5sb2dfZGlzY292ZXJ5KCJEaXNjcmVwYW5jeSIsICJUaW1pbmcgUmFjZSIsIGYiVGltaW5nLWRlcGVuZGVudCByZXNwb25zZXM6IHtsZW4oc2V0KHN0YXR1c19jb2RlcykpfSIpCiAgICAgICAgICAgICAgICAKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgdGVzdF9odHRwX3NtdWdnbGluZyhzZWxmKToKICAgICAgICAiIiJUZXN0IGZvciBIVFRQIHJlcXVlc3Qgc211Z2dsaW5nIHZ1bG5lcmFiaWxpdGllcyIiIgogICAgICAgIHByaW50KCIgIPCflIAgVGVzdGluZyBIVFRQIFJlcXVlc3QgU211Z2dsaW5nLi4uIikKICAgICAgICAKICAgICAgICBzbXVnZ2xpbmdfcGF5bG9hZHMgPSBbCiAgICAgICAgICAgICMgQ0wtVEUgZGlzY3JlcGFuY3kKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJ2hlYWRlcnMnOiB7CiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtTGVuZ3RoJzogJzEzJywKICAgICAgICAgICAgICAgICAgICAnVHJhbnNmZXItRW5jb2RpbmcnOiAnY2h1bmtlZCcKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAnZGF0YSc6ICcwXHJcblxyXG5HRVQgL2FkbWluIEhUVFAvMS4xXHJcbkhvc3Q6IGludGVybmFsXHJcblxyXG4nCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICMgVEUtQ0wgZGlzY3JlcGFuY3kKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJ2hlYWRlcnMnOiB7CiAgICAgICAgICAgICAgICAgICAgJ1RyYW5zZmVyLUVuY29kaW5nJzogJ2NodW5rZWQnLAogICAgICAgICAgICAgICAgICAgICdDb250ZW50LUxlbmd0aCc6ICcwJwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICdkYXRhJzogJzFcclxuWlxyXG4wXHJcblxyXG4nCiAgICAgICAgICAgIH0KICAgICAgICBdCiAgICAgICAgCiAgICAgICAgZm9yIGksIHBheWxvYWQgaW4gZW51bWVyYXRlKHNtdWdnbGluZ19wYXlsb2Fkcyk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG1hcmtlciA9IHNlbGYuZ2VuZXJhdGVfdW5pcXVlX21hcmtlcnMoKVsndXVpZCddCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgU2VuZCBzbXVnZ2xpbmcgYXR0ZW1wdAogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnNlc3Npb24ucG9zdCgKICAgICAgICAgICAgICAgICAgICBzZWxmLnRhcmdldF91cmwsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVycz1wYXlsb2FkWydoZWFkZXJzJ10sCiAgICAgICAgICAgICAgICAgICAgZGF0YT1wYXlsb2FkWydkYXRhJ10ucmVwbGFjZSgnaW50ZXJuYWwnLCBtYXJrZXIpLAogICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ9NQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIExvb2sgZm9yIHNpZ25zIG9mIHN1Y2Nlc3NmdWwgc211Z2dsaW5nCiAgICAgICAgICAgICAgICBpZiBtYXJrZXIgaW4gcmVzcG9uc2UudGV4dCBvciByZXNwb25zZS5zdGF0dXNfY29kZSBpbiBbNDAwLCA0MTMsIDQxNF06CiAgICAgICAgICAgICAgICAgICAgZGlzY3JlcGFuY3kgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICd0eXBlJzogJ0hUVFAgU211Z2dsaW5nJywKICAgICAgICAgICAgICAgICAgICAgICAgJ3Rlc3RfaWQnOiBmJ3NtdWdnbGluZ197aX0nLAogICAgICAgICAgICAgICAgICAgICAgICAncGF5bG9hZCc6IHBheWxvYWQsCiAgICAgICAgICAgICAgICAgICAgICAgICdyZXNwb25zZV9jb2RlJzogcmVzcG9uc2Uuc3RhdHVzX2NvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICdldmlkZW5jZSc6IG1hcmtlciBpbiByZXNwb25zZS50ZXh0CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydkaXNjcmVwYW5jaWVzJ10uYXBwZW5kKGRpc2NyZXBhbmN5KQogICAgICAgICAgICAgICAgICAgIHNlbGYubG9nX2Rpc2NvdmVyeSgiRGlzY3JlcGFuY3kiLCAiSFRUUCBTbXVnZ2xpbmciLCBmIlBvdGVudGlhbCBzbXVnZ2xpbmcgaW4gdGVzdCB7aX0iKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgIGRlZiB0ZXN0X3VuaWNvZGVfY29uZnVzaW9uKHNlbGYpOgogICAgICAgICIiIlRlc3QgVW5pY29kZSBub3JtYWxpemF0aW9uIGRpc2NyZXBhbmNpZXMiIiIKICAgICAgICBwcmludCgiICDwn6esIFRlc3RpbmcgVW5pY29kZSBDb25mdXNpb24uLi4iKQogICAgICAgIAogICAgICAgIHVuaWNvZGVfdGVzdHMgPSBbCiAgICAgICAgICAgICMgTm9ybWFsaXphdGlvbiBmb3JtIGRpZmZlcmVuY2VzCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICdvcmlnaW5hbCc6ICcvYWRtaW4nLAogICAgICAgICAgICAgICAgJ25mYyc6ICcvYWRtaW4nLCAgIyBORkMgbm9ybWFsaXphdGlvbgogICAgICAgICAgICAgICAgJ25mZCc6ICcvXHUwMDYxXHUwMzAwXHUwMDY0XHUwMDZEXHUwMDY5XHUwMDZFJywgICMgTkZEIHdpdGggY29tYmluaW5nIGNoYXJzCiAgICAgICAgICAgICAgICAnY29uZnVzYWJsZXMnOiAnL86xZG1pbicsICAjIFVuaWNvZGUgY29uZnVzYWJsZXMgKM6xIHZzIGEpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICMgWmVyby13aWR0aCBjaGFyYWN0ZXIgaW5qZWN0aW9uCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICdvcmlnaW5hbCc6ICcvYWRtaW4nLAogICAgICAgICAgICAgICAgJ3p3c3AnOiAnL2FkXHUyMDBCbWluJywgICMgWmVyby13aWR0aCBzcGFjZQogICAgICAgICAgICAgICAgJ3p3bmonOiAnL2FkXHUyMDBDbWluJywgICMgWmVyby13aWR0aCBub24tam9pbmVyCiAgICAgICAgICAgICAgICAnendqJzogJy9hZFx1MjAwRG1pbicsICAgIyBaZXJvLXdpZHRoIGpvaW5lcgogICAgICAgICAgICB9CiAgICAgICAgXQogICAgICAgIAogICAgICAgIGZvciB0ZXN0X2dyb3VwIGluIHVuaWNvZGVfdGVzdHM6CiAgICAgICAgICAgIG9yaWdpbmFsID0gdGVzdF9ncm91cFsnb3JpZ2luYWwnXQogICAgICAgICAgICAKICAgICAgICAgICAgZm9yIHZhcmlhbnRfbmFtZSwgdmFyaWFudF9wYXRoIGluIHRlc3RfZ3JvdXAuaXRlbXMoKToKICAgICAgICAgICAgICAgIGlmIHZhcmlhbnRfbmFtZSA9PSAnb3JpZ2luYWwnOgogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgIyBUZXN0IG9yaWdpbmFsIHBhdGgKICAgICAgICAgICAgICAgICAgICByZXNwX29yaWdpbmFsID0gc2VsZi5zZXNzaW9uLmdldChmIntzZWxmLnRhcmdldF91cmx9e29yaWdpbmFsfSIpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgIyBUZXN0IHZhcmlhbnQgcGF0aCAgCiAgICAgICAgICAgICAgICAgICAgcmVzcF92YXJpYW50ID0gc2VsZi5zZXNzaW9uLmdldChmIntzZWxmLnRhcmdldF91cmx9e3ZhcmlhbnRfcGF0aH0iKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICMgQ29tcGFyZSByZXNwb25zZXMKICAgICAgICAgICAgICAgICAgICBpZiByZXNwX29yaWdpbmFsLnN0YXR1c19jb2RlICE9IHJlc3BfdmFyaWFudC5zdGF0dXNfY29kZToKICAgICAgICAgICAgICAgICAgICAgICAgZGlzY3JlcGFuY3kgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdVbmljb2RlIENvbmZ1c2lvbicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndmFyaWFudCc6IHZhcmlhbnRfbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvcmlnaW5hbF9wYXRoJzogb3JpZ2luYWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndmFyaWFudF9wYXRoJzogdmFyaWFudF9wYXRoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29yaWdpbmFsX2NvZGUnOiByZXNwX29yaWdpbmFsLnN0YXR1c19jb2RlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3ZhcmlhbnRfY29kZSc6IHJlc3BfdmFyaWFudC5zdGF0dXNfY29kZQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydkaXNjcmVwYW5jaWVzJ10uYXBwZW5kKGRpc2NyZXBhbmN5KQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkRpc2NyZXBhbmN5IiwgIlVuaWNvZGUiLCBmInt2YXJpYW50X25hbWV9OiB7cmVzcF9vcmlnaW5hbC5zdGF0dXNfY29kZX0gdnMge3Jlc3BfdmFyaWFudC5zdGF0dXNfY29kZX0iKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgIGRlZiB0ZXN0X2VuY29kaW5nX2Rpc2NyZXBhbmNpZXMoc2VsZik6CiAgICAgICAgIiIiVGVzdCBtdWx0aS1sYXllciBlbmNvZGluZyBkaXNjcmVwYW5jaWVzIiIiCiAgICAgICAgcHJpbnQoIiAg8J+UoiBUZXN0aW5nIEVuY29kaW5nIERpc2NyZXBhbmNpZXMuLi4iKQogICAgICAgIAogICAgICAgIHRlc3RfcGF0aCA9ICIvYWRtaW4iCiAgICAgICAgCiAgICAgICAgZW5jb2RpbmdfY2hhaW5zID0gWwogICAgICAgICAgICAjIFVSTCBlbmNvZGluZyBjaGFpbnMKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJ25hbWUnOiAnRG91YmxlIFVSTCBFbmNvZGluZycsCiAgICAgICAgICAgICAgICAncGF0aCc6IHVybGxpYi5wYXJzZS5xdW90ZSh1cmxsaWIucGFyc2UucXVvdGUodGVzdF9wYXRoKSksCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICMgSFRNTCBlbnRpdHkgZW5jb2RpbmcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJ25hbWUnOiAnSFRNTCBFbnRpdHkgRW5jb2RpbmcnLAogICAgICAgICAgICAgICAgJ3BhdGgnOiAnJy5qb2luKGYnJiN7b3JkKGMpfTsnIGZvciBjIGluIHRlc3RfcGF0aCksCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICMgTWl4ZWQgZW5jb2RpbmcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJ25hbWUnOiAnTWl4ZWQgRW5jb2RpbmcnLAogICAgICAgICAgICAgICAgJ3BhdGgnOiB0ZXN0X3BhdGgucmVwbGFjZSgnYScsICclNjEnKS5yZXBsYWNlKCdkJywgJyYjMTAwOycpLAogICAgICAgICAgICB9LAogICAgICAgICAgICAjIEJhc2U2NCBpbiBwYXJhbWV0ZXIKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJ25hbWUnOiAnQmFzZTY0IFBhcmFtZXRlcicsCiAgICAgICAgICAgICAgICAncGF0aCc6IGYiLz9wYXRoPXtiYXNlNjQuYjY0ZW5jb2RlKHRlc3RfcGF0aC5lbmNvZGUoKSkuZGVjb2RlKCl9IiwKICAgICAgICAgICAgfQogICAgICAgIF0KICAgICAgICAKICAgICAgICAjIEdldCBiYXNlbGluZSByZXNwb25zZQogICAgICAgIHRyeToKICAgICAgICAgICAgYmFzZWxpbmUgPSBzZWxmLnNlc3Npb24uZ2V0KGYie3NlbGYudGFyZ2V0X3VybH17dGVzdF9wYXRofSIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICByZXR1cm4KICAgICAgICAKICAgICAgICBmb3IgZW5jb2RpbmcgaW4gZW5jb2RpbmdfY2hhaW5zOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICByZXNwb25zZSA9IHNlbGYuc2Vzc2lvbi5nZXQoZiJ7c2VsZi50YXJnZXRfdXJsfXtlbmNvZGluZ1sncGF0aCddfSIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgQ29tcGFyZSB3aXRoIGJhc2VsaW5lCiAgICAgICAgICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSAhPSBiYXNlbGluZS5zdGF0dXNfY29kZToKICAgICAgICAgICAgICAgICAgICBkaXNjcmVwYW5jeSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnRW5jb2RpbmcgRGlzY3JlcGFuY3knLAogICAgICAgICAgICAgICAgICAgICAgICAnZW5jb2RpbmdfbmFtZSc6IGVuY29kaW5nWyduYW1lJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICdlbmNvZGVkX3BhdGgnOiBlbmNvZGluZ1sncGF0aCddLAogICAgICAgICAgICAgICAgICAgICAgICAnYmFzZWxpbmVfY29kZSc6IGJhc2VsaW5lLnN0YXR1c19jb2RlLAogICAgICAgICAgICAgICAgICAgICAgICAnZW5jb2RlZF9jb2RlJzogcmVzcG9uc2Uuc3RhdHVzX2NvZGUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgc2VsZi5jaGFpbl9tYXBbJ2Rpc2NyZXBhbmNpZXMnXS5hcHBlbmQoZGlzY3JlcGFuY3kpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2dfZGlzY292ZXJ5KCJEaXNjcmVwYW5jeSIsICJFbmNvZGluZyIsIGYie2VuY29kaW5nWyduYW1lJ119OiB7YmFzZWxpbmUuc3RhdHVzX2NvZGV9IHZzIHtyZXNwb25zZS5zdGF0dXNfY29kZX0iKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgIGRlZiB0ZXN0X2hlYWRlcl9jb25mdXNpb24oc2VsZik6CiAgICAgICAgIiIiVGVzdCBoZWFkZXIgcGFyc2luZyBkaXNjcmVwYW5jaWVzIiIiCiAgICAgICAgcHJpbnQoIiAg8J+TiyBUZXN0aW5nIEhlYWRlciBDb25mdXNpb24uLi4iKQogICAgICAgIAogICAgICAgIGhlYWRlcl90ZXN0cyA9IFsKICAgICAgICAgICAgIyBIb3N0IGhlYWRlciBjb25mdXNpb24KICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJ25hbWUnOiAnSG9zdCBIZWFkZXIgSW5qZWN0aW9uJywKICAgICAgICAgICAgICAgICdoZWFkZXJzJzogewogICAgICAgICAgICAgICAgICAgICdIb3N0JzogJ2V2aWwuY29tJywKICAgICAgICAgICAgICAgICAgICAnWC1Ib3N0Jzogc2VsZi5wYXJzZWRfdXJsLm5ldGxvYywKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgIyBNZXRob2Qgb3ZlcnJpZGUKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJ25hbWUnOiAnTWV0aG9kIE92ZXJyaWRlJywKICAgICAgICAgICAgICAgICdoZWFkZXJzJzogewogICAgICAgICAgICAgICAgICAgICdYLUhUVFAtTWV0aG9kLU92ZXJyaWRlJzogJ0RFTEVURScsCiAgICAgICAgICAgICAgICAgICAgJ1gtSFRUUC1NZXRob2QnOiAnUFVUJywKICAgICAgICAgICAgICAgICAgICAnWC1NZXRob2QtT3ZlcnJpZGUnOiAnUEFUQ0gnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICMgQ29udGVudC1UeXBlIGNvbmZ1c2lvbgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAnbmFtZSc6ICdDb250ZW50LVR5cGUgQ29uZnVzaW9uJywKICAgICAgICAgICAgICAgICdoZWFkZXJzJzogewogICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICAgICAgICAgICAgICAgJ1gtQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIF0KICAgICAgICAKICAgICAgICBmb3IgdGVzdCBpbiBoZWFkZXJfdGVzdHM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5zZXNzaW9uLmdldChzZWxmLnRhcmdldF91cmwsIGhlYWRlcnM9dGVzdFsnaGVhZGVycyddKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIExvb2sgZm9yIHVudXN1YWwgcmVzcG9uc2VzIHRoYXQgbWlnaHQgaW5kaWNhdGUgcHJvY2Vzc2luZyBkaWZmZXJlbmNlcwogICAgICAgICAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgaW4gWzQwMCwgNDA1LCA0MTMsIDQxNCwgNTAyLCA1MDNdOgogICAgICAgICAgICAgICAgICAgIGRpc2NyZXBhbmN5ID0gewogICAgICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdIZWFkZXIgQ29uZnVzaW9uJywKICAgICAgICAgICAgICAgICAgICAgICAgJ3Rlc3RfbmFtZSc6IHRlc3RbJ25hbWUnXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2hlYWRlcnMnOiB0ZXN0WydoZWFkZXJzJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICdyZXNwb25zZV9jb2RlJzogcmVzcG9uc2Uuc3RhdHVzX2NvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICdyZXNwb25zZV9oZWFkZXJzJzogZGljdChyZXNwb25zZS5oZWFkZXJzKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBzZWxmLmNoYWluX21hcFsnZGlzY3JlcGFuY2llcyddLmFwcGVuZChkaXNjcmVwYW5jeSkKICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkRpc2NyZXBhbmN5IiwgIkhlYWRlciIsIGYie3Rlc3RbJ25hbWUnXX06IHtyZXNwb25zZS5zdGF0dXNfY29kZX0iKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgIGRlZiB0ZXN0X21ldGhvZF9jb25mdXNpb24oc2VsZik6CiAgICAgICAgIiIiVGVzdCBIVFRQIG1ldGhvZCBoYW5kbGluZyBkaXNjcmVwYW5jaWVzIiIiCiAgICAgICAgcHJpbnQoIiAg8J+UhCBUZXN0aW5nIE1ldGhvZCBDb25mdXNpb24uLi4iKQogICAgICAgIAogICAgICAgIG1ldGhvZHMgPSBbJ0dFVCcsICdQT1NUJywgJ1BVVCcsICdERUxFVEUnLCAnUEFUQ0gnLCAnT1BUSU9OUycsICdIRUFEJywgJ1RSQUNFJ10KICAgICAgICByZXN1bHRzID0ge30KICAgICAgICAKICAgICAgICBmb3IgbWV0aG9kIGluIG1ldGhvZHM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5zZXNzaW9uLnJlcXVlc3QobWV0aG9kLCBzZWxmLnRhcmdldF91cmwsIHRpbWVvdXQ9NSkKICAgICAgICAgICAgICAgIHJlc3VsdHNbbWV0aG9kXSA9IHJlc3BvbnNlLnN0YXR1c19jb2RlCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHJlc3VsdHNbbWV0aG9kXSA9IGYiRXJyb3I6IHtzdHIoZSl9IgogICAgICAgIAogICAgICAgICMgTG9vayBmb3IgaW5jb25zaXN0ZW5jaWVzCiAgICAgICAgdW5pcXVlX3Jlc3BvbnNlcyA9IHNldChyZXN1bHRzLnZhbHVlcygpKQogICAgICAgIGlmIGxlbih1bmlxdWVfcmVzcG9uc2VzKSA+IDI6ICAjIE1vcmUgdGhhbiBqdXN0IDIwMCBhbmQgNDA1CiAgICAgICAgICAgIGRpc2NyZXBhbmN5ID0gewogICAgICAgICAgICAgICAgJ3R5cGUnOiAnTWV0aG9kIENvbmZ1c2lvbicsCiAgICAgICAgICAgICAgICAnbWV0aG9kX3Jlc3BvbnNlcyc6IHJlc3VsdHMsCiAgICAgICAgICAgICAgICAndW5pcXVlX3Jlc3BvbnNlcyc6IGxlbih1bmlxdWVfcmVzcG9uc2VzKQogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydkaXNjcmVwYW5jaWVzJ10uYXBwZW5kKGRpc2NyZXBhbmN5KQogICAgICAgICAgICBzZWxmLmxvZ19kaXNjb3ZlcnkoIkRpc2NyZXBhbmN5IiwgIk1ldGhvZHMiLCBmIkluY29uc2lzdGVudCBtZXRob2QgaGFuZGxpbmc6IHtsZW4odW5pcXVlX3Jlc3BvbnNlcyl9IGRpZmZlcmVudCByZXNwb25zZXMiKQoKICAgIGRlZiB0ZXN0X3BhdGhfbm9ybWFsaXphdGlvbihzZWxmKToKICAgICAgICAiIiJUZXN0IHBhdGggbm9ybWFsaXphdGlvbiBkaXNjcmVwYW5jaWVzIiIiCiAgICAgICAgcHJpbnQoIiAg8J+TgSBUZXN0aW5nIFBhdGggTm9ybWFsaXphdGlvbi4uLiIpCiAgICAgICAgCiAgICAgICAgYmFzZV9wYXRoID0gIi9hZG1pbiIKICAgICAgICBwYXRoX3ZhcmlhbnRzID0gWwogICAgICAgICAgICAiL2FkbWluIiwKICAgICAgICAgICAgIi9hZG1pbi8iLAogICAgICAgICAgICAiL2FkbWluLy8iLAogICAgICAgICAgICAiL2FkbWluLy4iLAogICAgICAgICAgICAiL2FkbWluLy4uL2FkbWluIiwKICAgICAgICAgICAgIi8uL2FkbWluIiwKICAgICAgICAgICAgIi8vYWRtaW4iLAogICAgICAgICAgICAiL2FkbWluLy4vIiwKICAgICAgICAgICAgIi9hZG1pbi8uLi8iLAogICAgICAgICAgICAiL2FkbWluJTJmIiwKICAgICAgICAgICAgIi9hZG1pbiUyRiIsCiAgICAgICAgICAgICIvYWRtaW4lNWMiLAogICAgICAgICAgICAiL2FkbWluJTVDIgogICAgICAgIF0KICAgICAgICAKICAgICAgICByZXNwb25zZXMgPSB7fQogICAgICAgIGZvciBwYXRoIGluIHBhdGhfdmFyaWFudHM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5zZXNzaW9uLmdldChmIntzZWxmLnRhcmdldF91cmx9e3BhdGh9IikKICAgICAgICAgICAgICAgIHJlc3BvbnNlc1twYXRoXSA9IHJlc3BvbnNlLnN0YXR1c19jb2RlCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHJlc3BvbnNlc1twYXRoXSA9IGYiRXJyb3I6IHtzdHIoZSl9IgogICAgICAgIAogICAgICAgICMgTG9vayBmb3IgZGlzY3JlcGFuY2llcwogICAgICAgIHVuaXF1ZV9yZXNwb25zZXMgPSBzZXQocmVzcG9uc2VzLnZhbHVlcygpKQogICAgICAgIGlmIGxlbih1bmlxdWVfcmVzcG9uc2VzKSA+IDE6CiAgICAgICAgICAgIGRpc2NyZXBhbmN5ID0gewogICAgICAgICAgICAgICAgJ3R5cGUnOiAnUGF0aCBOb3JtYWxpemF0aW9uJywKICAgICAgICAgICAgICAgICdwYXRoX3Jlc3BvbnNlcyc6IHJlc3BvbnNlcywKICAgICAgICAgICAgICAgICd1bmlxdWVfcmVzcG9uc2VzJzogbGVuKHVuaXF1ZV9yZXNwb25zZXMpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2VsZi5jaGFpbl9tYXBbJ2Rpc2NyZXBhbmNpZXMnXS5hcHBlbmQoZGlzY3JlcGFuY3kpCiAgICAgICAgICAgIHNlbGYubG9nX2Rpc2NvdmVyeSgiRGlzY3JlcGFuY3kiLCAiUGF0aCBOb3JtYWxpemF0aW9uIiwgZiJJbmNvbnNpc3RlbnQgcGF0aCBoYW5kbGluZzoge2xlbih1bmlxdWVfcmVzcG9uc2VzKX0gZGlmZmVyZW50IHJlc3BvbnNlcyIpCgogICAgZGVmIHRlc3RfcGFyYW1ldGVyX3BvbGx1dGlvbihzZWxmKToKICAgICAgICAiIiJUZXN0IHBhcmFtZXRlciBwb2xsdXRpb24gZGlzY3JlcGFuY2llcyIiIgogICAgICAgIHByaW50KCIgIPCflIAgVGVzdGluZyBQYXJhbWV0ZXIgUG9sbHV0aW9uLi4uIikKICAgICAgICAKICAgICAgICBwb2xsdXRpb25fdGVzdHMgPSBbCiAgICAgICAgICAgICI/cGFyYW09dmFsdWUxJnBhcmFtPXZhbHVlMiIsCiAgICAgICAgICAgICI/cGFyYW09dmFsdWUxJlBBUkFNPXZhbHVlMiIsCiAgICAgICAgICAgICI/cGFyYW1bXT12YWx1ZTEmcGFyYW1bXT12YWx1ZTIiLAogICAgICAgICAgICAiP3BhcmFtPXZhbHVlMSZwYXJhbSU1YiU1ZD12YWx1ZTIiCiAgICAgICAgXQogICAgICAgIAogICAgICAgIHJlc3BvbnNlcyA9IHt9CiAgICAgICAgZm9yIHRlc3QgaW4gcG9sbHV0aW9uX3Rlc3RzOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICByZXNwb25zZSA9IHNlbGYuc2Vzc2lvbi5nZXQoZiJ7c2VsZi50YXJnZXRfdXJsfXt0ZXN0fSIpCiAgICAgICAgICAgICAgICByZXNwb25zZXNbdGVzdF0gPSByZXNwb25zZS5zdGF0dXNfY29kZQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICByZXNwb25zZXNbdGVzdF0gPSBmIkVycm9yOiB7c3RyKGUpfSIKICAgICAgICAKICAgICAgICAjIENoZWNrIGZvciBkaXNjcmVwYW5jaWVzCiAgICAgICAgdW5pcXVlX3Jlc3BvbnNlcyA9IHNldChyZXNwb25zZXMudmFsdWVzKCkpCiAgICAgICAgaWYgbGVuKHVuaXF1ZV9yZXNwb25zZXMpID4gMToKICAgICAgICAgICAgZGlzY3JlcGFuY3kgPSB7CiAgICAgICAgICAgICAgICAndHlwZSc6ICdQYXJhbWV0ZXIgUG9sbHV0aW9uJywKICAgICAgICAgICAgICAgICdwb2xsdXRpb25fcmVzcG9uc2VzJzogcmVzcG9uc2VzLAogICAgICAgICAgICAgICAgJ3VuaXF1ZV9yZXNwb25zZXMnOiBsZW4odW5pcXVlX3Jlc3BvbnNlcykKICAgICAgICAgICAgfQogICAgICAgICAgICBzZWxmLmNoYWluX21hcFsnZGlzY3JlcGFuY2llcyddLmFwcGVuZChkaXNjcmVwYW5jeSkKICAgICAgICAgICAgc2VsZi5sb2dfZGlzY292ZXJ5KCJEaXNjcmVwYW5jeSIsICJQYXJhbWV0ZXIgUG9sbHV0aW9uIiwgZiJJbmNvbnNpc3RlbnQgcGFyYW1ldGVyIGhhbmRsaW5nOiB7bGVuKHVuaXF1ZV9yZXNwb25zZXMpfSBkaWZmZXJlbnQgcmVzcG9uc2VzIikKCiAgICBkZWYgZ2VuZXJhdGVfY3VzdG9tX2J5cGFzc2VzKHNlbGYpOgogICAgICAgICIiIkdlbmVyYXRlIGN1c3RvbSBieXBhc3MgcGF5bG9hZHMgYmFzZWQgb24gZGlzY292ZXJlZCBkaXNjcmVwYW5jaWVzIiIiCiAgICAgICAgcHJpbnQoIlxu8J+UjSBQaGFzZSA0OiBDdXN0b20gQnlwYXNzIEdlbmVyYXRpb24iKQogICAgICAgIAogICAgICAgIGlmIG5vdCBzZWxmLmNoYWluX21hcFsnZGlzY3JlcGFuY2llcyddOgogICAgICAgICAgICBwcmludCgiICDihLnvuI8gTm8gZGlzY3JlcGFuY2llcyBmb3VuZCAtIGdlbmVyYXRpbmcgZ2VuZXJpYyBieXBhc3NlcyIpCiAgICAgICAgICAgIHNlbGYuZ2VuZXJhdGVfZ2VuZXJpY19ieXBhc3NlcygpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIAogICAgICAgIGZvciBkaXNjcmVwYW5jeSBpbiBzZWxmLmNoYWluX21hcFsnZGlzY3JlcGFuY2llcyddOgogICAgICAgICAgICBieXBhc3NfcGF5bG9hZCA9IHNlbGYuY3JlYXRlX2J5cGFzc19mcm9tX2Rpc2NyZXBhbmN5KGRpc2NyZXBhbmN5KQogICAgICAgICAgICBpZiBieXBhc3NfcGF5bG9hZDoKICAgICAgICAgICAgICAgIHNlbGYuY2hhaW5fbWFwWydieXBhc3NlcyddLmFwcGVuZChieXBhc3NfcGF5bG9hZCkKICAgICAgICAgICAgICAgIHNlbGYubG9nX2Rpc2NvdmVyeSgiQnlwYXNzIiwgZGlzY3JlcGFuY3lbJ3R5cGUnXSwgZiJHZW5lcmF0ZWQgY3VzdG9tIGJ5cGFzcyIpCgogICAgZGVmIGNyZWF0ZV9ieXBhc3NfZnJvbV9kaXNjcmVwYW5jeShzZWxmLCBkaXNjcmVwYW5jeSk6CiAgICAgICAgIiIiQ3JlYXRlIGEgc3BlY2lmaWMgYnlwYXNzIHBheWxvYWQgZnJvbSBhIGRpc2NvdmVyZWQgZGlzY3JlcGFuY3kiIiIKICAgICAgICAKICAgICAgICAjIE9yaWdpbmFsIGJ5cGFzcyB0eXBlcwogICAgICAgIGlmIGRpc2NyZXBhbmN5Wyd0eXBlJ10gPT0gJ0hUVFAgU211Z2dsaW5nJzoKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICd0eXBlJzogJ0hUVFAgU211Z2dsaW5nIEJ5cGFzcycsCiAgICAgICAgICAgICAgICAncGF5bG9hZCc6IGRpc2NyZXBhbmN5WydwYXlsb2FkJ10sCiAgICAgICAgICAgICAgICAndGFyZ2V0JzogJ0hUVFAgUmVxdWVzdCBTbXVnZ2xpbmcnLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogZiJFeHBsb2l0cyB7ZGlzY3JlcGFuY3lbJ3Rlc3RfaWQnXX0gc211Z2dsaW5nIGRpc2NyZXBhbmN5IiwKICAgICAgICAgICAgICAgICd0ZXN0X2luc3RydWN0aW9ucyc6ICdTZW5kIG1hbGZvcm1lZCByZXF1ZXN0cyB0byBieXBhc3MgV0FGIGFuZCByZWFjaCBiYWNrZW5kJywKICAgICAgICAgICAgICAgICdjdXJsX2RhdGEnOiB7CiAgICAgICAgICAgICAgICAgICAgJ21ldGhvZCc6ICdQT1NUJywKICAgICAgICAgICAgICAgICAgICAnaGVhZGVycyc6IGRpc2NyZXBhbmN5WydwYXlsb2FkJ11bJ2hlYWRlcnMnXSwKICAgICAgICAgICAgICAgICAgICAnZGF0YSc6IGRpc2NyZXBhbmN5WydwYXlsb2FkJ11bJ2RhdGEnXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgZWxpZiBkaXNjcmVwYW5jeVsndHlwZSddID09ICdUQ1AgRnJhZ21lbnRhdGlvbic6CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAndHlwZSc6ICdUQ1AgRnJhZ21lbnRhdGlvbiBCeXBhc3MnLAogICAgICAgICAgICAgICAgJ3BheWxvYWQnOiBkaXNjcmVwYW5jeVsncGF5bG9hZCddLAogICAgICAgICAgICAgICAgJ3RhcmdldCc6ICdXQUYgVENQIGluc3BlY3Rpb24nLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ0ZyYWdtZW50cyBUQ1AgcGFja2V0cyB0byBieXBhc3MgZGVlcCBwYWNrZXQgaW5zcGVjdGlvbicsCiAgICAgICAgICAgICAgICAnaW1wbGVtZW50YXRpb24nOiAnVXNlIHJhdyBzb2NrZXRzIHRvIGNvbnRyb2wgVENQIHNlZ21lbnRhdGlvbicsCiAgICAgICAgICAgICAgICAnY3VybF9kYXRhJzogewogICAgICAgICAgICAgICAgICAgICdtZXRob2QnOiAnUkFXX1NPQ0tFVCcsCiAgICAgICAgICAgICAgICAgICAgJ25vdGUnOiAnQ2Fubm90IGJlIGltcGxlbWVudGVkIHdpdGggY3VybCAtIHJlcXVpcmVzIHJhdyBzb2NrZXQgcHJvZ3JhbW1pbmcnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICBlbGlmIGRpc2NyZXBhbmN5Wyd0eXBlJ10gPT0gJ0NvbXByZXNzaW9uIEJ5cGFzcyc6CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAndHlwZSc6ICdDb21wcmVzc2lvbiBCb21iIEJ5cGFzcycsCiAgICAgICAgICAgICAgICAncGF5bG9hZCc6IGYiQ29tcHJlc3Npb24gcmF0aW86IHtkaXNjcmVwYW5jeVsncmF0aW8nXTouMWZ9eCIsCiAgICAgICAgICAgICAgICAndGFyZ2V0JzogJ1dBRiBwYXlsb2FkIHNpemUgbGltaXRzJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IGYiU21hbGwgY29tcHJlc3NlZCBwYXlsb2FkICh7ZGlzY3JlcGFuY3lbJ2NvbXByZXNzZWRfc2l6ZSddfSBieXRlcykgZXhwYW5kcyB0byB7ZGlzY3JlcGFuY3lbJ3VuY29tcHJlc3NlZF9zaXplJ119IGJ5dGVzIiwKICAgICAgICAgICAgICAgICdpbXBsZW1lbnRhdGlvbic6ICdVc2UgZ3ppcCBjb21wcmVzc2lvbiB3aXRoIGhpZ2ggZXhwYW5zaW9uIHJhdGlvJywKICAgICAgICAgICAgICAgICdjdXJsX2RhdGEnOiB7CiAgICAgICAgICAgICAgICAgICAgJ21ldGhvZCc6ICdQT1NUJywKICAgICAgICAgICAgICAgICAgICAnaGVhZGVycyc6IHsnQ29udGVudC1FbmNvZGluZyc6ICdnemlwJ30sCiAgICAgICAgICAgICAgICAgICAgJ2RhdGFfZmlsZSc6ICdjb21wcmVzc2VkX3BheWxvYWQuZ3onLAogICAgICAgICAgICAgICAgICAgICdub3RlJzogJ0NyZWF0ZSBnemlwIGZpbGUgd2l0aCBsYXJnZSByZXBlYXRlZCBjb250ZW50JwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgZWxpZiBkaXNjcmVwYW5jeVsndHlwZSddID09ICdUaW1pbmcgUmFjZSBDb25kaXRpb24nOgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgJ3R5cGUnOiAnVGltaW5nIFJhY2UgQnlwYXNzJywKICAgICAgICAgICAgICAgICdwYXlsb2FkJzogJ0NvbmN1cnJlbnQgcmVxdWVzdHMgd2l0aCBtaWNyby10aW1pbmcnLAogICAgICAgICAgICAgICAgJ3RhcmdldCc6ICdQYXJzZXIgc3RhdGUgbWFjaGluZScsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiBmIlRpbWluZyB2YXJpYXRpb25zIHByb2R1Y2Uge2Rpc2NyZXBhbmN5Wyd1bmlxdWVfcmVzcG9uc2VzJ119IGRpZmZlcmVudCByZXNwb25zZXMiLAogICAgICAgICAgICAgICAgJ2ltcGxlbWVudGF0aW9uJzogJ1NlbmQgcmVxdWVzdHMgd2l0aCBwcmVjaXNlIHRpbWluZyBkZWxheXMnLAogICAgICAgICAgICAgICAgJ2N1cmxfZGF0YSc6IHsKICAgICAgICAgICAgICAgICAgICAnbWV0aG9kJzogJ1BBUkFMTEVMJywKICAgICAgICAgICAgICAgICAgICAnY29tbWFuZHMnOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICdjdXJsIC1YIFBPU1QgJFVSTCAtZCAicGFyYW09dmFsdWUmYWRtaW49dHJ1ZSIgJicsCiAgICAgICAgICAgICAgICAgICAgICAgICdzbGVlcCAwLjAwMSAmJiBjdXJsIC1YIFBPU1QgJFVSTCAtZCAicGFyYW09dmFsdWUmYWRtaW49dHJ1ZSIgJicsCiAgICAgICAgICAgICAgICAgICAgICAgICdzbGVlcCAwLjAxICYmIGN1cmwgLVggUE9TVCAkVVJMIC1kICJwYXJhbT12YWx1ZSZhZG1pbj10cnVlIiAmJwogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgIGVsaWYgZGlzY3JlcGFuY3lbJ3R5cGUnXSA9PSAnVW5pY29kZSBDb25mdXNpb24nOgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgJ3R5cGUnOiAnVW5pY29kZSBCeXBhc3MnLAogICAgICAgICAgICAgICAgJ3BheWxvYWQnOiBkaXNjcmVwYW5jeVsndmFyaWFudF9wYXRoJ10sCiAgICAgICAgICAgICAgICAndGFyZ2V0JzogJ1dBRiBVbmljb2RlIG5vcm1hbGl6YXRpb24nLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogZiJVc2VzIHtkaXNjcmVwYW5jeVsndmFyaWFudCddfSB0byBieXBhc3MgZmlsdGVycyIsCiAgICAgICAgICAgICAgICAnY3VybF9kYXRhJzogewogICAgICAgICAgICAgICAgICAgICdtZXRob2QnOiAnR0VUJywKICAgICAgICAgICAgICAgICAgICAncGF0aCc6IGRpc2NyZXBhbmN5Wyd2YXJpYW50X3BhdGgnXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgZWxpZiBkaXNjcmVwYW5jeVsndHlwZSddID09ICdFbmNvZGluZyBEaXNjcmVwYW5jeSc6CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAndHlwZSc6ICdFbmNvZGluZyBCeXBhc3MnLAogICAgICAgICAgICAgICAgJ3BheWxvYWQnOiBkaXNjcmVwYW5jeVsnZW5jb2RlZF9wYXRoJ10sCiAgICAgICAgICAgICAgICAndGFyZ2V0JzogZiJ7ZGlzY3JlcGFuY3lbJ2VuY29kaW5nX25hbWUnXX0gY29uZnVzaW9uIiwKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IGYiRXhwbG9pdHMgZW5jb2RpbmcgZGlmZmVyZW5jZXMgYmV0d2VlbiBsYXllcnMiLAogICAgICAgICAgICAgICAgJ2N1cmxfZGF0YSc6IHsKICAgICAgICAgICAgICAgICAgICAnbWV0aG9kJzogJ0dFVCcsCiAgICAgICAgICAgICAgICAgICAgJ3BhdGgnOiBkaXNjcmVwYW5jeVsnZW5jb2RlZF9wYXRoJ10KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgIGVsaWYgZGlzY3JlcGFuY3lbJ3R5cGUnXSA9PSAnSGVhZGVyIENvbmZ1c2lvbic6CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAndHlwZSc6ICdIZWFkZXIgQnlwYXNzJywKICAgICAgICAgICAgICAgICdwYXlsb2FkJzogZGlzY3JlcGFuY3lbJ2hlYWRlcnMnXSwKICAgICAgICAgICAgICAgICd0YXJnZXQnOiAnSGVhZGVyIHBhcnNpbmcgZGlmZmVyZW5jZXMnLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogZiJFeHBsb2l0cyB7ZGlzY3JlcGFuY3lbJ3Rlc3RfbmFtZSddfSBjb25mdXNpb24iLAogICAgICAgICAgICAgICAgJ2N1cmxfZGF0YSc6IHsKICAgICAgICAgICAgICAgICAgICAnbWV0aG9kJzogJ0dFVCcsCiAgICAgICAgICAgICAgICAgICAgJ2hlYWRlcnMnOiBkaXNjcmVwYW5jeVsnaGVhZGVycyddCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICBlbGlmIGRpc2NyZXBhbmN5Wyd0eXBlJ10gPT0gJ1BhdGggTm9ybWFsaXphdGlvbic6CiAgICAgICAgICAgICMgRmluZCB0aGUgbW9zdCBkaWZmZXJlbnQgcmVzcG9uc2UKICAgICAgICAgICAgcmVzcG9uc2VzID0gZGlzY3JlcGFuY3lbJ3BhdGhfcmVzcG9uc2VzJ10KICAgICAgICAgICAgbW9zdF9kaWZmZXJlbnQgPSBtaW4ocmVzcG9uc2VzLml0ZW1zKCksIGtleT1sYW1iZGEgeDogeFsxXSBpZiBpc2luc3RhbmNlKHhbMV0sIGludCkgZWxzZSA5OTkpCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAndHlwZSc6ICdQYXRoIEJ5cGFzcycsCiAgICAgICAgICAgICAgICAncGF5bG9hZCc6IG1vc3RfZGlmZmVyZW50WzBdLAogICAgICAgICAgICAgICAgJ3RhcmdldCc6ICdQYXRoIG5vcm1hbGl6YXRpb24gZGlmZmVyZW5jZXMnLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogZiJFeHBsb2l0cyBwYXRoIGhhbmRsaW5nIGluY29uc2lzdGVuY2llcyIsCiAgICAgICAgICAgICAgICAnY3VybF9kYXRhJzogewogICAgICAgICAgICAgICAgICAgICdtZXRob2QnOiAnR0VUJywKICAgICAgICAgICAgICAgICAgICAncGF0aCc6IG1vc3RfZGlmZmVyZW50WzBdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICBlbGlmIGRpc2NyZXBhbmN5Wyd0eXBlJ10gPT0gJ1BhcmFtZXRlciBQb2xsdXRpb24nOgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgJ3R5cGUnOiAnUGFyYW1ldGVyIFBvbGx1dGlvbiBCeXBhc3MnLAogICAgICAgICAgICAgICAgJ3BheWxvYWQnOiAnTXVsdGlwbGUgcGFyYW1ldGVyIHZhbHVlcycsCiAgICAgICAgICAgICAgICAndGFyZ2V0JzogJ1BhcmFtZXRlciBwYXJzaW5nIGRpZmZlcmVuY2VzJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IGYiRXhwbG9pdHMgaW5jb25zaXN0ZW50IHBhcmFtZXRlciBoYW5kbGluZyBhY3Jvc3Mge2Rpc2NyZXBhbmN5Wyd1bmlxdWVfcmVzcG9uc2VzJ119IGxheWVycyIsCiAgICAgICAgICAgICAgICAnY3VybF9kYXRhJzogewogICAgICAgICAgICAgICAgICAgICdtZXRob2QnOiAnR0VUJywKICAgICAgICAgICAgICAgICAgICAncXVlcnknOiAnP3BhcmFtPXNhZmUmcGFyYW09YWRtaW4mUEFSQU09dGVzdCcKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICMgTmV3IGFkdmFuY2VkIGJ5cGFzcyB0eXBlcwogICAgICAgIGVsaWYgZGlzY3JlcGFuY3lbJ3R5cGUnXSA9PSAnUGFyc2VyIFN0YXRlIENvbmZ1c2lvbic6CiAgICAgICAgICAgIGlmIGRpc2NyZXBhbmN5WydzdWJ0eXBlJ10gPT0gJ0gyIFBzZXVkby1IZWFkZXIgSW5qZWN0aW9uJzoKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnSDIgUHNldWRvLUhlYWRlciBCeXBhc3MnLAogICAgICAgICAgICAgICAgICAgICdwYXlsb2FkJzogZGlzY3JlcGFuY3lbJ2hlYWRlcnMnXSwKICAgICAgICAgICAgICAgICAgICAndGFyZ2V0JzogJ0hUVFAvMiB0byBIVFRQLzEuMSBkb3duZ3JhZGUnLAogICAgICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdFeHBsb2l0cyBIMiBwc2V1ZG8taGVhZGVyIGFjY2VwdGFuY2UgaW4gSDEgY29udGV4dCcsCiAgICAgICAgICAgICAgICAgICAgJ2N1cmxfZGF0YSc6IHsKICAgICAgICAgICAgICAgICAgICAgICAgJ21ldGhvZCc6ICdHRVQnLAogICAgICAgICAgICAgICAgICAgICAgICAnaGVhZGVycyc6IGRpc2NyZXBhbmN5WydoZWFkZXJzJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICdub3RlJzogJ1VzZSAtLWh0dHAyIGZsYWcgaWYgc3VwcG9ydGVkJwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxpZiBkaXNjcmVwYW5jeVsnc3VidHlwZSddID09ICdXZWJTb2NrZXQgU3RhdGUgTGVhayc6CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICd0eXBlJzogJ1dlYlNvY2tldCBTdGF0ZSBCeXBhc3MnLAogICAgICAgICAgICAgICAgICAgICdwYXlsb2FkJzogJ1dlYlNvY2tldCB1cGdyYWRlIGZvbGxvd2VkIGJ5IG5vcm1hbCByZXF1ZXN0JywKICAgICAgICAgICAgICAgICAgICAndGFyZ2V0JzogJ1Byb3RvY29sIHN0YXRlIG1hY2hpbmUnLAogICAgICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdFeHBsb2l0cyBzdGF0ZSBsZWFrYWdlIGJldHdlZW4gV2ViU29ja2V0IGFuZCBIVFRQJywKICAgICAgICAgICAgICAgICAgICAnY3VybF9kYXRhJzogewogICAgICAgICAgICAgICAgICAgICAgICAnbWV0aG9kJzogJ1NFUVVFTkNFJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbW1hbmRzJzogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2N1cmwgLUggIlVwZ3JhZGU6IHdlYnNvY2tldCIgLUggIkNvbm5lY3Rpb246IFVwZ3JhZGUiICRVUkwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2N1cmwgJFVSTC9hZG1pbicKICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICBlbGlmIGRpc2NyZXBhbmN5Wyd0eXBlJ10gPT0gJ0J1ZmZlciBCb3VuZGFyeSc6CiAgICAgICAgICAgICMgSGFuZGxlIGRpZmZlcmVudCBidWZmZXIgdHlwZXMgc2FmZWx5CiAgICAgICAgICAgIGJ1ZmZlcl9zaXplID0gZGlzY3JlcGFuY3kuZ2V0KCdidWZmZXJfc2l6ZScsIDApCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAndHlwZSc6ICdCdWZmZXIgT3ZlcmZsb3cgQnlwYXNzJywKICAgICAgICAgICAgICAgICdwYXlsb2FkJzogZiJ7YnVmZmVyX3NpemV9IGJ5dGUgYm91bmRhcnkiLAogICAgICAgICAgICAgICAgJ3RhcmdldCc6ICdQYXJzZXIgYnVmZmVyIGxpbWl0cycsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiBmIkV4cGxvaXRzIHtkaXNjcmVwYW5jeS5nZXQoJ3N1YnR5cGUnLCAnYnVmZmVyIGxpbWl0Jyl9IGF0IHtidWZmZXJfc2l6ZX0gYnl0ZXMiLAogICAgICAgICAgICAgICAgJ2N1cmxfZGF0YSc6IHsKICAgICAgICAgICAgICAgICAgICAnbWV0aG9kJzogJ0dFVCcsCiAgICAgICAgICAgICAgICAgICAgJ2hlYWRlcnMnOiB7J1gtTGFyZ2UtSGVhZGVyJzogJ0EnICogKGJ1ZmZlcl9zaXplIC0gMTAwKSBpZiBidWZmZXJfc2l6ZSA+IDEwMCBlbHNlICdBJyAqIDUwfSwKICAgICAgICAgICAgICAgICAgICAnbm90ZSc6IGYnQWRkIHBheWxvYWQgYWZ0ZXIge2J1ZmZlcl9zaXplfSBieXRlIGJvdW5kYXJ5JwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgZWxpZiBkaXNjcmVwYW5jeVsndHlwZSddID09ICdOZXN0ZWQgRW5jb2RpbmcnOgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgJ3R5cGUnOiAnTXVsdGktRW5jb2RpbmcgQnlwYXNzJywKICAgICAgICAgICAgICAgICdwYXlsb2FkJzogZGlzY3JlcGFuY3kuZ2V0KCdlbmNvZGVkX3BhdGgnLCBkaXNjcmVwYW5jeS5nZXQoJ3BheWxvYWQnLCAnTWl4ZWQgZW5jb2RpbmcnKSksCiAgICAgICAgICAgICAgICAndGFyZ2V0JzogJ0VuY29kaW5nIHBhcnNlciBzdGFjaycsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiBmIkV4cGxvaXRzIHtkaXNjcmVwYW5jeVsnc3VidHlwZSddfSBlbmNvZGluZyBjb25mdXNpb24iLAogICAgICAgICAgICAgICAgJ2N1cmxfZGF0YSc6IHsKICAgICAgICAgICAgICAgICAgICAnbWV0aG9kJzogJ0dFVCcsCiAgICAgICAgICAgICAgICAgICAgJ3BhdGgnOiBkaXNjcmVwYW5jeS5nZXQoJ2VuY29kZWRfcGF0aCcsICcvYWRtaW4nKSwKICAgICAgICAgICAgICAgICAgICAnZW5jb2RpbmcnOiBkaXNjcmVwYW5jeVsnc3VidHlwZSddCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICBlbGlmIGRpc2NyZXBhbmN5Wyd0eXBlJ10gPT0gJ0NhY2hlIEtleSBDb25mdXNpb24nOgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgJ3R5cGUnOiAnQ2FjaGUgUG9pc29uaW5nIEJ5cGFzcycsCiAgICAgICAgICAgICAgICAncGF5bG9hZCc6ICdDYXNlL3BhcmFtZXRlciB2YXJpYXRpb25zJywKICAgICAgICAgICAgICAgICd0YXJnZXQnOiAnQ0ROIGNhY2hlIGtleSBnZW5lcmF0aW9uJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IGYiRXhwbG9pdHMge2Rpc2NyZXBhbmN5WydzdWJ0eXBlJ119IGluIGNhY2hlIGtleSBjb21wdXRhdGlvbiIsCiAgICAgICAgICAgICAgICAnY3VybF9kYXRhJzogewogICAgICAgICAgICAgICAgICAgICdtZXRob2QnOiAnR0VUJywKICAgICAgICAgICAgICAgICAgICAndmFyaWF0aW9ucyc6IGRpc2NyZXBhbmN5LmdldCgndmFyaWF0aW9ucycsIHt9KSwKICAgICAgICAgICAgICAgICAgICAnbm90ZSc6ICdUcnkgZGlmZmVyZW50IGNhc2UvcGFyYW1ldGVyIG9yZGVyIGNvbWJpbmF0aW9ucycKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgIGVsaWYgZGlzY3JlcGFuY3lbJ3R5cGUnXSA9PSAnTUwgV0FGIEV2YXNpb24nOgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgJ3R5cGUnOiAnTUwgTW9kZWwgQnlwYXNzJywKICAgICAgICAgICAgICAgICdwYXlsb2FkJzogZGlzY3JlcGFuY3lbJ3N1YnR5cGUnXSwKICAgICAgICAgICAgICAgICd0YXJnZXQnOiAnTWFjaGluZSBsZWFybmluZyBXQUYgbW9kZWwnLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogZiJVc2VzIHtkaXNjcmVwYW5jeVsnc3VidHlwZSddfSB0byBldmFkZSBNTCBkZXRlY3Rpb24iLAogICAgICAgICAgICAgICAgJ2N1cmxfZGF0YSc6IHsKICAgICAgICAgICAgICAgICAgICAnbWV0aG9kJzogJ1BPU1QnIGlmIGRpc2NyZXBhbmN5WydzdWJ0eXBlJ10gPT0gJ0NvbnRleHQgV2luZG93IE92ZXJmbG93JyBlbHNlICdHRVQnLAogICAgICAgICAgICAgICAgICAgICdwYXlsb2FkX3NpemUnOiBkaXNjcmVwYW5jeS5nZXQoJ3BheWxvYWRfc2l6ZScsIDApLAogICAgICAgICAgICAgICAgICAgICd0ZWNobmlxdWUnOiBkaXNjcmVwYW5jeVsnc3VidHlwZSddCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICBlbGlmIGRpc2NyZXBhbmN5Wyd0eXBlJ10gPT0gJ0NvbnRhaW5lciBPcmNoZXN0cmF0aW9uJzoKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICd0eXBlJzogJ0s4cyBTZXJ2aWNlIE1lc2ggQnlwYXNzJywKICAgICAgICAgICAgICAgICdwYXlsb2FkJzogZGlzY3JlcGFuY3lbJ2hlYWRlcnMnXSwKICAgICAgICAgICAgICAgICd0YXJnZXQnOiAnU2VydmljZSBtZXNoIHJvdXRpbmcnLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ0V4cGxvaXRzIEt1YmVybmV0ZXMgc2VydmljZSBtZXNoIGhlYWRlcnMnLAogICAgICAgICAgICAgICAgJ2N1cmxfZGF0YSc6IHsKICAgICAgICAgICAgICAgICAgICAnbWV0aG9kJzogJ0dFVCcsCiAgICAgICAgICAgICAgICAgICAgJ2hlYWRlcnMnOiBkaXNjcmVwYW5jeVsnaGVhZGVycyddLAogICAgICAgICAgICAgICAgICAgICdwYXRoJzogJy9hZG1pbicKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgIGVsaWYgZGlzY3JlcGFuY3lbJ3R5cGUnXSA9PSAnVE9DVE9VIFJhY2UnOgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgJ3R5cGUnOiAnVE9DVE9VIEJ5cGFzcycsCiAgICAgICAgICAgICAgICAncGF5bG9hZCc6ICdSYWNlIGNvbmRpdGlvbiB0aW1pbmcgYXR0YWNrJywKICAgICAgICAgICAgICAgICd0YXJnZXQnOiAnQXN5bmMgdmFsaWRhdGlvbiBsb2dpYycsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnRXhwbG9pdHMgdGltZS1vZi1jaGVjayB2cyB0aW1lLW9mLXVzZSByYWNlIGNvbmRpdGlvbicsCiAgICAgICAgICAgICAgICAnY3VybF9kYXRhJzogewogICAgICAgICAgICAgICAgICAgICdtZXRob2QnOiAnUkFDRScsCiAgICAgICAgICAgICAgICAgICAgJ3RpbWluZyc6IGRpc2NyZXBhbmN5LmdldCgndGltaW5nX3Jlc3VsdHMnLCBbXSksCiAgICAgICAgICAgICAgICAgICAgJ25vdGUnOiAnUmVxdWlyZXMgcHJlY2lzZSB0aW1pbmcgYmV0d2VlbiByZXF1ZXN0cycKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiIgIOKaoO+4jyBFcnJvciBjcmVhdGluZyBieXBhc3MgZm9yIHtkaXNjcmVwYW5jeS5nZXQoJ3R5cGUnLCAndW5rbm93bicpfToge3N0cihlKX0iKQogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBnZW5lcmF0ZV9nZW5lcmljX2J5cGFzc2VzKHNlbGYpOgogICAgICAgICIiIkdlbmVyYXRlIGdlbmVyaWMgYnlwYXNzIHRlY2huaXF1ZXMiIiIKICAgICAgICBnZW5lcmljX2J5cGFzc2VzID0gWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAndHlwZSc6ICdHZW5lcmljIFBhdGggVHJhdmVyc2FsJywKICAgICAgICAgICAgICAgICdwYXlsb2FkJzogJy8uL3RhcmdldC8uLi8nLAogICAgICAgICAgICAgICAgJ3RhcmdldCc6ICdQYXRoIG5vcm1hbGl6YXRpb24nLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ0NsYXNzaWMgcGF0aCB0cmF2ZXJzYWwgdGVjaG5pcXVlJywKICAgICAgICAgICAgICAgICdjdXJsX2RhdGEnOiB7CiAgICAgICAgICAgICAgICAgICAgJ21ldGhvZCc6ICdHRVQnLAogICAgICAgICAgICAgICAgICAgICdwYXRoJzogJy8uL2FkbWluLy4uL2FkbWluJwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAndHlwZSc6ICdHZW5lcmljIERvdWJsZSBFbmNvZGluZycsCiAgICAgICAgICAgICAgICAncGF5bG9hZCc6ICclMjUyZSUyNTJlJTI1MmYnLAogICAgICAgICAgICAgICAgJ3RhcmdldCc6ICdEb3VibGUgVVJMIGRlY29kaW5nJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdEb3VibGUgVVJMIGVuY29kaW5nIGJ5cGFzcycsCiAgICAgICAgICAgICAgICAnY3VybF9kYXRhJzogewogICAgICAgICAgICAgICAgICAgICdtZXRob2QnOiAnR0VUJywKICAgICAgICAgICAgICAgICAgICAncGF0aCc6ICcvJTI1MmUlMjUyZSUyNTJmYWRtaW4nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICd0eXBlJzogJ0dlbmVyaWMgVW5pY29kZScsCiAgICAgICAgICAgICAgICAncGF5bG9hZCc6ICcvzrFkbWluJywgICMgzrEgbG9va3MgbGlrZSAnYScKICAgICAgICAgICAgICAgICd0YXJnZXQnOiAnVW5pY29kZSBjb25mdXNhYmxlcycsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnVW5pY29kZSBsb29rYWxpa2UgY2hhcmFjdGVycycsCiAgICAgICAgICAgICAgICAnY3VybF9kYXRhJzogewogICAgICAgICAgICAgICAgICAgICdtZXRob2QnOiAnR0VUJywKICAgICAgICAgICAgICAgICAgICAncGF0aCc6ICcvzrFkbWluJwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgXQogICAgICAgIAogICAgICAgIHNlbGYuY2hhaW5fbWFwWydieXBhc3NlcyddLmV4dGVuZChnZW5lcmljX2J5cGFzc2VzKQoKICAgIGRlZiB0ZXN0X2dlbmVyYXRlZF9ieXBhc3NlcyhzZWxmKToKICAgICAgICAiIiJUZXN0IHRoZSBnZW5lcmF0ZWQgYnlwYXNzIHBheWxvYWRzIiIiCiAgICAgICAgcHJpbnQoIlxu8J+UjSBQaGFzZSA1OiBCeXBhc3MgVmFsaWRhdGlvbiIpCiAgICAgICAgCiAgICAgICAgaWYgbm90IHNlbGYuY2hhaW5fbWFwWydieXBhc3NlcyddOgogICAgICAgICAgICBwcmludCgiICDihLnvuI8gTm8gYnlwYXNzZXMgdG8gdGVzdCIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIAogICAgICAgIGZvciBieXBhc3MgaW4gc2VsZi5jaGFpbl9tYXBbJ2J5cGFzc2VzJ106CiAgICAgICAgICAgIHN1Y2Nlc3MgPSBzZWxmLnZhbGlkYXRlX2J5cGFzcyhieXBhc3MpCiAgICAgICAgICAgIGJ5cGFzc1sndmFsaWRhdGVkJ10gPSBzdWNjZXNzCiAgICAgICAgICAgIAogICAgICAgICAgICBzdGF0dXMgPSAi4pyFIiBpZiBzdWNjZXNzIGVsc2UgIuKdjCIKICAgICAgICAgICAgcHJpbnQoZiIgIHtzdGF0dXN9IHtieXBhc3NbJ3R5cGUnXX06IHtieXBhc3NbJ2Rlc2NyaXB0aW9uJ119IikKCiAgICBkZWYgdmFsaWRhdGVfYnlwYXNzKHNlbGYsIGJ5cGFzcyk6CiAgICAgICAgIiIiVmFsaWRhdGUgYSBzcGVjaWZpYyBieXBhc3MgdGVjaG5pcXVlIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBwcmludChmIiAgICDwn5SNIFRlc3Rpbmcge2J5cGFzc1sndHlwZSddfToge2J5cGFzc1snZGVzY3JpcHRpb24nXX0iKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgYnlwYXNzWyd0eXBlJ10gaW4gWydVbmljb2RlIEJ5cGFzcycsICdQYXRoIEJ5cGFzcyddOgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnNlc3Npb24uZ2V0KGYie3NlbGYudGFyZ2V0X3VybH17YnlwYXNzWydwYXlsb2FkJ119IikKICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSByZXNwb25zZS5zdGF0dXNfY29kZSBub3QgaW4gWzQwMywgNDA2LCA0MTgsIDQyOV0KICAgICAgICAgICAgICAgIHByaW50KGYiICAgICAgUmVzcG9uc2U6IHtyZXNwb25zZS5zdGF0dXNfY29kZX0gKHsnU1VDQ0VTUycgaWYgc3VjY2VzcyBlbHNlICdCTE9DS0VEJ30pIikKICAgICAgICAgICAgICAgIHJldHVybiBzdWNjZXNzCiAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIGJ5cGFzc1sndHlwZSddID09ICdIZWFkZXIgQnlwYXNzJzoKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5zZXNzaW9uLmdldChzZWxmLnRhcmdldF91cmwsIGhlYWRlcnM9YnlwYXNzWydwYXlsb2FkJ10pCiAgICAgICAgICAgICAgICBzdWNjZXNzID0gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgbm90IGluIFs0MDMsIDQwNiwgNDE4LCA0MjldCiAgICAgICAgICAgICAgICBwcmludChmIiAgICAgIFJlc3BvbnNlOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9ICh7J1NVQ0NFU1MnIGlmIHN1Y2Nlc3MgZWxzZSAnQkxPQ0tFRCd9KSIpCiAgICAgICAgICAgICAgICByZXR1cm4gc3VjY2VzcwogICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBieXBhc3NbJ3R5cGUnXSA9PSAnRW5jb2RpbmcgQnlwYXNzJzoKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5zZXNzaW9uLmdldChmIntzZWxmLnRhcmdldF91cmx9e2J5cGFzc1sncGF5bG9hZCddfSIpCiAgICAgICAgICAgICAgICBzdWNjZXNzID0gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgbm90IGluIFs0MDMsIDQwNiwgNDE4LCA0MjldCiAgICAgICAgICAgICAgICBwcmludChmIiAgICAgIFJlc3BvbnNlOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9ICh7J1NVQ0NFU1MnIGlmIHN1Y2Nlc3MgZWxzZSAnQkxPQ0tFRCd9KSIpCiAgICAgICAgICAgICAgICByZXR1cm4gc3VjY2VzcwogICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBieXBhc3NbJ3R5cGUnXSA9PSAnSFRUUCBTbXVnZ2xpbmcgQnlwYXNzJzoKICAgICAgICAgICAgICAgICMgVGVzdCBIVFRQIHNtdWdnbGluZyBieSBzZW5kaW5nIHRoZSBtYWxmb3JtZWQgcmVxdWVzdAogICAgICAgICAgICAgICAgcGF5bG9hZCA9IGJ5cGFzc1sncGF5bG9hZCddCiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKHBheWxvYWQsIGRpY3QpIGFuZCAnaGVhZGVycycgaW4gcGF5bG9hZCBhbmQgJ2RhdGEnIGluIHBheWxvYWQ6CiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnNlc3Npb24ucG9zdCgKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi50YXJnZXRfdXJsLCAKICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycz1wYXlsb2FkWydoZWFkZXJzJ10sIAogICAgICAgICAgICAgICAgICAgICAgICBkYXRhPXBheWxvYWRbJ2RhdGEnXSwKICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dD0xMAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAjIFNtdWdnbGluZyBzdWNjZXNzIGluZGljYXRvcnM6IHVudXN1YWwgc3RhdHVzIGNvZGVzIG9yIHJlc3BvbnNlIHBhdHRlcm5zCiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IHJlc3BvbnNlLnN0YXR1c19jb2RlIGluIFsyMDAsIDQwMCwgNDEzLCA0MTQsIDUwMl0gb3IgJ3NtdWdnbCcgaW4gcmVzcG9uc2UudGV4dC5sb3dlcigpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiIgICAgICBSZXNwb25zZToge3Jlc3BvbnNlLnN0YXR1c19jb2RlfSwgQ29udGVudC1MZW5ndGg6IHtsZW4ocmVzcG9uc2UuY29udGVudCl9ICh7J1BPVEVOVElBTCcgaWYgc3VjY2VzcyBlbHNlICdGQUlMRUQnfSkiKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdWNjZXNzCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50KGYiICAgICAgSW52YWxpZCBwYXlsb2FkIGZvcm1hdCIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIGJ5cGFzc1sndHlwZSddID09ICdUQ1AgRnJhZ21lbnRhdGlvbiBCeXBhc3MnOgogICAgICAgICAgICAgICAgIyBUZXN0IFRDUCBmcmFnbWVudGF0aW9uIGJ5IGF0dGVtcHRpbmcgZnJhZ21lbnRlZCBjb25uZWN0aW9uCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgaW1wb3J0IHNvY2tldAogICAgICAgICAgICAgICAgICAgIHRhcmdldF9ob3N0ID0gc2VsZi5wYXJzZWRfdXJsLmhvc3RuYW1lCiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0X3BvcnQgPSA0NDMgaWYgc2VsZi5wYXJzZWRfdXJsLnNjaGVtZSA9PSAnaHR0cHMnIGVsc2UgODAKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBzb2NrID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQogICAgICAgICAgICAgICAgICAgIHNvY2suc2V0dGltZW91dCg1KQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIHNlbGYucGFyc2VkX3VybC5zY2hlbWUgPT0gJ2h0dHBzJzoKICAgICAgICAgICAgICAgICAgICAgICAgaW1wb3J0IHNzbAogICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0ID0gc3NsLmNyZWF0ZV9kZWZhdWx0X2NvbnRleHQoKQogICAgICAgICAgICAgICAgICAgICAgICBzb2NrID0gY29udGV4dC53cmFwX3NvY2tldChzb2NrLCBzZXJ2ZXJfaG9zdG5hbWU9dGFyZ2V0X2hvc3QpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgc29jay5jb25uZWN0KCh0YXJnZXRfaG9zdCwgdGFyZ2V0X3BvcnQpKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICMgU2VuZCBmcmFnbWVudGVkIEhUVFAgcmVxdWVzdAogICAgICAgICAgICAgICAgICAgIHNvY2suc2VuZChiIkdFVCAvIEhUVFAvMS4xXHJcbiIpCiAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCgwLjAxKQogICAgICAgICAgICAgICAgICAgIHNvY2suc2VuZChmIkhvc3Q6IHt0YXJnZXRfaG9zdH1cclxuXHJcbiIuZW5jb2RlKCkpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBzb2NrLnJlY3YoMTAyNCkKICAgICAgICAgICAgICAgICAgICBzb2NrLmNsb3NlKCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gYiIyMDAgT0siIGluIHJlc3BvbnNlIG9yIGIiSFRUUCIgaW4gcmVzcG9uc2UKICAgICAgICAgICAgICAgICAgICBwcmludChmIiAgICAgIEZyYWdtZW50ZWQgY29ubmVjdGlvbjogeydTVUNDRVNTJyBpZiBzdWNjZXNzIGVsc2UgJ0ZBSUxFRCd9IikKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VjY2VzcwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgIHByaW50KGYiICAgICAgRnJhZ21lbnRhdGlvbiB0ZXN0IGZhaWxlZDoge3N0cihlKX0iKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBieXBhc3NbJ3R5cGUnXSA9PSAnQ29tcHJlc3Npb24gQm9tYiBCeXBhc3MnOgogICAgICAgICAgICAgICAgIyBUZXN0IGNvbXByZXNzaW9uIGJvbWIgYnkgc2VuZGluZyBjb21wcmVzc2VkIHBheWxvYWQKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBpbXBvcnQgZ3ppcAogICAgICAgICAgICAgICAgICAgIHRlc3RfcGF5bG9hZCA9ICJ0ZXN0PWFkbWluJnVzZXI9cm9vdCIgKiAxMDAgICMgRXhwYW5kIHRoaXMKICAgICAgICAgICAgICAgICAgICBjb21wcmVzc2VkID0gZ3ppcC5jb21wcmVzcyh0ZXN0X3BheWxvYWQuZW5jb2RlKCkpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaGVhZGVycyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtRW5jb2RpbmcnOiAnZ3ppcCcsCiAgICAgICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJywKICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtTGVuZ3RoJzogc3RyKGxlbihjb21wcmVzc2VkKSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnNlc3Npb24ucG9zdChzZWxmLnRhcmdldF91cmwsIGRhdGE9Y29tcHJlc3NlZCwgaGVhZGVycz1oZWFkZXJzLCB0aW1lb3V0PTEwKQogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSByZXNwb25zZS5zdGF0dXNfY29kZSBpbiBbMjAwLCA0MTMsIDQxNCwgNTAyXSAgIyBBbnkgcHJvY2Vzc2luZyA9IHBvdGVudGlhbCBieXBhc3MKICAgICAgICAgICAgICAgICAgICByYXRpbyA9IGxlbih0ZXN0X3BheWxvYWQpIC8gbGVuKGNvbXByZXNzZWQpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiIgICAgICBDb21wcmVzc2lvbiB7cmF0aW86LjFmfXgsIFJlc3BvbnNlOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9ICh7J1BPVEVOVElBTCcgaWYgc3VjY2VzcyBlbHNlICdCTE9DS0VEJ30pIikKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VjY2VzcwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgIHByaW50KGYiICAgICAgQ29tcHJlc3Npb24gdGVzdCBmYWlsZWQ6IHtzdHIoZSl9IikKICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgYnlwYXNzWyd0eXBlJ10gPT0gJ1RpbWluZyBSYWNlIEJ5cGFzcyc6CiAgICAgICAgICAgICAgICAjIFRlc3QgdGltaW5nIHJhY2UgYnkgc2VuZGluZyBjb25jdXJyZW50IHJlcXVlc3RzCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgaW1wb3J0IHRocmVhZGluZwogICAgICAgICAgICAgICAgICAgIHJlc3VsdHMgPSBbXQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGRlZiB0ZXN0X3JlcXVlc3QoKToKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnNlc3Npb24uZ2V0KGYie3NlbGYudGFyZ2V0X3VybH0vYWRtaW4iLCB0aW1lb3V0PTUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZChyZXNwb25zZS5zdGF0dXNfY29kZSkKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoMCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAjIFNlbmQgMyBjb25jdXJyZW50IHJlcXVlc3RzCiAgICAgICAgICAgICAgICAgICAgdGhyZWFkcyA9IFtdCiAgICAgICAgICAgICAgICAgICAgZm9yIF8gaW4gcmFuZ2UoMyk6CiAgICAgICAgICAgICAgICAgICAgICAgIHRocmVhZCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PXRlc3RfcmVxdWVzdCkKICAgICAgICAgICAgICAgICAgICAgICAgdGhyZWFkcy5hcHBlbmQodGhyZWFkKQogICAgICAgICAgICAgICAgICAgICAgICB0aHJlYWQuc3RhcnQoKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGZvciB0aHJlYWQgaW4gdGhyZWFkczoKICAgICAgICAgICAgICAgICAgICAgICAgdGhyZWFkLmpvaW4oKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHVuaXF1ZV9yZXN1bHRzID0gc2V0KHJlc3VsdHMpCiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IGxlbih1bmlxdWVfcmVzdWx0cykgPiAxICAjIERpZmZlcmVudCByZXNwb25zZXMgPSB0aW1pbmcgYWZmZWN0cyBwcm9jZXNzaW5nCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiIgICAgICBUaW1pbmcgdGVzdCByZXN1bHRzOiB7cmVzdWx0c30sIFVuaXF1ZToge2xlbih1bmlxdWVfcmVzdWx0cyl9ICh7J1NVQ0NFU1MnIGlmIHN1Y2Nlc3MgZWxzZSAnQ09OU0lTVEVOVCd9KSIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1Y2Nlc3MKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBwcmludChmIiAgICAgIFRpbWluZyB0ZXN0IGZhaWxlZDoge3N0cihlKX0iKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBieXBhc3NbJ3R5cGUnXSA9PSAnUGFyYW1ldGVyIFBvbGx1dGlvbiBCeXBhc3MnOgogICAgICAgICAgICAgICAgIyBUZXN0IHBhcmFtZXRlciBwb2xsdXRpb24KICAgICAgICAgICAgICAgIHRlc3RfdXJsID0gZiJ7c2VsZi50YXJnZXRfdXJsfS8/cGFyYW09c2FmZSZwYXJhbT1hZG1pbiZQQVJBTT10ZXN0IgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnNlc3Npb24uZ2V0KHRlc3RfdXJsKQogICAgICAgICAgICAgICAgc3VjY2VzcyA9IHJlc3BvbnNlLnN0YXR1c19jb2RlIG5vdCBpbiBbNDAzLCA0MDYsIDQxOCwgNDI5XQogICAgICAgICAgICAgICAgcHJpbnQoZiIgICAgICBQYXJhbWV0ZXIgcG9sbHV0aW9uOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9ICh7J1NVQ0NFU1MnIGlmIHN1Y2Nlc3MgZWxzZSAnQkxPQ0tFRCd9KSIpCiAgICAgICAgICAgICAgICByZXR1cm4gc3VjY2VzcwogICAgICAgICAgICAKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KGYiICAgICAgVW5rbm93biBieXBhc3MgdHlwZToge2J5cGFzc1sndHlwZSddfSIpCiAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgICAgIAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiIgICAgICBWYWxpZGF0aW9uIGVycm9yOiB7c3RyKGUpfSIpCiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBleHBvcnRfYnlwYXNzZXNfanNvbihzZWxmKToKICAgICAgICAiIiJFeHBvcnQgYnlwYXNzZXMgdG8gSlNPTiBmaWxlIGZvciBjdXJsIGdlbmVyYXRpb24iIiIKICAgICAgICBpZiBub3Qgc2VsZi5jaGFpbl9tYXBbJ2J5cGFzc2VzJ106CiAgICAgICAgICAgIHByaW50KCJcbuKaoO+4jyBObyBieXBhc3NlcyB0byBleHBvcnQiKQogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIAogICAgICAgICMgUHJlcGFyZSBieXBhc3MgZGF0YSBmb3IgSlNPTiBleHBvcnQKICAgICAgICBleHBvcnRfZGF0YSA9IHsKICAgICAgICAgICAgJ3RhcmdldF91cmwnOiBzZWxmLnRhcmdldF91cmwsCiAgICAgICAgICAgICdzY2FuX3RpbWVzdGFtcCc6IGRhdGV0aW1lLm5vdygpLmlzb2Zvcm1hdCgpLAogICAgICAgICAgICAnaW5mcmFzdHJ1Y3R1cmVfY2hhaW4nOiBzZWxmLmNoYWluX21hcFsnbGF5ZXJzJ10sCiAgICAgICAgICAgICd0b3RhbF9kaXNjcmVwYW5jaWVzJzogbGVuKHNlbGYuY2hhaW5fbWFwWydkaXNjcmVwYW5jaWVzJ10pLAogICAgICAgICAgICAndG90YWxfYnlwYXNzZXMnOiBsZW4oc2VsZi5jaGFpbl9tYXBbJ2J5cGFzc2VzJ10pLAogICAgICAgICAgICAnYnlwYXNzZXMnOiBbXQogICAgICAgIH0KICAgICAgICAKICAgICAgICBmb3IgYnlwYXNzIGluIHNlbGYuY2hhaW5fbWFwWydieXBhc3NlcyddOgogICAgICAgICAgICBieXBhc3NfZW50cnkgPSB7CiAgICAgICAgICAgICAgICAnaWQnOiBmImJ5cGFzc197bGVuKGV4cG9ydF9kYXRhWydieXBhc3NlcyddKSArIDF9IiwKICAgICAgICAgICAgICAgICd0eXBlJzogYnlwYXNzWyd0eXBlJ10sCiAgICAgICAgICAgICAgICAndGFyZ2V0JzogYnlwYXNzWyd0YXJnZXQnXSwKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IGJ5cGFzc1snZGVzY3JpcHRpb24nXSwKICAgICAgICAgICAgICAgICd2YWxpZGF0ZWQnOiBieXBhc3MuZ2V0KCd2YWxpZGF0ZWQnLCBGYWxzZSksCiAgICAgICAgICAgICAgICAnY3VybF9kYXRhJzogYnlwYXNzLmdldCgnY3VybF9kYXRhJywge30pLAogICAgICAgICAgICAgICAgJ3BheWxvYWQnOiBzdHIoYnlwYXNzLmdldCgncGF5bG9hZCcsICcnKSkKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgIyBHZW5lcmF0ZSBjdXJsIGNvbW1hbmQgYmFzZWQgb24gYnlwYXNzIHR5cGUKICAgICAgICAgICAgY3VybF9jb21tYW5kID0gc2VsZi5nZW5lcmF0ZV9jdXJsX2NvbW1hbmQoYnlwYXNzX2VudHJ5KQogICAgICAgICAgICBieXBhc3NfZW50cnlbJ2N1cmxfY29tbWFuZCddID0gY3VybF9jb21tYW5kCiAgICAgICAgICAgIAogICAgICAgICAgICBleHBvcnRfZGF0YVsnYnlwYXNzZXMnXS5hcHBlbmQoYnlwYXNzX2VudHJ5KQogICAgICAgIAogICAgICAgICMgU2F2ZSB0byBKU09OIGZpbGUKICAgICAgICBmaWxlbmFtZSA9IGYiYnlwYXNzZXNfe3NlbGYucGFyc2VkX3VybC5uZXRsb2N9X3tpbnQodGltZS50aW1lKCkpfS5qc29uIgogICAgICAgIHdpdGggb3BlbihmaWxlbmFtZSwgJ3cnKSBhcyBmOgogICAgICAgICAgICBqc29uLmR1bXAoZXhwb3J0X2RhdGEsIGYsIGluZGVudD0yLCBkZWZhdWx0PXN0cikKICAgICAgICAKICAgICAgICBwcmludChmIlxu4pyFIEJ5cGFzc2VzIGV4cG9ydGVkIHRvOiB7ZmlsZW5hbWV9IikKICAgICAgICBwcmludChmIiAgIFRvdGFsIGJ5cGFzc2VzOiB7bGVuKGV4cG9ydF9kYXRhWydieXBhc3NlcyddKX0iKQogICAgICAgIHByaW50KGYiICAgVmFsaWRhdGVkOiB7bGVuKFtiIGZvciBiIGluIGV4cG9ydF9kYXRhWydieXBhc3NlcyddIGlmIGJbJ3ZhbGlkYXRlZCddXSl9IikKICAgICAgICAKICAgICAgICByZXR1cm4gZmlsZW5hbWUKCiAgICBkZWYgZ2VuZXJhdGVfY3VybF9jb21tYW5kKHNlbGYsIGJ5cGFzc19lbnRyeSk6CiAgICAgICAgIiIiR2VuZXJhdGUgY3VybCBjb21tYW5kIGZvciBhIHNwZWNpZmljIGJ5cGFzcyIiIgogICAgICAgIGJhc2VfdXJsID0gc2VsZi50YXJnZXRfdXJsCiAgICAgICAgY3VybF9kYXRhID0gYnlwYXNzX2VudHJ5LmdldCgnY3VybF9kYXRhJywge30pCiAgICAgICAgCiAgICAgICAgaWYgbm90IGN1cmxfZGF0YToKICAgICAgICAgICAgcmV0dXJuIGYiIyBObyBjdXJsIGRhdGEgYXZhaWxhYmxlIGZvciB7YnlwYXNzX2VudHJ5Wyd0eXBlJ119IgogICAgICAgIAogICAgICAgIG1ldGhvZCA9IGN1cmxfZGF0YS5nZXQoJ21ldGhvZCcsICdHRVQnKQogICAgICAgIAogICAgICAgIGlmIG1ldGhvZCA9PSAnUkFXX1NPQ0tFVCc6CiAgICAgICAgICAgIHJldHVybiBmIiMge2J5cGFzc19lbnRyeVsndHlwZSddfSByZXF1aXJlcyByYXcgc29ja2V0IHByb2dyYW1taW5nIC0gY2Fubm90IGJlIGltcGxlbWVudGVkIHdpdGggY3VybCIKICAgICAgICAKICAgICAgICBlbGlmIG1ldGhvZCA9PSAnU0VRVUVOQ0UnOgogICAgICAgICAgICBjb21tYW5kcyA9IGN1cmxfZGF0YS5nZXQoJ2NvbW1hbmRzJywgW10pCiAgICAgICAgICAgIHJldHVybiAnXG4nLmpvaW4oW2YiIyBTdGVwIHtpKzF9OiB7Y21kLnJlcGxhY2UoJyRVUkwnLCBiYXNlX3VybCl9IiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpLCBjbWQgaW4gZW51bWVyYXRlKGNvbW1hbmRzKV0pCiAgICAgICAgCiAgICAgICAgZWxpZiBtZXRob2QgPT0gJ1BBUkFMTEVMJzoKICAgICAgICAgICAgY29tbWFuZHMgPSBjdXJsX2RhdGEuZ2V0KCdjb21tYW5kcycsIFtdKQogICAgICAgICAgICByZXR1cm4gJ1xuJy5qb2luKFtjbWQucmVwbGFjZSgnJFVSTCcsIGJhc2VfdXJsKSBmb3IgY21kIGluIGNvbW1hbmRzXSkKICAgICAgICAKICAgICAgICBlbGlmIG1ldGhvZCA9PSAnUkFDRSc6CiAgICAgICAgICAgIHJldHVybiBmIiMgUmFjZSBjb25kaXRpb24gYXR0YWNrIC0gcmVxdWlyZXMgcHJlY2lzZSB0aW1pbmdcbiMgVXNlIG11bHRpcGxlIHRlcm1pbmFscyBvciBzY3JpcHRpbmciCiAgICAgICAgCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBCdWlsZCBzdGFuZGFyZCBjdXJsIGNvbW1hbmQKICAgICAgICAgICAgY21kX3BhcnRzID0gWydjdXJsJ10KICAgICAgICAgICAgCiAgICAgICAgICAgICMgQWRkIG1ldGhvZAogICAgICAgICAgICBpZiBtZXRob2QgIT0gJ0dFVCc6CiAgICAgICAgICAgICAgICBjbWRfcGFydHMuYXBwZW5kKGYnLVgge21ldGhvZH0nKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBBZGQgaGVhZGVycwogICAgICAgICAgICBoZWFkZXJzID0gY3VybF9kYXRhLmdldCgnaGVhZGVycycsIHt9KQogICAgICAgICAgICBmb3IgaGVhZGVyLCB2YWx1ZSBpbiBoZWFkZXJzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBpZiBub3QgaGVhZGVyLnN0YXJ0c3dpdGgoJzonKTogICMgU2tpcCBIVFRQLzIgcHNldWRvLWhlYWRlcnMKICAgICAgICAgICAgICAgICAgICBjbWRfcGFydHMuYXBwZW5kKGYnLUggIntoZWFkZXJ9OiB7dmFsdWV9IicpCiAgICAgICAgICAgIAogICAgICAgICAgICAjIEFkZCBkYXRhCiAgICAgICAgICAgIGlmICdkYXRhJyBpbiBjdXJsX2RhdGE6CiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGN1cmxfZGF0YVsnZGF0YSddLCBzdHIpOgogICAgICAgICAgICAgICAgICAgIGNtZF9wYXJ0cy5hcHBlbmQoZictZCAie2N1cmxfZGF0YVsiZGF0YSJdfSInKQogICAgICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKGN1cmxfZGF0YVsnZGF0YSddLCBkaWN0KToKICAgICAgICAgICAgICAgICAgICBjbWRfcGFydHMuYXBwZW5kKGYiLWQgJ3tqc29uLmR1bXBzKGN1cmxfZGF0YVsnZGF0YSddKX0nIikKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQWRkIHBhdGgvcXVlcnkKICAgICAgICAgICAgcGF0aCA9IGN1cmxfZGF0YS5nZXQoJ3BhdGgnLCAnJykKICAgICAgICAgICAgcXVlcnkgPSBjdXJsX2RhdGEuZ2V0KCdxdWVyeScsICcnKQogICAgICAgICAgICBmdWxsX3VybCA9IGYie2Jhc2VfdXJsfXtwYXRofXtxdWVyeX0iCiAgICAgICAgICAgIAogICAgICAgICAgICBjbWRfcGFydHMuYXBwZW5kKGYnIntmdWxsX3VybH0iJykKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQWRkIG5vdGVzCiAgICAgICAgICAgIGlmICdub3RlJyBpbiBjdXJsX2RhdGE6CiAgICAgICAgICAgICAgICByZXR1cm4gZiIjIE5vdGU6IHtjdXJsX2RhdGFbJ25vdGUnXX1cbnsnICcuam9pbihjbWRfcGFydHMpfSIKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiAnICcuam9pbihjbWRfcGFydHMpCgogICAgZGVmIGdlbmVyYXRlX3JlcG9ydChzZWxmKToKICAgICAgICAiIiJHZW5lcmF0ZSBjb21wcmVoZW5zaXZlIGFuYWx5c2lzIHJlcG9ydCIiIgogICAgICAgIAogICAgICAgIHJlcG9ydCA9IGYiIiIKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpBUFBMSUNBVElPTiBTVEFDSyBUUkFDRVJPVVRFIFJFUE9SVAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpUYXJnZXQ6IHtzZWxmLnRhcmdldF91cmx9ClNjYW4gVGltZToge3RpbWUuc3RyZnRpbWUoJyVZLSVtLSVkICVIOiVNOiVTJyl9Cgrwn5SNIFBST1RPQ09MIFNVUFBPUlQ6CkhUVFAvMS4xOiDinIUKSFRUUC8yOiB7IuKchSIgaWYgc2VsZi5wcm90b2NvbHNbJ2h0dHAyJ10gZWxzZSAi4p2MIn0KSFRUUC8zOiB7IuKchSIgaWYgc2VsZi5wcm90b2NvbHNbJ2h0dHAzJ10gZWxzZSAi4p2MIn0KV2ViU29ja2V0OiB7IuKchSIgaWYgc2VsZi5wcm90b2NvbHNbJ3dlYnNvY2tldCddIGVsc2UgIuKdjCJ9Cgrwn4+X77iPIElORlJBU1RSVUNUVVJFIENIQUlOOgp7JyDihpIgJy5qb2luKHNlbGYuY2hhaW5fbWFwWydsYXllcnMnXSkgaWYgc2VsZi5jaGFpbl9tYXBbJ2xheWVycyddIGVsc2UgJ1VuYWJsZSB0byBtYXAgY29tcGxldGUgY2hhaW4nfQoK8J+UjSBESVNDT1ZFUkVEIENPTVBPTkVOVFM6CiIiIgogICAgICAgIAogICAgICAgIGZvciBsYXllciwgZGlzY292ZXJpZXMgaW4gc2VsZi5jaGFpbl9tYXBbJ2ZpbmdlcnByaW50cyddLml0ZW1zKCk6CiAgICAgICAgICAgIHJlcG9ydCArPSBmIlxue2xheWVyfTpcbiIKICAgICAgICAgICAgZm9yIGRpc2NvdmVyeV90eXBlLCBkZXRhaWxzIGluIGRpc2NvdmVyaWVzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICByZXBvcnQgKz0gZiIgIC0ge2Rpc2NvdmVyeV90eXBlfToge2RldGFpbHN9XG4iCiAgICAgICAgCiAgICAgICAgcmVwb3J0ICs9IGYiIiIK8J+aqCBQQVJTSU5HIERJU0NSRVBBTkNJRVMgRk9VTkQ6IHtsZW4oc2VsZi5jaGFpbl9tYXBbJ2Rpc2NyZXBhbmNpZXMnXSl9CiIiIgogICAgICAgIAogICAgICAgICMgR3JvdXAgZGlzY3JlcGFuY2llcyBieSB0eXBlCiAgICAgICAgZGlzY3JlcGFuY3lfdHlwZXMgPSB7fQogICAgICAgIGZvciBkaXNjcmVwYW5jeSBpbiBzZWxmLmNoYWluX21hcFsnZGlzY3JlcGFuY2llcyddOgogICAgICAgICAgICBkaXNjX3R5cGUgPSBkaXNjcmVwYW5jeVsndHlwZSddCiAgICAgICAgICAgIGlmIGRpc2NfdHlwZSBub3QgaW4gZGlzY3JlcGFuY3lfdHlwZXM6CiAgICAgICAgICAgICAgICBkaXNjcmVwYW5jeV90eXBlc1tkaXNjX3R5cGVdID0gW10KICAgICAgICAgICAgZGlzY3JlcGFuY3lfdHlwZXNbZGlzY190eXBlXS5hcHBlbmQoZGlzY3JlcGFuY3kpCiAgICAgICAgCiAgICAgICAgZm9yIGRpc2NfdHlwZSwgZGlzY3JlcGFuY2llcyBpbiBkaXNjcmVwYW5jeV90eXBlcy5pdGVtcygpOgogICAgICAgICAgICByZXBvcnQgKz0gZiJcbntkaXNjX3R5cGV9ICh7bGVuKGRpc2NyZXBhbmNpZXMpfSBmb3VuZCk6XG4iCiAgICAgICAgICAgIGZvciBkaXNjIGluIGRpc2NyZXBhbmNpZXNbOjNdOiAgIyBTaG93IGZpcnN0IDMgb2YgZWFjaCB0eXBlCiAgICAgICAgICAgICAgICBpZiAnZGVzY3JpcHRpb24nIGluIGRpc2M6CiAgICAgICAgICAgICAgICAgICAgcmVwb3J0ICs9IGYiICAtIHtkaXNjLmdldCgnZGVzY3JpcHRpb24nLCAnTi9BJyl9XG4iCiAgICAgICAgICAgICAgICBpZiAnc3VidHlwZScgaW4gZGlzYzoKICAgICAgICAgICAgICAgICAgICByZXBvcnQgKz0gZiIgICAgU3VidHlwZToge2Rpc2NbJ3N1YnR5cGUnXX1cbiIKICAgICAgICAKICAgICAgICByZXBvcnQgKz0gZiIiIgrwn46vIEdFTkVSQVRFRCBCWVBBU1NFUzoge2xlbihzZWxmLmNoYWluX21hcFsnYnlwYXNzZXMnXSl9CiIiIgogICAgICAgIAogICAgICAgIHZhbGlkYXRlZF9ieXBhc3NlcyA9IFtiIGZvciBiIGluIHNlbGYuY2hhaW5fbWFwWydieXBhc3NlcyddIGlmIGIuZ2V0KCd2YWxpZGF0ZWQnLCBGYWxzZSldCiAgICAgICAgCiAgICAgICAgZm9yIGJ5cGFzcyBpbiBzZWxmLmNoYWluX21hcFsnYnlwYXNzZXMnXToKICAgICAgICAgICAgc3RhdHVzID0gIuKchSBWQUxJREFURUQiIGlmIGJ5cGFzcy5nZXQoJ3ZhbGlkYXRlZCcsIEZhbHNlKSBlbHNlICLinYwgRkFJTEVEIgogICAgICAgICAgICByZXBvcnQgKz0gZiJcbntzdGF0dXN9IHtieXBhc3NbJ3R5cGUnXX1cbiIKICAgICAgICAgICAgcmVwb3J0ICs9IGYiICAgVGFyZ2V0OiB7YnlwYXNzWyd0YXJnZXQnXX1cbiIKICAgICAgICAgICAgcmVwb3J0ICs9IGYiICAgRGVzY3JpcHRpb246IHtieXBhc3NbJ2Rlc2NyaXB0aW9uJ119XG4iCiAgICAgICAgCiAgICAgICAgcmVwb3J0ICs9IGYiIiIK8J+TiiBTVU1NQVJZOgotIFRvdGFsIExheWVycyBJZGVudGlmaWVkOiB7bGVuKHNlbGYuY2hhaW5fbWFwWydsYXllcnMnXSl9Ci0gRGlzY3JlcGFuY2llcyBGb3VuZDoge2xlbihzZWxmLmNoYWluX21hcFsnZGlzY3JlcGFuY2llcyddKX0KLSBHZW5lcmF0ZWQgQnlwYXNzZXM6IHtsZW4oc2VsZi5jaGFpbl9tYXBbJ2J5cGFzc2VzJ10pfQotIFZhbGlkYXRlZCBCeXBhc3Nlczoge2xlbih2YWxpZGF0ZWRfYnlwYXNzZXMpfQoK8J+UrCBSRVNFQVJDSCBWQUxVRToKVGhpcyBhbmFseXNpcyBwcm92aWRlcyBpbnNpZ2h0cyBpbnRvIHRoZSBjb21wbGV0ZSByZXF1ZXN0IHByb2Nlc3NpbmcgY2hhaW4KYW5kIGlkZW50aWZpZXMgcG90ZW50aWFsIGJ5cGFzcyBvcHBvcnR1bml0aWVzIGJhc2VkIG9uIHBhcnNpbmcgZGlzY3JlcGFuY2llcwpiZXR3ZWVuIGRpZmZlcmVudCBpbmZyYXN0cnVjdHVyZSBsYXllcnMuCgpBZHZhbmNlZCB0ZWNobmlxdWVzIHRlc3RlZCBpbmNsdWRlOgotIFBhcnNlciBzdGF0ZSBtYWNoaW5lIGRlc3luY2hyb25pemF0aW9uCi0gQnVmZmVyIGJvdW5kYXJ5IGV4cGxvaXRhdGlvbgotIE11bHRpLWxheWVyIGVuY29kaW5nIGNvbmZ1c2lvbgotIFByb3RvY29sIHR1bm5lbGluZyBhdHRhY2tzCi0gQ2FjaGUgcG9pc29uaW5nIHZlY3RvcnMKLSBNTCBXQUYgZXZhc2lvbiBtZXRob2RzCi0gQ29udGFpbmVyIG9yY2hlc3RyYXRpb24gYnlwYXNzZXMKCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIiIiCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlcG9ydAoKICAgIGFzeW5jIGRlZiBydW5fZnVsbF9hbmFseXNpcyhzZWxmKToKICAgICAgICAiIiJSdW4gdGhlIGNvbXBsZXRlIGFwcGxpY2F0aW9uIHRyYWNlcm91dGUgYW5hbHlzaXMiIiIKICAgICAgICBwcmludCgi8J+agCBTdGFydGluZyBBcHBsaWNhdGlvbiBTdGFjayBUcmFjZXJvdXRlIEFuYWx5c2lzIikKICAgICAgICBwcmludCgiPSIgKiA2MCkKICAgICAgICAKICAgICAgICAjIFBoYXNlIDE6IFByb3RvY29sIERpc2NvdmVyeQogICAgICAgIGF3YWl0IHNlbGYucHJvdG9jb2xfZGlzY292ZXJ5KCkKICAgICAgICAKICAgICAgICAjIFBoYXNlIDI6IEluZnJhc3RydWN0dXJlIEZpbmdlcnByaW50aW5nCiAgICAgICAgc2VsZi5pbmZyYXN0cnVjdHVyZV9maW5nZXJwcmludGluZygpCiAgICAgICAgCiAgICAgICAgIyBQaGFzZSAzOiBQYXJzZXIgRGlzY3JlcGFuY3kgVGVzdGluZyAoRW5oYW5jZWQpCiAgICAgICAgc2VsZi5wYXJzZXJfZGlzY3JlcGFuY3lfdGVzdGluZygpCiAgICAgICAgCiAgICAgICAgIyBQaGFzZSA0OiBDdXN0b20gQnlwYXNzIEdlbmVyYXRpb24KICAgICAgICBzZWxmLmdlbmVyYXRlX2N1c3RvbV9ieXBhc3NlcygpCiAgICAgICAgCiAgICAgICAgIyBQaGFzZSA1OiBCeXBhc3MgVmFsaWRhdGlvbgogICAgICAgIHNlbGYudGVzdF9nZW5lcmF0ZWRfYnlwYXNzZXMoKQogICAgICAgIAogICAgICAgICMgRXhwb3J0IGJ5cGFzc2VzIHRvIEpTT04KICAgICAgICBqc29uX2ZpbGUgPSBzZWxmLmV4cG9ydF9ieXBhc3Nlc19qc29uKCkKICAgICAgICAKICAgICAgICBwcmludCgiXG4iICsgIj0iICogNjApCiAgICAgICAgcHJpbnQoIvCfk4ogQU5BTFlTSVMgQ09NUExFVEUiKQogICAgICAgIHByaW50KCI9IiAqIDYwKQogICAgICAgIAogICAgICAgIHJldHVybiBzZWxmLmdlbmVyYXRlX3JlcG9ydCgpCgoKZGVmIG1haW4oKToKICAgIGltcG9ydCBzeXMKICAgIAogICAgaWYgbGVuKHN5cy5hcmd2KSAhPSAyOgogICAgICAgIHByaW50KCJVc2FnZTogcHl0aG9uIGFwcGxpY2F0aW9uX3RyYWNlcm91dGUucHkgPFRBUkdFVF9VUkw+IikKICAgICAgICBwcmludCgiRXhhbXBsZTogcHl0aG9uIGFwcGxpY2F0aW9uX3RyYWNlcm91dGUucHkgaHR0cHM6Ly9leGFtcGxlLmNvbSIpCiAgICAgICAgc3lzLmV4aXQoMSkKICAgIAogICAgdGFyZ2V0X3VybCA9IHN5cy5hcmd2WzFdCiAgICAKICAgIHByaW50KCLwn5SsIEFQUExJQ0FUSU9OIFNUQUNLIFRSQUNFUk9VVEUgLSBFTkhBTkNFRCBWRVJTSU9OIikKICAgIHByaW50KCLwn46vIE5leHQtR2VuZXJhdGlvbiBJbmZyYXN0cnVjdHVyZSBBbmFseXNpcyB3aXRoIEFkdmFuY2VkIEJ5cGFzcyBUZWNobmlxdWVzIikKICAgIHByaW50KCI9IiAqIDcwKQogICAgCiAgICBhc3luYyBkZWYgcnVuX2FuYWx5c2lzKCk6CiAgICAgICAgdHJhY2VyID0gQXBwbGljYXRpb25UcmFjZXJvdXRlKHRhcmdldF91cmwpCiAgICAgICAgcmVwb3J0ID0gYXdhaXQgdHJhY2VyLnJ1bl9mdWxsX2FuYWx5c2lzKCkKICAgICAgICAKICAgICAgICBwcmludChyZXBvcnQpCiAgICAgICAgCiAgICAgICAgIyBTYXZlIHJlcG9ydAogICAgICAgIHJlcG9ydF9maWxlbmFtZSA9IGYiYXBwX3RyYWNlcm91dGVfe2ludCh0aW1lLnRpbWUoKSl9LnR4dCIKICAgICAgICB3aXRoIG9wZW4ocmVwb3J0X2ZpbGVuYW1lLCAndycpIGFzIGY6CiAgICAgICAgICAgIGYud3JpdGUocmVwb3J0KQogICAgICAgIHByaW50KGYiXG7wn5OEIEZ1bGwgcmVwb3J0IHNhdmVkIHRvOiB7cmVwb3J0X2ZpbGVuYW1lfSIpCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHRyYWNlci5jaGFpbl9tYXAKICAgIAogICAgIyBSdW4gdGhlIGFuYWx5c2lzCiAgICByZXN1bHRzID0gYXN5bmNpby5ydW4ocnVuX2FuYWx5c2lzKCkpCiAgICAKICAgIHByaW50KGYiXG7wn46JIEFuYWx5c2lzIGNvbXBsZXRlISIpCiAgICBwcmludChmIvCfk4ogUmVzdWx0czoge2xlbihyZXN1bHRzWydkaXNjcmVwYW5jaWVzJ10pfSBkaXNjcmVwYW5jaWVzLCB7bGVuKHJlc3VsdHNbJ2J5cGFzc2VzJ10pfSBieXBhc3NlcyBnZW5lcmF0ZWQiKQogICAgcHJpbnQoZiLwn5K+IENoZWNrIHRoZSBKU09OIGZpbGUgZm9yIGJ5cGFzcyBwYXlsb2FkcyByZWFkeSBmb3IgY3VybCB0ZXN0aW5nISIpCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oKQ",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAEtLAQAAAAAAAAAAAAAA8L8"
				]
			]
		},
		{
			"file": "smart_vuln_crawle2r.py",
			"settings":
			{
				"buffer_size": 88670,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
			]
		}
	],
	"build_system": "",
	"build_system_choices":
	[
	],
	"build_varint": "",
	"command_palette":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"console":
	{
		"height": 0.0,
		"history":
		[
		]
	},
	"distraction_free":
	{
		"menu_visible": true,
		"show_minimap": false,
		"show_open_files": false,
		"show_tabs": false,
		"side_bar_visible": false,
		"status_bar_visible": false
	},
	"expanded_folders":
	[
		"/home/simone/Repos/Progetti/application_traceroute"
	],
	"file_history":
	[
		"/home/simone/Repos/Progetti/application_traceroute/smart_vuln_crawler.py",
		"/home/simone/Repos/Progetti/application_traceroute/unified_security_scanner2.py",
		"/home/simone/Repos/Progetti/application_traceroute/unified_security_scanner.py",
		"/home/simone/Repos/Progetti/application_traceroute/SecList.txt",
		"/home/simone/Repos/Progetti/application_traceroute/application_traceroute.py",
		"/home/simone/Repos/Progetti/WP-Scanner/CVE-2023-5360-RoyalElementorAddons/royal_elementor_rce_tester.py",
		"/home/simone/Repos/Progetti/WP-Scanner/endpoint_discovery.py",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/functions.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/style.css",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/assets/js/main.js",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/assets/js/dognet-particles.js",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/index.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/page-sentinel-core.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/DOGNET_TECHNOLOGIES-TEMA_WORDPRESS_CYBER.txt",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/header.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/footer.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/page-servizi.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/page-risorse.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/page-chi-siamo.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/page-contatti.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/page-vapt.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/page-cti.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/page-hardening.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/page-osint.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/page-valutazione-rischio.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/page-valutazione-gdpr.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/page-termini-e-condizioni.php",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/Progetti/SitoWeb_TemaWP/dognet-cyber/page-cookie-policy-ue.php",
		"/home/simone/Repos/Progetti/bypass_wordfence/waf_bypass_tester.py",
		"/home/simone/Repos/Progetti/sentinelcore/.gitignore",
		"/home/simone/Lavoro/Bounty/centro.txt",
		"/home/simone/Desktop/opensearch_desc.php",
		"/home/simone/Desktop/opensearch_desc2.php",
		"/home/simone/Repos/NoyseSysStuff/Crawler_dw_js/options.txt",
		"/home/simone/Repos/NoyseSysStuff/js-request-interceptor/LICENSE",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/state.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/lib.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/api/mod.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/auth/mod.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/handlers/auth.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/handlers/user.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/handlers/vulnerability.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/main.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/Cargo.toml",
		"/home/simone/Desktop/error.txt",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/state_BACKUP_7487.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/state_BASE_7487.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/state_LOCAL_7487.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/state_REMOTE_7487.rs",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/articoli/Post_Creati/CSPM/testo.txt",
		"/home/simone/Lavoro/DOGNET/Documentazione_Lavoro/articoli/Post_Creati/CSPM/testo2.txt",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/auth/claims_extractor.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/handlers/audit.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/handlers/asset.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/handlers/plugin.rs",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/handlers/team.rs",
		"/home/simone/Repos/Progetti/Documentazione/DescrizionedelServer-Sentinel Core",
		"/home/simone/.JWT4B/config.json",
		"/home/simone/Repos/Progetti/Documentazione/Backend-Sentinel Core",
		"/home/simone/Desktop/output.html",
		"/home/simone/Repos/Progetti/sentinelcore/vulnerability-manager/src/handlers/security.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/handlers/auth.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/models/user.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/handlers/vulnerability.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/models/vulnerability.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/auth/mod.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/handlers/audit.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/Cargo.toml",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/api/mod.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/handlers/user.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/handlers/security.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/migrations/002_initial_schema.sql",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/main.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/handlers/mod.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/models/mod.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/models/plugin.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/handlers/plugin.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/models/team.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/auth/password_validator.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/models/report.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/models/asset.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/config/default.yaml",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/plugins/executor.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/plugins/scanner.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/plugins/network_discovery/main.py",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/plugins/network_discovery/plugin.yaml",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/plugins/mod.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/reset_password.sql",
		"/home/simone/Repos/Progetti/vulnerability-manager-frontend/MaterialUI",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/lib.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/vulnerability-manager.albero2.txt",
		"/home/simone/Repos/Progetti/vulnerability-manager/frontend/StrutturaProgettoFront-end.txt",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/handlers/team.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/plugins/loader.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/handlers/report.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/handlers/notification.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/handlers/asset.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/migrations/seed_data.sql",
		"/home/simone/Repos/Progetti/vulnerability-manager/fix_sqlx_types.py",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/config/mod.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/.env",
		"/home/simone/Repos/Progetti/vulnerability-manager/revert_handler.py",
		"/home/simone/Repos/Progetti/vulnerability-manager/final_fix.py",
		"/home/simone/Repos/Progetti/vulnerability-manager/migrations/20250523000000_initial_schema.sql",
		"/home/simone/.cache/.fr-8gznAw/src/auth/mod.rs",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/models/notification.rs",
		"/home/simone/50",
		"/home/simone/aligroup.com_ips.txt",
		"/home/simone/Lavoro/Bounty/Swapcard/urls.txt",
		"/home/simone/Scaricati/ikea_vulnerability_report(1).md",
		"/home/simone/Repos/Default/Rec/Hacerone/hackerone",
		"/home/simone/Lavoro/CLIENTI/Gortani/INFO.txt",
		"/home/simone/Repos/Progetti/vulnerability-manager/vulnerability-manager.albero.txt",
		"/home/simone/Repos/Default/Rec/Hacerone/Documento senza nome",
		"/home/simone/Repos/Progetti/vulnerability-manager/frontend/src/components/layout/Layout.jsx",
		"/home/simone/Repos/Progetti/vulnerability-manager/frontend/src/pages/Dashboard.jsx",
		"/home/simone/Repos/Progetti/vulnerability-manager/frontend/src/pages/Vulnerabilities.jsx",
		"/home/simone/Repos/Progetti/vulnerability-manager/frontend/src/App.jsx",
		"/home/simone/Repos/Progetti/vulnerability-manager/frontend/src/components/users/UserForm.jsx",
		"/home/simone/Repos/Progetti/vulnerability-manager/frontend/src/components/common/ProtectedRoute.jsx",
		"/home/simone/Repos/Progetti/vulnerability-manager/frontend/src/api/client.js",
		"/home/simone/Repos/Progetti/vulnerability-manager/frontend/src/index.jsx",
		"/home/simone/Repos/Progetti/vulnerability-manager/frontend/src/pages/Login.jsx",
		"/home/simone/Repos/Progetti/vulnerability-manager/frontend/package.json",
		"/home/simone/Repos/Progetti/vulnerability-manager/frontend/vite.config.js",
		"/home/simone/Repos/Progetti/vulnerability-manager/frontend/index.html",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/auth/password_validator.js",
		"/home/simone/Repos/Progetti/vulnerability-manager/src/handlers/notifation.rs"
	],
	"find":
	{
		"height": 30.0
	},
	"find_in_files":
	{
		"height": 0.0,
		"where_history":
		[
		]
	},
	"find_state":
	{
		"case_sensitive": false,
		"find_history":
		[
			"AppState;",
			"use vulnerability_manager::AppState;",
			"use crate::AppState;",
			"refresh_token",
			"update_data.status.map(|s| s as _),",
			"middleware::from_fn_with_state(auth.clone(), require_auth)",
			"State(auth): State<Arc<Auth>>",
			"use ipnetwork::IpNetwork;",
			"VulnerabilityFilter",
			"let ip_network: IpNetwork = new_vuln.ip_address.parse() ",
			"use ipnetwork::IpNetwork;",
			"pub ip_address:",
			"mut",
			"PaginationParams",
			"pub async fn logout",
			"&**pool",
			"evil",
			"https://example.com/",
			"',",
			"            '",
			"            ",
			"cd ~/tools/"
		],
		"highlight": true,
		"in_selection": false,
		"preserve_case": false,
		"regex": false,
		"replace_history":
		[
			"&*pool",
			"cd ~/GIT/"
		],
		"reverse": false,
		"scrollbar_highlights": true,
		"show_context": true,
		"use_buffer2": true,
		"use_gitignore": true,
		"whole_word": false,
		"wrap": true
	},
	"groups":
	[
		{
			"sheets":
			[
				{
					"buffer": 0,
					"file": "application_traceroute.py",
					"selected": true,
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 86359,
						"regions":
						{
						},
						"selection":
						[
							[
								184,
								184
							]
						],
						"settings":
						{
							"auto_name": "#!/usr/bin/env python3",
							"bracket_highlighter.busy": false,
							"bracket_highlighter.locations":
							{
								"close":
								{
								},
								"icon":
								{
								},
								"open":
								{
								},
								"unmatched":
								{
								}
							},
							"bracket_highlighter.regions":
							[
								"bh_angle",
								"bh_angle_center",
								"bh_angle_open",
								"bh_angle_close",
								"bh_angle_content",
								"bh_c_define",
								"bh_c_define_center",
								"bh_c_define_open",
								"bh_c_define_close",
								"bh_c_define_content",
								"bh_curly",
								"bh_curly_center",
								"bh_curly_open",
								"bh_curly_close",
								"bh_curly_content",
								"bh_default",
								"bh_default_center",
								"bh_default_open",
								"bh_default_close",
								"bh_default_content",
								"bh_double_quote",
								"bh_double_quote_center",
								"bh_double_quote_open",
								"bh_double_quote_close",
								"bh_double_quote_content",
								"bh_regex",
								"bh_regex_center",
								"bh_regex_open",
								"bh_regex_close",
								"bh_regex_content",
								"bh_round",
								"bh_round_center",
								"bh_round_open",
								"bh_round_close",
								"bh_round_content",
								"bh_single_quote",
								"bh_single_quote_center",
								"bh_single_quote_open",
								"bh_single_quote_close",
								"bh_single_quote_content",
								"bh_square",
								"bh_square_center",
								"bh_square_open",
								"bh_square_close",
								"bh_square_content",
								"bh_tag",
								"bh_tag_center",
								"bh_tag_open",
								"bh_tag_close",
								"bh_tag_content",
								"bh_unmatched",
								"bh_unmatched_center",
								"bh_unmatched_open",
								"bh_unmatched_close",
								"bh_unmatched_content"
							],
							"syntax": "Packages/Python/Python.sublime-syntax",
							"tab_size": 4,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 0,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 1,
					"file": "smart_vuln_crawle2r.py",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 88670,
						"regions":
						{
						},
						"selection":
						[
							[
								88670,
								88670
							]
						],
						"settings":
						{
							"bracket_highlighter.busy": false,
							"bracket_highlighter.locations":
							{
								"close":
								{
									"1":
									[
										88669,
										88670
									]
								},
								"icon":
								{
									"1":
									[
										"Packages/BracketHighlighter/icons/round_bracket.png",
										"region.yellowish"
									]
								},
								"open":
								{
									"1":
									[
										88668,
										88669
									]
								},
								"unmatched":
								{
								}
							},
							"bracket_highlighter.regions":
							[
								"bh_angle",
								"bh_angle_center",
								"bh_angle_open",
								"bh_angle_close",
								"bh_angle_content",
								"bh_c_define",
								"bh_c_define_center",
								"bh_c_define_open",
								"bh_c_define_close",
								"bh_c_define_content",
								"bh_curly",
								"bh_curly_center",
								"bh_curly_open",
								"bh_curly_close",
								"bh_curly_content",
								"bh_default",
								"bh_default_center",
								"bh_default_open",
								"bh_default_close",
								"bh_default_content",
								"bh_double_quote",
								"bh_double_quote_center",
								"bh_double_quote_open",
								"bh_double_quote_close",
								"bh_double_quote_content",
								"bh_regex",
								"bh_regex_center",
								"bh_regex_open",
								"bh_regex_close",
								"bh_regex_content",
								"bh_round",
								"bh_round_center",
								"bh_round_open",
								"bh_round_close",
								"bh_round_content",
								"bh_single_quote",
								"bh_single_quote_center",
								"bh_single_quote_open",
								"bh_single_quote_close",
								"bh_single_quote_content",
								"bh_square",
								"bh_square_center",
								"bh_square_open",
								"bh_square_close",
								"bh_square_content",
								"bh_tag",
								"bh_tag_center",
								"bh_tag_open",
								"bh_tag_close",
								"bh_tag_content",
								"bh_unmatched",
								"bh_unmatched_center",
								"bh_unmatched_open",
								"bh_unmatched_close",
								"bh_unmatched_content"
							],
							"syntax": "Packages/Python/Python.sublime-syntax",
							"tab_size": 4,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 44899.0,
						"zoom_level": 1.0
					},
					"stack_index": 1,
					"stack_multiselect": false,
					"type": "text"
				}
			]
		}
	],
	"incremental_find":
	{
		"height": 30.0
	},
	"input":
	{
		"height": 42.0
	},
	"layout":
	{
		"cells":
		[
			[
				0,
				0,
				1,
				1
			]
		],
		"cols":
		[
			0.0,
			1.0
		],
		"rows":
		[
			0.0,
			1.0
		]
	},
	"menu_visible": true,
	"output.find_results":
	{
		"height": 0.0,
		"history":
		[
		]
	},
	"output.mdpopups":
	{
		"height": 0.0,
		"history":
		[
		]
	},
	"pinned_build_system": "Packages/Rust/Rust.sublime-build",
	"project": "apptrace.sublime-project",
	"replace":
	{
		"height": 56.0
	},
	"save_all_on_build": true,
	"select_file":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"select_project":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"select_symbol":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"selected_group": 0,
	"settings":
	{
	},
	"show_minimap": true,
	"show_open_files": true,
	"show_tabs": true,
	"side_bar_visible": false,
	"side_bar_width": 269.0,
	"status_bar_visible": true,
	"template_settings":
	{
	}
}
